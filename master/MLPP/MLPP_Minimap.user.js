// ==UserScript==
// @name         MLP Pixel Minimap
// @version      2.6.6
// @description  My Little Pony Pixel (MLP Pixel) Minimap for PixelZone.io
// @author       Endless Night
// @include      *://pixelzone.io/*
// @homepage     https://github.com/EndlessNightNLR
// @updateURL    https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// @downloadURL  https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// ==/UserScript==
//
// To the glory of Luna and the New Lunar Republic!
//
var $jscomp=$jscomp||{};$jscomp['scope']={};$jscomp['arrayIteratorImpl']=function(c){var d=0x0;return function(){return d<c['length']?{'done':!0x1,'value':c[d++]}:{'done':!0x0};};};$jscomp['arrayIterator']=function(e){return{'next':$jscomp['arrayIteratorImpl'](e)};};$jscomp['makeIterator']=function(f){var g='undefined'!=typeof Symbol&&Symbol['iterator']&&f[Symbol['iterator']];return g?g['call'](f):$jscomp['arrayIterator'](f);};setTimeout(function(){function h(){aU&&aw('Updating\x20Template\x20List');var i=new XMLHttpRequest();i['onloadend']=function(){if(0xc8==this['status']){b5=JSON['parse'](this['responseText']);b6={};b7={};bc={};for(var i in b5)b5[i]['x']*=0x1,b5[i]['y']*=0x1,'grid'===b5[i]['type']?b7[i]=b5[i]:b6[i]=b5[i];var k=$jscomp['makeIterator'](bd['templates']);for(i=k['next']();!i['done'];i=k['next']())q(i['value'],function(){return aU&&console['log']('Img\x20updated');});k=$jscomp['makeIterator'](bd['grids']);for(i=k['next']();!i['done'];i=k['next']())q(i['value'],function(){return aU&&console['log']('Grid\x20updated');});aU&&console['log']('Update\x20completed',b5,b6,b7);}else console['error']('Error\x20:\x20'+aZ[b0]['data']+'\x20'+this['status']);};i['open']('GET',aZ[b0]['data'],!0x0);i['send']();}function l(){ba&&!bk&&(bl&&(localStorage['sync']=bl=!0x1,aT=aS,au('sync')['innerText']=bl?'On':'Off',U()),aT*=1.1,0x20<aT?aT=0x20:(bk?bD['override']():bl?aC(aS):aC(),aq(),aj(),bo(),setTimeout(l,0x32)));}function m(){bb&&!bk&&(bl&&(localStorage['sync']=bl=!0x1,aT=aS,au('sync')['innerText']=bl?'On':'Off',U()),aT/=1.1,0x1>aT?aT=0x1:(bk?bD['override']():bl?aC(aS):aC(),aq(),aj(),n(),setTimeout(m,0x32)));}function n(){if(b8&&b6){bd['grids']=[];bd['templates']=[];for(var o in b6)b3['between'](b6[o]['x']-aP,b6[o]['x']+b6[o]['width']+aP)&&b4['between'](b6[o]['y']-aQ,b6[o]['y']+b6[o]['height']+aQ)&&(bc[o]?bd['templates'][bd['templates']['length']]=o:(q(o),delete b6[o]));if(bg)for(var p in b7)b3['between'](b7[p]['x']-aP,b7[p]['x']+b7[p]['width']+aP)&&b4['between'](b7[p]['y']-aQ,b7[p]['height']+aQ)&&(bc[p]?bd['grids'][bd['grids']['length']]=p:(q(p),delete b7[p]));0x0===bd['grids']['length']&&0x0===bd['templates']['length']?!b9||ba||bb||(b9=!0x1,au('minimap-box')['style']['display']='none',au('minimap-text')['style']['display']='block',au('minimap-text')['innerText']='There\x27s\x20nothing\x20here'):(b9||(b9=!0x0,au('minimap-box')['style']['display']='block',au('minimap-text')['style']['display']='none'),bp&&(bp=!0x1,window['requestAnimationFrame'](function(){bo();bp=!0x0;})));}}function q(r,s){aU&&aw('Load\x20'+(b7[r]?'grid':'image')+'\x20:\x20'+r);var t=new Image(),u=0x0;t['crossOrigin']='';t['src']=''+aZ[b0]['images']+r+'.png';t['onerror']=function(){'grid'===b5[r]['type']?delete b7[r]:delete b6[r];delete b5[r];delete bc[r];};t['onload']=function(){var v=document['createElement']('canvas'),w=v['getContext']('2d');v['width']=t['width'];v['height']=t['height'];w['drawImage'](t,0x0,0x0,t['width'],t['height']);var x=t['width'],y=t['height'];w=w['getImageData'](0x0,0x0,x,y)['data'];if(!(0x180>=x&&0x180>=y)){for(var z=performance['now'](),A=0x0;0x80<y-A;A+=0x100)for(var B=0x0;0x80<x-B;B+=0x100){for(var C=r+'_#_'+B/0x100+'_'+A/0x100,D=0x100<=x-B?0x100:x-B,E=0x100<=y-A?0x100:y-A,F=D<<0x2,G=F*E,H=new Uint8ClampedArray(G),I=0x0,J=0x0,K=null,L=0x0,M=0x0,N=x<<0x2,O=x*A+B<<0x2,P=0x0,Q,R;M!==E;M+=0x1)for(Q=O+M*N,R=P+F;P!==R;)H[P]=w[Q],P+=0x1,Q+=0x1;for(M=0x3;M<G;M+=0x4)if(0x0!==H[M]){K=~~((M+0x1)/F);break;}if(null!==K){--G;for(M=K*F;G>M;G-=0x4)if(0x0!==H[G]){L=(G+0x1)/F;L=E-(~~L===L?L:~~L+0x1);break;}G=0x3;M=K*F;N=(D-L)*F;S:for(;G<F;G+=0x4)for(O=G+M;O<N;O+=F)if(0x0!==H[O]){I=G>>>0x2;break S;}G=F-0x1;M=K*F;N=(D-L)*F;O=I<<0x2;T:for(;G>O;G-=0x4)for(P=G+M;P<N;P+=F)if(0x0!==H[P]){J=D-(G+0x1>>>0x2);break T;}b5[C]={'x':b5[r]['x']+B,'y':b5[r]['y']+A};bc[C]=document['createElement']('canvas');0x0!==K||0x0!==L||0x0!==I||0x0!==J?(b5[C]['width']=bc[C]['width']=D-I-J,b5[C]['height']=bc[C]['height']=E-K-L,bc[C]['getContext']('2d')['drawImage'](v,B+I,A+K,bc[C]['width'],bc[C]['height'],0x0,0x0,bc[C]['width'],bc[C]['height']),b5[C]['x']+=I,b5[C]['y']+=K):(b5[C]['width']=bc[C]['width']=D,b5[C]['height']=bc[C]['height']=E,bc[C]['getContext']('2d')['drawImage'](v,B,A,bc[C]['width'],bc[C]['height'],0x0,0x0,bc[C]['width'],bc[C]['height']));'grid'===b5[r]['type']?b7[C]=b5[C]:b6[C]=b5[C];u+=0x1;}}z=performance['now']()-z;delete b5[r];delete bc[r];aU&&console['log'](b5,'\x0aName\x20:\x20'+r+'\x0aChunks\x20:\x20'+u+'\x0aTime\x20:\x20'+z);s&&s();n();}};}function U(){bo=bk?bg?function(){a5();Z(aS);}:a5:bl?bg?function(){V(aS);Z(aS);}:function(){return V(aS);}:bg?function(){V();Z();}:V;}function V(W){W=void 0x0===W?aT:W;bx['clearRect'](0x0,0x0,bt['width'],bt['height']);for(var X=$jscomp['makeIterator'](bd['templates']),Y=X['next']();!Y['done'];Y=X['next']())Y=Y['value'],bx['drawImage'](bc[Y],~~((b6[Y]['x']-aV)*W),~~((b6[Y]['y']-aW)*W),~~(bc[Y]['width']*W),~~(bc[Y]['height']*W));}function Z(a0){a0=void 0x0===a0?aT:a0;by['clearRect'](0x0,0x0,bu['width'],bu['height']);var a1=a0*bi;if(bk){a0=(bD['xLeft']-b3)/bi+b3;var a2=(bD['yTop']-b4)/bi+b4;}else a0=(aV-b3)/bi+b3,a2=(aW-b4)/bi+b4;for(var a3=$jscomp['makeIterator'](bd['grids']),a4=a3['next']();!a4['done'];a4=a3['next']())a4=a4['value'],by['drawImage'](bc[a4],~~((b7[a4]['x']-a0)*a1),~~((b7[a4]['y']-a2)*a1),~~(bc[a4]['width']*a1),~~(bc[a4]['height']*a1));}function a5(a6){a6=void 0x0===a6?aS:a6;bx['clearRect'](0x0,0x0,bt['width'],bt['height']);for(var a7=document['createElement']('canvas'),a8=a7['getContext']('2d'),a9,aw=0x0,ab=a6*a6;0x1<ab;ab>>>=0x1)aw++;a9=aw>>>0x1;a7['width']=bD['width'];a7['height']=bD['height'];ab=$jscomp['makeIterator'](bd['templates']);for(var ac=ab['next']();!ac['done'];ac=ab['next']())ac=ac['value'],a8['drawImage'](bc[ac],bD['xLeft']-b6[ac]['x']-0x1,bD['yTop']-b6[ac]['y']-0x1,bD['width'],bD['height'],0x0,0x0,bD['width'],bD['height']);ab=a8['getImageData'](0x0,0x0,a7['width'],a7['height']);ac=ab['data'];a9=b1['getContext']('2d')['getImageData'](aX-(bD['width']<<a9>>>0x1),aY-(bD['height']<<a9>>>0x1),bD['width']*a6,bD['height']*a6)['data'];for(var ad=0x0,ae=0x0,af=bD['height']*bD['widthRGBA'],ag=aS<<0x2;ad<af;ad+=bD['widthRGBA'],ae=ad<<aw)for(var ah=ad,ai=ad+(bD['width']<<0x2);ah<ai;ah+=0x4,ae+=ag)0x0!=a9[ae+0x3]&&(0x28>(ac[ah]>a9[ae]?ac[ah]-a9[ae]:a9[ae]-ac[ah])+(ac[ah+0x1]>a9[ae+0x1]?ac[ah+0x1]-a9[ae+0x1]:a9[ae+0x1]-ac[ah+0x1])+(ac[ah+0x2]>a9[ae+0x2]?ac[ah+0x2]-a9[ae+0x2]:a9[ae+0x2]-ac[ah+0x2])?ac[ah]=ac[ah+0x1]=ac[ah+0x2]=(ac[ah]+ac[ah+0x1]+ac[ah+0x2])/0x3:(ac[ah]=0xff,ac[ah+0x1]=0x0,ac[ah+0x2]=0x0));a8['putImageData'](ab,0x0,0x0);bx['drawImage'](a7,bD['borderW']-a6,bD['borderH']-a6,bD['width']*a6,bD['height']*a6);}function aj(ak){ak=void 0x0===ak?aT:ak;if(bf){if(bk||bl)ak=aS;bz['clearRect'](0x0,0x0,bv['width'],bv['height']);if(!(4.6>=ak)){bz['beginPath']();for(var al=bt['width']+ak,am=bt['height']+ak,an=(bt['width']>>>0x1)%ak-ak,ao=(bt['height']>>>0x1)%ak-ak,ap=0x0;ap<=al;ap+=ak)bz['moveTo'](ap+an,ao),bz['lineTo'](ap+an,am+ao);for(ap=0x0;ap<=am;ap+=ak)bz['moveTo'](an,ap+ao),bz['lineTo'](al+an,ap+ao);bz['strokeStyle']='rgb(20,20,20)';bz['stroke']();}}}function aq(ar){ar=void 0x0===ar?aT:ar;if(bk||bl)ar=aS;bA['clearRect'](0x0,0x0,bw['width'],bw['height']);0x2>=ar||(bA['beginPath'](),bA['lineWidth']=ar/0x3,bA['strokeStyle']=be,bA['rect'](bt['width']>>>0x1,bt['height']>>>0x1,ar,ar),bA['stroke']());}function as(at){at=document['getElementById'](at);at['style']['display']='none'==at['style']['display']?'block':'none';}function au(au){return document['getElementById'](au);}function aw(){for(var au=$jscomp['makeIterator'](arguments),ay=au['next']();!ay['done'];ay=au['next']())console['log'](ay['value']);}function az(au){au=au||window['event'];if(au['wheelDelta']){var aB=au['wheelDelta']/0x78;window['opera']&&(aB=~aB+0x1);}else au['detail']&&(aB=-au['detail']/0x3);0x1==aB?aS<<=0x1:aS>>>=0x1;0x40<aS?aS=0x40:0x1>aS?aS=0x1:bk?setTimeout(function(){aC(aS);bD['override']();a5();bg&&Z(aS);aj();aq();},0xc8):bl&&(aC(aS),aj(),aq(),n());}function aC(au){au=void 0x0===au?aT:au;aV=b3-(bt['width']>>>0x1)/au;aW=b4-(bt['height']>>>0x1)/au;aP=(bt['width']/au>>>0x1)+0x1;aQ=(bt['height']/au>>>0x1)+0x1;}(function ea(){au('timer')?au('timer')['style']['z-index']=0x5:setTimeout(ea,0x14d);}());(function p(){au('message')?au('message')['remove']():setTimeout(p,0x14d);}());var aE=document['createElement']('link');aE['rel']='stylesheet';aE['href']='https://endlessnightnlr.github.io/master/MLPP/style.css';document['head']['appendChild'](aE);aE=document['createElement']('div');aE['style']='position:\x20absolute;\x20left:\x200px;\x20top:\x2057px;\x20margin:\x20-2px\x200px\x200px\x20-2px;';aE['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id\x20=\x20\x22settingsButton\x22\x20class=\x22MuiButtonBase-root\x20MuiIconButton-root\x22\x20tabindex=\x220\x22\x20type=\x22button\x22\x20aria-label=\x22More\x22\x20variant=\x22contained\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiIconButton-label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tr-bg\x22\x20style=\x22width:\x2025px;\x20height:\x2025px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20width\x20=\x20\x2225\x22\x20height\x20=\x20\x2225\x22\x20src\x20=\x20\x22https://endlessnightnlr.github.io/master/MLPP/gear.png\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</img>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiTouchRipple-root\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';document['body']['appendChild'](aE);au('settingsButton')['onclick']=function(){as('settingsDiv');'block'==au('settingsDiv')['style']['display']&&(au('settingsDiv')['style']['left']=(window['innerWidth']-au('settingsDiv')['offsetWidth']>>>0x1)+'px',au('settingsDiv')['style']['top']=(window['innerHeight']-au('settingsDiv')['offsetHeight']>>>0x1)+'px');};Number['prototype']['between']=function(au,aG){return this>au&&this<aG;};var aH='black\x20gray\x20white\x20Fuchsia\x20red\x20yellow\x20lime\x20springGreen\x20aqua\x20blue'['split']('\x20'),aI='New',aJ={'Old':'background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x2021px;\x20padding:\x206px;','New':'background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x205px;'},aK={'Old':'position:\x20absolute;\x20right:\x200.5em;\x20bottom:\x204.75em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:10px;\x20padding:\x206px;','New':'position:\x20absolute;\x20right:\x200em;\x20top:\x200em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x201px;'},aL={'Old':0x1a4,'New':0x118},aM={'Old':0x12c,'New':0xc8},aN={'false':0x1,'true':0.5},aO={'ru':{'width':'280px','title':{'filling':'MLP\x20Pixel\x20миникарта:\x20настройки'},'cursorColor':{'filling':'Цвет\x20курсора:\x20','true':'On','false':'Off'},'grid':{'filling':'Сетка:\x20','true':'On','false':'Off'},'mapStyle':{'filling':'Стиль\x20миникарты:\x20','New':'New','Old':'Old'},'sectors':{'filling':'Сектора:\x20','true':'On','false':'Off'},'sectorShift':{'filling':'Сдвиг\x20секторов:\x20','true':'On','false':'Off'},'translucent':{'filling':'Прозрачность\x20секторов:\x20','true':'On','false':'Off'},'detector':{'filling':'Детектор\x20ошибок:\x20','true':'On','false':'Off'},'language':{'filling':'Язык:\x20'},'sync':{'filling':'Синхронизация\x20зума:\x20'}},'en':{'width':'250px','title':{'filling':'MLP\x20Pixel\x20minimap:\x20settings'},'cursorColor':{'filling':'Cursor\x20color:\x20','true':'On','Off':'Off'},'grid':{'filling':'Grid:\x20','true':'On','Off':'Off'},'mapStyle':{'filling':'Minimap\x20style:\x20','New':'New','Old':'Old'},'sectors':{'filling':'Sectors:\x20','true':'On','false':'Off'},'sectorShift':{'filling':'Sectors\x20shift:\x20','true':'On','false':'Off'},'translucent':{'filling':'Translucent:\x20','true':'On','false':'Off'},'detector':{'filling':'Error\x20detector:\x20','true':'On','false':'Off'},'language':{'filling':'Language:\x20'},'sync':{'filling':'Zoom\x20sync:\x20'}}},aP=null,aQ=null,aR=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i['test'](navigator['userAgent']),aS=0x1,aT=0x5,aU=!0x1,aV=void 0x0,aW=void 0x0,aX=void 0x0,aY=void 0x0,aZ={'New Lunar Republic':{'data':'https://endlessnightnlr.github.io/master/templates/New\x20Lunar\x20Republic.json','images':'https://endlessnightnlr.github.io/master/images/','color':'aqua','type':0x2}},b0='New\x20Lunar\x20Republic',b1=au('canvas'),b2=au('coordinatesNote'),b3=0x0,b4=0x0,b5,b6,b7,b8=!0x0,b9=!0x0,ba=!0x1,bb=!0x1,bc=[],bd={'grids':[],'templates':[]},be='springGreen',bf=!0x1,bg=!0x1,bh=!0x1,bi=0x1,bj=!0x1,bk=!0x1,bl=!0x1,bm=(window['navigator']['language']||window['navigator']['systemLanguage']||window['navigator']['userLanguage'])['substr'](0x0,0x2)['toLowerCase'](),bn=new RegExp(/-?\d+/g),bo,bp=!0x0;aS=window['location']['href']['match'](bn)&&0x3==window['location']['href']['match'](bn)['length']?+window['location']['href']['match'](bn)[0x2]:0x1;b1['addEventListener']?b1['addEventListener']('mousewheel',az,!0x1):b1['attachEvent']&&b1['attachEvent']('onmousewheel',az);if(/Firefox/i['test'](navigator['userAgent']))try{window['addEventListener']('DOMMouseScroll',function(au){0x3==au['wheelDelta']?aS<<=0x1:aS>>>=0x1;0x40<aS?aS=0x40:0x1>aS?aS=0x1:bl&&!bk?(aC(aS),aj(),aq(),n()):bk&&(aC(aS),setTimeout(function(){bD['override']();a5();},0xc8),aj(),aq(),bg&&Z());});}catch(br){}localStorage['cursorColor']?be=localStorage['cursorColor']:localStorage['cursorColor']=be;aU='true'==localStorage['debug'];bf='true'==localStorage['grid'];'Old'==localStorage['mapStyle']&&(aI='Old');bg='true'==localStorage['sectors'];'true'==localStorage['sectorShift']&&(bh=!0x0,bi=0.8);bj='true'==localStorage['translucent'];localStorage['mobile']&&(aR=localStorage['mobile']);'true'==localStorage['detector']&&(bk=aR?localStorage['detector']=!0x1:!0x0);bl='true'==localStorage['sync'];localStorage['zoomlevel']&&(aT=+localStorage['zoomlevel']);localStorage['language']&&(bm=localStorage['language']);U();aw('MLPP\x20MINIMAP\x20VERSION\x20:\x202.6.8.3');for(var bs in aZ);bs=document['createElement']('div');bs['id']='minimapbg';bs['style']=aK[aI];bs['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-text\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-box\x22\x20style=\x22display:block;position:relative;width:'+aL[aI]+'px;height:'+aM[aI]+'px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:1;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapSectors\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:2;position:absolute;top:0;left:0;opacity:'+aN[bj]+';\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap-board\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:3;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap-cursor\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:4;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-config\x22\x20style=\x22line-height:15px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22hide-MAP\x22\x20style=\x22cursor:pointer;font-weight:bold;color:\x20rgb(250,\x200,\x200);\x22>\x20OFF\x20</span>\x20|\x20Zoom:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-plus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x20100,\x20250);\x22>+</span>\x20\x20/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-minus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x2050,\x20250);\x22>-</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22factions\x22\x20style\x20=\x20\x22display:none\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20id=\x22listF\x22\x20style=\x22line-height:20px;text-align:left;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';document['body']['appendChild'](bs);var bt=au('minimap'),bu=au('minimapSectors'),bv=au('minimap-board'),bw=au('minimap-cursor');for(bs=0x0;bs<au('minimap-box')['childNodes']['length'];bs++)aE=au('minimap-box')['childNodes'][bs],aE['width']=aE['offsetWidth'],aE['height']=aE['offsetHeight'];var bx=bt['getContext']('2d'),by=bu['getContext']('2d'),bz=bv['getContext']('2d'),bA=bw['getContext']('2d');bx['mozImageSmoothingEnabled']=by['mozImageSmoothingEnabled']=!0x1;bx['webkitImageSmoothingEnabled']=by['webkitImageSmoothingEnabled']=!0x1;bx['msImageSmoothingEnabled']=by['msImageSmoothingEnabled']=!0x1;bx['imageSmoothingEnabled']=by['imageSmoothingEnabled']=!0x1;setTimeout(function(){for(var au=0x0,aS=0x0;au<document['getElementsByTagName']('canvas')['length'];au++)if('minimap'==document['getElementsByTagName']('canvas')[au]['id']&&aS++,0x1<aS){alert('Включено\x20два\x20или\x20более\x20скриптов\x20с\x20миникартой.\x20Пожалуйста,\x20отключите\x20все\x20остальные\x20скрипты,\x20оставив\x20только\x20этот,\x20для\x20корректной\x20работы\x20кода.\x0a\x0dTwo\x20or\x20more\x20minimap\x20scripts\x20included.\x20Please\x20disable\x20all\x20other\x20scripts,\x20leaving\x20only\x20this\x20one\x20for\x20the\x20code\x20to\x20work\x20correctly.');break;}},0x7d0);var bD={'override':function(){this['width']=bt['width']/aS&0x7fe;this['height']=bt['height']/aS&0x7fe;this['borderW']=bt['width']-this['width']*aS>>>0x1;this['borderH']=bt['height']-this['height']*aS>>>0x1;this['xLeft']=b3-(this['width']>>>0x1);this['yTop']=b4-(this['height']>>>0x1);this['width']+=0x2;this['widthRGBA']=this['width']<<0x2;this['height']+=0x2;}};bs=new XMLHttpRequest();bs['onloadend']=function(){if(0xc8==this['status']){try{var aS=document['createElement']('script');aS['src']='https://endlessnightnlr.github.io/master/test.js';document['head']['appendChild'](aS);}catch(bF){}aZ=JSON['parse'](this['responseText']);aU&&aw(this['responseText']);b0=aZ[localStorage['faction']]&&localStorage['faction']||Object['keys'](aZ)[0x0];h();aS='';for(var bG in aZ)aS+='<li\x20id=\x22'+bG+'\x22><span\x20Style=\x22cursor:pointer;\x20font-weight:\x20normal;\x20color:\x20'+aZ[bG]['color']+'\x22>'+bG+'<span></li>';au('listF')['innerHTML']=aS;for(var bs in aZ)au(bs)['onclick']=function(){as('factions');au(b0)['childNodes'][0x0]['style']['fontWeight']='normal';this['childNodes'][0x0]['style']['fontWeight']='bold';b0=this['id'];localStorage['faction']=this['id'];h();};au(b0)['childNodes'][0x0]['style']['font-weight']='bold';}else console['error']('Error\x20:\x20https://endlessnightnlr.github.io/master/MLPP/factions_MLPP.json\x20'+this['status']);};bs['open']('GET','https://endlessnightnlr.github.io/master/MLPP/factions_MLPP.json',!0x0);bs['send']();aq();bf&&aj();au('hide-MAP')['onclick']=function(){b8=!0x1;au('minimap-box')['style']['display']='none';au('minimap-config')['style']['display']='none';au('minimap-text')['style']['display']='block';au('minimap-text')['innerText']='Minimap';au('minimap-text')['style']['cursor']='pointer';};au('minimap-text')['onclick']=function(){b8=!0x0;au('minimap-box')['style']['display']='block';au('minimap-config')['style']['display']='block';au('minimap-text')['style']['display']='none';au('minimap-text')['style']['cursor']='default';n();};au('zoom-plus')['addEventListener']('mousedown',function(au){au['preventDefault']();ba=!0x0;bb=!0x1;l();},!0x1);au('zoom-plus')['addEventListener']('mouseup',function(){return ba=!0x1;},!0x1);au('zoom-minus')['addEventListener']('mousedown',function(au){au['preventDefault']();bb=!0x0;ba=!0x1;m();},!0x1);au('zoom-minus')['addEventListener']('mouseup',function(){return bb=!0x1;},!0x1);if(aR){document['body']['insertAdjacentHTML']('afterbegin','<style>#minimap-config{font-size:\x2025px;}</style>');au('minimap-config')['style']['line-height']='27px';var bK=document['createElement']('div'),bL=document['createElement']('canvas');bL['width']=0x15;bL['height']=bL['width'];bL['getContext']('2d')['strokeStyle']='white';bK['style']='position:\x20absolute;\x20top:\x20'+(window['innerHeight']+bL['height'])/0x2+'px;\x20left:\x20'+(window['innerWidth']+bL['width'])/0x2+'px;';bK['appendChild'](bL);document['body']['appendChild'](bK);var bM=bL['getContext']('2d');b1['getContext']('2d')['getImageData'](+bK['style']['left']['replace']('px','')[0x0],+bK['style']['top']['replace']('px','')[0x0],bL['width'],bL['height']);bs=bM['getImageData'](0x0,0x0,bL['width'],bL['height']);aE=bs['data'];for(var bN=0x0;bN<bL['height'];bN++)aE[(bL['width']*(0.5+bN)<<0x2)+0x3]=0xff;for(bN=0x0;bN<bL['width'];bN++)aE[(bL['width']*((bL['height']>>0x1)-0x1)+bN<<0x2)+0x3]=0xff;bM['putImageData'](bs,0x0,0x0);bL['update']=function(){for(var au=b1['getContext']('2d')['getImageData'](+bK['style']['left']['replace']('px','')[0x0],+bK['style']['top']['replace']('px','')[0x0],bL['width'],bL['height'])['data'],aS=bM['getImageData'](0x0,0x0,this['width'],this['height']),bs=aS['data'],b5=0x0;b5<this['height'];b5++){var bS=this['width']*(0.5+b5)<<0x2;0x80===au[bS]&&0x80===au[bS+0x1]&&0x80===au[bS+0x2]?(bs[bS]=0x0,bs[bS+0x1]=0xe6,bs[bS+0x2]=0xe6):(bs[bS]=0xff^au[bS],bs[bS+0x1]=0xff^au[bS+0x1],bs[bS+0x2]=0xff^au[bS+0x2]);}for(b5=0x0;b5<this['width'];b5++)bS=this['width']*((this['height']>>>0x1)-0x1)+b5<<0x2,0x80===au[bS]&&0x80===au[bS+0x1]&&0x80===au[bS+0x2]?(bs[bS]=0x0,bs[bS+0x1]=0xe6,bs[bS+0x2]=0xe6):(bs[bS]=0xff^au[bS],bs[bS+0x1]=0xff^au[bS+0x1],bs[bS+0x2]=0xff^au[bS+0x2]);bM['putImageData'](aS,0x0,0x0);};b1['addEventListener']('touchmove',function(){bL['update']();},!0x1);setInterval(function(){if(b8){var au=0x0,bs=0x0;window['location']['search']&&(bs=window['location']['search']['match'](bn),au=+bs[0x0],bs=+bs[0x1]);if(b3!=au||b4!=bs)b3=au,b4=bs,bk?(aC(aS),aX=e['clientX'],aY=e['clientY'],bD['override']()):bl?aC(aS):aC(),n();}},0x96);}else window['addEventListener']('mousemove',function(au){var bs=b2['innerText']['match'](bn),b5=+bs[0x0];bs=+bs[0x1];if(b3!=b5||b4!=bs)b3=b5,b4=bs,aX=au['clientX'],aY=au['clientY'],b8&&(bk?(aC(aS),bD['override'](),0x1==aS?n():setTimeout(n,0x64)):(bl?aC(aS):aC(),n()));},!0x1);bs=document['createElement']('div');bs['class']='post\x20block\x20bc2';bs['id']='settingsDiv';bs['style']='width:\x20'+aO[bm]['width']+';\x20height:\x20auto;\x20display:\x20none;\x20z-index:\x205;\x20position:\x20absolute;\x20'+aJ[aI];bs['innerHTML']='<a\x20id\x20=\x20\x22titleText\x22\x20style\x20=\x20\x22position:\x20absolute;line-height:\x2035px;\x20left:\x205px;\x22>'+aO[bm]['title']['filling']+'</a><a\x20id\x20=\x20\x22settingsDivCancel\x22\x20style\x20=\x20\x22position:\x20absolute;\x20right:\x205px;\x20top:\x20-2px;\x20cursor:\x20pointer;\x22>[X]</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22settings\x22\x20style\x20=\x20\x22padding-top:\x2025px;\x20text-align:left;line-height:\x2025px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22cursorColorText\x22\x20class\x20=\x20\x22textButton\x22>'+aO[bm]['cursorColor']['filling']+'</span><span\x20id\x20=\x20\x22cursorColor\x22\x20class\x20=\x20\x22textButton\x22\x20style\x20=\x20\x22color:'+be+'\x22>'+be+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22gridText\x22\x20class\x20=\x20\x22textButton\x22>'+aO[bm]['grid']['filling']+'</span><span\x20id\x20=\x20\x22grid\x22\x20class\x20=\x20\x22textButton\x22>'+(bf?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22mapStyleText\x22\x20class\x20=\x20\x22textButton\x22>'+aO[bm]['mapStyle']['filling']+'</span><span\x20id\x20=\x20\x22mapStyle\x22\x20class\x20=\x20\x22textButton\x22>'+aI+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+aO[bm]['sectors']['filling']+'</span><span\x20id\x20=\x20\x22sectors\x22\x20class\x20=\x20\x22textButton\x22>'+(bg?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorShiftText\x22\x20class\x20=\x20\x22textButton\x22>'+aO[bm]['sectorShift']['filling']+'</span><span\x20id\x20=\x20\x22sectorShift\x22\x20class\x20=\x20\x22textButton\x22>'+(bh?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22translucentText\x22\x20class\x20=\x20\x22textButton\x22>'+aO[bm]['translucent']['filling']+'</span><span\x20id\x20=\x20\x22translucent\x22\x20class\x20=\x20\x22textButton\x22>'+(bj?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22detectorText\x22\x20class\x20=\x20\x22textButton\x22>'+aO[bm]['detector']['filling']+'</span><span\x20id\x20=\x20\x22detector\x22\x20class\x20=\x20\x22textButton\x22>'+(bk?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22syncText\x22\x20class\x20=\x20\x22textButton\x22>'+aO[bm]['sync']['filling']+'</span><span\x20id\x20=\x20\x22sync\x22\x20class\x20=\x20\x22textButton\x22>'+(bl?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22languageText\x22\x20class\x20=\x20\x22textButton\x22>'+aO[bm]['language']['filling']+'</span><span\x20id\x20=\x20\x22language\x22\x20class\x20=\x20\x22textButton\x22>'+bm+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22update\x22\x20style\x20=\x20\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20New\x20update\x20available!\x20Please\x20follow\x20this\x20<a\x20href=\x22https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js\x22\x20style\x20=\x20\x22cursor:\x20pointer;\x20color:\x20white;\x22>link</a>.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';document['body']['appendChild'](bs);window['addEventListener']('unload',function(){return localStorage['zoomlevel']=aT;});aR&&(au('detector')['style']['cursor']='not-allowed',au('detectorText')['style']['cursor']='not-allowed');window['onkeydown']=function(aS){switch(aS['keyCode']){case 0x1b:au('settingsDiv')['style']['display']='none';break;case 0x30:'true'==localStorage['debug']?(aU=!0x1,aw('Debug\x20is\x20off')):(aU=!0x0,aw('Debug\x20is\x20enabled'));localStorage['debug']=aU;break;case 0x31:as('factions');break;case 0x32:au('settingsButton')['click']();break;case 0x33:au('sectors')['click']();break;case 0x34:au('detector')['click']();}};au('cursorColorText')['onclick']=au('cursorColor')['onclick']=function(){be=aH['indexOf'](be)+0x1==aH['length']?aH[0x0]:aH[aH['indexOf'](be)+0x1];localStorage['cursorColor']=au('cursorColor')['innerText']=au('cursorColor')['style']['color']=be;aq();};au('gridText')['onclick']=au('grid')['onclick']=function(){bz['clearRect'](0x0,0x0,bv['width'],bv['height']);localStorage['grid']=bf=!bf;au('grid')['innerText']=bf?'On':'Off';aj();};au('mapStyleText')['onclick']=au('mapStyle')['onclick']=function(){aI='Old'==aI?'New':'Old';localStorage['mapStyle']=aI;au('minimap-box')['style']['width']=aL[aI]+'px';au('minimap-box')['style']['height']=aM[aI]+'px';for(var bs=0x0;bs<au('minimap-box')['childNodes']['length'];bs++){var b5=au('minimap-box')['childNodes'][bs];b5['width']=b5['offsetWidth'];b5['height']=b5['offsetHeight'];}bx['mozImageSmoothingEnabled']=by['mozImageSmoothingEnabled']=!0x1;bx['webkitImageSmoothingEnabled']=by['webkitImageSmoothingEnabled']=!0x1;bx['msImageSmoothingEnabled']=by['msImageSmoothingEnabled']=!0x1;bx['imageSmoothingEnabled']=by['imageSmoothingEnabled']=!0x1;bk||bl?aC(aS):aC();au('settingsDiv')['style']='width:\x20'+au('settingsDiv')['style']['width']+';\x20height:\x20auto;\x20display:\x20'+au('settingsDiv')['style']['display']+';\x20position:\x20absolute;\x20left:\x20'+au('settingsDiv')['style']['left']+';\x20top:\x20'+au('settingsDiv')['style']['top']+';\x20'+aJ[aI];au('minimapbg')['style']=aK[aI];au('mapStyle')['innerText']=aI;aq();aj();bo();};au('sectorsText')['onclick']=au('sectors')['onclick']=function(){bg=!bg;U();bg?bo():by['clearRect'](0x0,0x0,bu['width'],bu['height']);au('sectors')['innerText']=bg?'On':'Off';localStorage['sectors']=bg;};au('settingsDivCancel')['onclick']=function(){return as('settingsDiv');};au('sectorShiftText')['onclick']=au('sectorShift')['onclick']=function(){bi=(bh=!bh)?0.8:0x1;au('sectorShift')['innerText']=bh?'On':'Off';localStorage['sectorShift']=bh;bo();};au('translucentText')['onclick']=au('translucent')['onclick']=function(){bj=!bj;au('translucent')['innerText']=bj?'On':'Off';au('minimapSectors')['style']['opacity']=aN[bj];localStorage['translucent']=bj;bo();};au('detectorText')['onclick']=au('detector')['onclick']=function(){aR||((bk=!bk)?(au('zoom-minus')['style']['cursor']=au('zoom-plus')['style']['cursor']='not-allowed',bD['override']()):au('zoom-minus')['style']['cursor']=au('zoom-plus')['style']['cursor']='pointer',au('detector')['innerText']=bk?'On':'Off',localStorage['detector']=bk,aC(aS),U(),n(),aj(),aq());};au('languageText')['onclick']=au('language')['onclick']=function(){var aS=Object['keys'](aO),bs=aS['indexOf'](bm);++bs>=aS['length']&&(bs=0x0);localStorage['language']=au('language')['innerText']=bm=aS[bs];aS=Object['keys'](aO[bm]);au('settingsDiv')['style']['width']=aO[bm]['width'];aS['forEach'](function(aS){au(aS+'Text')&&('title'!=aS?au(aS+'Text')['innerText']=aO[bm][aS]['filling']:au('titleText')['innerText']=aO[bm]['title']['filling']);});};au('syncText')['onclick']=au('sync')['onclick']=function(){(bl=!bl)?aC(aS):aC();localStorage['sync']=bl;au('sync')['innerText']=bl?'On':'Off';U();n();aj();aq();};},0x4b0);
//Hi PowerGab
