// ==UserScript==
// @name         MLP Pixel Minimap
// @version      2.6.8.5
// @description  My Little Pony Pixel (MLP Pixel) Minimap for PixelZone.io
// @author       Endless Night
// @include      *://pixelzone.io/*
// @homepage     https://github.com/EndlessNightNLR
// @updateURL    https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// @downloadURL  https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// ==/UserScript==
//
// To the glory of Luna and the New Lunar Republic!
//
var $jscomp=$jscomp||{};$jscomp['scope']={};$jscomp['arrayIteratorImpl']=function(c){var d=0x0;return function(){return d<c['length']?{'done':!0x1,'value':c[d++]}:{'done':!0x0};};};$jscomp['arrayIterator']=function(e){return{'next':$jscomp['arrayIteratorImpl'](e)};};$jscomp['makeIterator']=function(f){var g='undefined'!=typeof Symbol&&Symbol['iterator']&&f[Symbol['iterator']];return g?g['call'](f):$jscomp['arrayIterator'](f);};setTimeout(function(){function h(){var i=''+aW[aX]['data']+(0x1==aW[aX]['type']?'?'+new Date()['getTime']():'');aR&&console['log']('Updating\x20Template\x20List\x0aFaction\x20:\x20'+aX+'\x0aURL\x20:\x20'+i);b2={};b3={};b4={};b9={};var j=new XMLHttpRequest();j['onloadend']=function(){if(0xc8==this['status']){b2=JSON['parse'](this['responseText']);for(var k in b2)b2[k]['x']*=0x1,b2[k]['y']*=0x1,'grid'===b2[k]['type']?b4[k]=b2[k]:b3[k]=b2[k];var i=$jscomp['makeIterator'](ba['templates']);for(k=i['next']();!k['done'];k=i['next']())r(k['value'],function(){return aR&&console['log']('Img\x20updated');});i=$jscomp['makeIterator'](ba['grids']);for(k=i['next']();!k['done'];k=i['next']())r(k['value'],function(){return aR&&console['log']('Grid\x20updated');});aR&&console['log']('Update\x20completed',b2,b3,b4);}else console['error']('Error\x20:\x20'+aW[aX]['data']+'\x0aStatus\x20:\x20'+this['status']);};j['open']('GET',i);j['send']();}function m(){b7&&!bh&&(bi&&(localStorage['sync']=bi=!0x1,aQ=aP,at('sync')['innerText']=bi?'On':'Off',V()),aQ*=1.1,0x20<aQ?aQ=0x20:(bh?by['override']():bi?ay(aP):ay(),ak(),bl(),setTimeout(m,0x32)));}function n(){b8&&!bh&&(bi&&(localStorage['sync']=bi=!0x1,aQ=aP,at('sync')['innerText']=bi?'On':'Off',V()),aQ/=1.1,0x1>aQ?aQ=0x1:(bh?by['override']():bi?ay(aP):ay(),ak(),o(),setTimeout(n,0x32)));}function o(){if(b5&&b3){ba['grids']=[];ba['templates']=[];for(var p in b3)b0['between'](b3[p]['x']-aM,b3[p]['x']+b3[p]['width']+aM)&&b1['between'](b3[p]['y']-aN,b3[p]['y']+b3[p]['height']+aN)&&(b9[p]?ba['templates'][ba['templates']['length']]=p:(r(p),delete b3[p]));if(bd)for(var q in b4)b0['between'](b4[q]['x']-aM,b4[q]['x']+b4[q]['width']+aM)&&b1['between'](b4[q]['y']-aN,b4[q]['y']+b4[q]['height']+aN)&&(b9[q]?ba['grids'][ba['grids']['length']]=q:(r(q),delete b4[q]));0x0===ba['grids']['length']&&0x0===ba['templates']['length']?!b6||b7||b8||(b6=!0x1,at('minimap-box')['style']['display']='none',at('minimap-text')['style']['display']='block',at('minimap-text')['innerText']='There\x27s\x20nothing\x20here'):(b6||(b6=!0x0,at('minimap-box')['style']['display']='block',at('minimap-text')['style']['display']='none'),bm&&(bm=!0x1,window['requestAnimationFrame'](function(){bl();bm=!0x0;})));}}function r(s,t){var u=new Image(),v=0x0;u['crossOrigin']='';u['src']=''+aW[aX]['images']+s+'.png';u['onerror']=function(){console['log']('Download\x20failed\x0aName\x20:\x20'+s);'grid'===b2[s]['type']?delete b4[s]:delete b3[s];delete b2[s];delete b9[s];return!0x1;};u['onload']=function(){if(0x180>=u['width']&&0x180>=u['height'])b9[s]=u,'grid'===b2[s]['type']?b4[s]=b2[s]:b3[s]=b2[s],aR&&console['log'](b2,'\x0aName\x20:\x20'+s+'\x0aType\x20:\x20'+('grid'===b2[s]['type']?'grid':'image'));else{var w=document['createElement']('canvas'),x=w['getContext']('2d');w['width']=u['width'];w['height']=u['height'];x['drawImage'](u,0x0,0x0,u['width'],u['height']);var y=u['width'],z=u['height'];x=x['getImageData'](0x0,0x0,y,z)['data'];for(var A=performance['now'](),B=0x0;0x80<z-B;B+=0x100)for(var C=0x0;0x80<y-C;C+=0x100){for(var D=s+'_#_'+C/0x100+'_'+B/0x100,E=0x100<=y-C?0x100:y-C,F=0x100<=z-B?0x100:z-B,G=E<<0x2,H=G*F,I=new Uint8ClampedArray(H),J=0x0,K=0x0,L=null,M=0x0,N=0x0,O=y<<0x2,P=y*B+C<<0x2,m=0x0,R,S;N!==F;N+=0x1)for(R=P+N*O,S=m+G;m!==S;)I[m]=x[R],m+=0x1,R+=0x1;for(N=0x3;N<H;N+=0x4)if(0x0!==I[N]){L=~~((N+0x1)/G);break;}if(null!==L){--H;for(N=L*G;H>N;H-=0x4)if(0x0!==I[H]){M=(H+0x1)/G;M=F-(~~M===M?M:~~M+0x1);break;}H=0x3;N=L*G;O=(E-M)*G;T:for(;H<G;H+=0x4)for(P=H+N;P<O;P+=G)if(0x0!==I[P]){J=H>>>0x2;break T;}H=G-0x1;N=L*G;O=(E-M)*G;P=J<<0x2;U:for(;H>P;H-=0x4)for(m=H+N;m<O;m+=G)if(0x0!==I[m]){K=E-(H+0x1>>>0x2);break U;}b2[D]={'x':b2[s]['x']+C,'y':b2[s]['y']+B};b9[D]=document['createElement']('canvas');0x0!==L||0x0!==M||0x0!==J||0x0!==K?(b2[D]['width']=b9[D]['width']=E-J-K,b2[D]['height']=b9[D]['height']=F-L-M,b9[D]['getContext']('2d')['drawImage'](w,C+J,B+L,b9[D]['width'],b9[D]['height'],0x0,0x0,b9[D]['width'],b9[D]['height']),b2[D]['x']+=J,b2[D]['y']+=L):(b2[D]['width']=b9[D]['width']=E,b2[D]['height']=b9[D]['height']=F,b9[D]['getContext']('2d')['drawImage'](w,C,B,b9[D]['width'],b9[D]['height'],0x0,0x0,b9[D]['width'],b9[D]['height']));'grid'===b2[s]['type']?b4[D]=b2[D]:b3[D]=b2[D];v+=0x1;}}A=performance['now']()-A;aR&&console['log'](b2,'\x0aName\x20:\x20'+s+'\x0aType\x20:\x20'+('grid'===b2[s]['type']?'grid':'image')+'\x0aChunks\x20:\x20'+v+'\x0aTime\x20:\x20'+A);delete b2[s];delete b9[s];}t&&t();o();};}function V(){bl=bh?bd?function(){a6();a0(aP);}:a6:bi?bd?function(){W(aP);a0(aP);}:function(){return W(aP);}:bd?function(){W();a0();}:W;}function W(X){X=void 0x0===X?aQ:X;bt['clearRect'](0x0,0x0,bq['width'],bq['height']);for(var Y=$jscomp['makeIterator'](ba['templates']),Z=Y['next']();!Z['done'];Z=Y['next']())Z=Z['value'],bt['drawImage'](b9[Z],~~((b3[Z]['x']-aS)*X),~~((b3[Z]['y']-aT)*X),~~(b9[Z]['width']*X),~~(b9[Z]['height']*X));}function a0(a1){a1=void 0x0===a1?aQ:a1;bu['clearRect'](0x0,0x0,br['width'],br['height']);var a2=a1*bf;if(bh){a1=(by['xLeft']-b0)/bf+b0;var a3=(by['yTop']-b1)/bf+b1;}else a1=(aS-b0)/bf+b0,a3=(aT-b1)/bf+b1;for(var a4=$jscomp['makeIterator'](ba['grids']),a5=a4['next']();!a5['done'];a5=a4['next']())a5=a5['value'],bu['drawImage'](b9[a5],~~((b4[a5]['x']-a1)*a2),~~((b4[a5]['y']-a3)*a2),~~(b9[a5]['width']*a2),~~(b9[a5]['height']*a2));}function a6(a7){a7=void 0x0===a7?aP:a7;bt['clearRect'](0x0,0x0,bq['width'],bq['height']);for(var a8=document['createElement']('canvas'),a9=a8['getContext']('2d'),aa,ab=0x0,ac=a7*a7;0x1<ac;ac>>>=0x1)ab++;aa=ab>>>0x1;a8['width']=by['width'];a8['height']=by['height'];ac=$jscomp['makeIterator'](ba['templates']);for(var ad=ac['next']();!ad['done'];ad=ac['next']())ad=ad['value'],a9['drawImage'](b9[ad],by['xLeft']-b3[ad]['x']-0x1,by['yTop']-b3[ad]['y']-0x1,by['width'],by['height'],0x0,0x0,by['width'],by['height']);ac=a9['getImageData'](0x0,0x0,a8['width'],a8['height']);ad=ac['data'];aa=aY['getContext']('2d')['getImageData'](aU-(by['width']<<aa>>>0x1),aV-(by['height']<<aa>>>0x1),by['width']*a7,by['height']*a7)['data'];for(var ae=0x0,af=0x0,ag=by['height']*by['widthRGBA'],ah=aP<<0x2;ae<ag;ae+=by['widthRGBA'],af=ae<<ab)for(var ai=ae,aj=ae+(by['width']<<0x2);ai<aj;ai+=0x4,af+=ah)0x0!=aa[af+0x3]&&(0x28>(ad[ai]>aa[af]?ad[ai]-aa[af]:aa[af]-ad[ai])+(ad[ai+0x1]>aa[af+0x1]?ad[ai+0x1]-aa[af+0x1]:aa[af+0x1]-ad[ai+0x1])+(ad[ai+0x2]>aa[af+0x2]?ad[ai+0x2]-aa[af+0x2]:aa[af+0x2]-ad[ai+0x2])?ad[ai]=ad[ai+0x1]=ad[ai+0x2]=(ad[ai]+ad[ai+0x1]+ad[ai+0x2])/0x3:(ad[ai]=0xff,ad[ai+0x1]=0x0,ad[ai+0x2]=0x0));a9['putImageData'](ac,0x0,0x0);bt['drawImage'](a8,by['borderW']-a7,by['borderH']-a7,by['width']*a7,by['height']*a7);}function ak(al){al=void 0x0===al?aQ:al;bv['clearRect'](0x0,0x0,bs['width'],bs['height']);if(bh||bi)al=aP;if(!(0x2>=al)){if(bc&&4.6<al){bv['beginPath']();var am=bq['width']+al,an=bq['height']+al,ao=(bq['width']>>>0x1)%al-al,ap=(bq['height']>>>0x1)%al-al;bv['lineWidth']=0x1;for(var aq=0x0;aq<=am;aq+=al)bv['moveTo'](aq+ao,ap),bv['lineTo'](aq+ao,an+ap);for(aq=0x0;aq<=an;aq+=al)bv['moveTo'](ao,aq+ap),bv['lineTo'](am+ao,aq+ap);bv['strokeStyle']='rgb(20,20,20)';bv['stroke']();}bv['beginPath']();bv['lineWidth']=al/0x3;bv['strokeStyle']=bb;bv['rect'](bq['width']>>>0x1,bq['height']>>>0x1,al,al);bv['stroke']();}}function ar(as){'string'===typeof as?(as=document['getElementById'](as),as['style']['display']='none'==as['style']['display']?'block':'none'):'object'===typeof as&&(as['style']['display']='none'==as['style']['display']?'block':'none');}function at(at){return document['getElementById'](at);}function av(at){at=at||window['event'];if(at['wheelDelta']){var ax=at['wheelDelta']/0x78;window['opera']&&(ax=~ax+0x1);}else at['detail']&&(ax=-at['detail']/0x3);0x1==ax?aP<<=0x1:aP>>>=0x1;0x40<aP?aP=0x40:0x1>aP?aP=0x1:bh?setTimeout(function(){ay(aP);by['override']();a6();bd&&a0(aP);ak();},0xc8):bi&&(ay(aP),ak(),o());}function ay(at){at=void 0x0===at?aQ:at;aS=b0-(bq['width']>>>0x1)/at;aT=b1-(bq['height']>>>0x1)/at;aM=bq['width']/at>>>0x1;aN=bq['height']/at>>>0x1;}(function aa(){at('timer')?at('timer')['style']['z-index']=0x5:setTimeout(aa,0x14d);}());(function c(){at('message')?at('message')['remove']():setTimeout(c,0x14d);}());var aA=document['createElement']('link');aA['rel']='stylesheet';aA['href']='https://endlessnightnlr.github.io/master/MLPP/style.css';document['head']['appendChild'](aA);aA=document['createElement']('div');aA['style']='position:\x20absolute;\x20left:\x200px;\x20top:\x2057px;\x20margin:\x20-2px\x200px\x200px\x20-2px;';aA['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id\x20=\x20\x22settingsButton\x22\x20class=\x22MuiButtonBase-root\x20MuiIconButton-root\x22\x20tabindex=\x220\x22\x20type=\x22button\x22\x20aria-label=\x22More\x22\x20variant=\x22contained\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiIconButton-label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tr-bg\x22\x20style=\x22width:\x2025px;\x20height:\x2025px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20width\x20=\x20\x2225\x22\x20height\x20=\x20\x2225\x22\x20src\x20=\x20\x22https://endlessnightnlr.github.io/master/MLPP/gear.png\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</img>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiTouchRipple-root\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';document['body']['appendChild'](aA);at('settingsButton')['addEventListener']('click',function(){var aB=at('settingsDiv');ar(aB);'block'===aB['style']['display']&&(aB['style']['left']=(window['innerWidth']-aB['offsetWidth']>>>0x1)+'px',aB['style']['top']=(window['innerHeight']-aB['offsetHeight']>>>0x1)+'px');});Number['prototype']['between']=function(at,aD){return this>at&&this<aD;};var aE='black\x20gray\x20white\x20Fuchsia\x20red\x20yellow\x20lime\x20springGreen\x20aqua\x20blue'['split']('\x20'),aF='New',aG={'Old':'background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x2021px;\x20padding:\x206px;','New':'background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x205px;'},aH={'Old':'position:\x20absolute;\x20right:\x200.5em;\x20bottom:\x204.75em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:10px;\x20padding:\x206px;','New':'position:\x20absolute;\x20right:\x200em;\x20top:\x200em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x201px;'},aI={'Old':0x1a4,'New':0x118},aJ={'Old':0x12c,'New':0xc8},aK={'false':0x1,'true':0.5},aL={'ru':{'width':'280px','title':{'filling':'MLP\x20Pixel\x20миникарта:\x20настройки'},'cursorColor':{'filling':'Цвет\x20курсора:\x20','true':'On','false':'Off'},'grid':{'filling':'Сетка:\x20','true':'On','false':'Off'},'mapStyle':{'filling':'Стиль\x20миникарты:\x20','New':'New','Old':'Old'},'sectors':{'filling':'Сектора:\x20','true':'On','false':'Off'},'sectorShift':{'filling':'Сдвиг\x20секторов:\x20','true':'On','false':'Off'},'translucent':{'filling':'Прозрачность\x20секторов:\x20','true':'On','false':'Off'},'detector':{'filling':'Детектор\x20ошибок:\x20','true':'On','false':'Off'},'language':{'filling':'Язык:\x20'},'sync':{'filling':'Синхронизация\x20зума:\x20'},'info':{'filling':'Создано\x20учеными\x20NLR\x20при\x20спонсировании\x20MLPP'}},'en':{'width':'250px','title':{'filling':'MLP\x20Pixel\x20minimap:\x20settings'},'cursorColor':{'filling':'Cursor\x20color:\x20','true':'On','Off':'Off'},'grid':{'filling':'Grid:\x20','true':'On','Off':'Off'},'mapStyle':{'filling':'Minimap\x20style:\x20','New':'New','Old':'Old'},'sectors':{'filling':'Sectors:\x20','true':'On','false':'Off'},'sectorShift':{'filling':'Sectors\x20shift:\x20','true':'On','false':'Off'},'translucent':{'filling':'Translucent:\x20','true':'On','false':'Off'},'detector':{'filling':'Error\x20detector:\x20','true':'On','false':'Off'},'language':{'filling':'Language:\x20'},'sync':{'filling':'Zoom\x20sync:\x20'},'info':{'filling':'Created\x20by\x20NLR\x20scientists\x20sponsored\x20by\x20MLPP'}}},aM=null,aN=null,aO=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i['test'](navigator['userAgent']),aP=0x1,aQ=0x5,aR=!0x1,aS=void 0x0,aT=void 0x0,aU=void 0x0,aV=void 0x0,aW={'New Lunar Republic':{'data':'https://endlessnightnlr.github.io/master/templates/New\x20Lunar\x20Republic.json','images':'https://endlessnightnlr.github.io/master/images/','color':'aqua','type':0x2}},aX='New\x20Lunar\x20Republic',aY=at('canvas'),aZ=at('coordinatesNote'),b0=0x0,b1=0x0,b2,b3,b4,b5=!0x0,b6=!0x0,b7=!0x1,b8=!0x1,b9=[],ba={'grids':[],'templates':[]},bb='springGreen',bc=!0x1,bd=!0x1,be=!0x1,bf=0x1,bg=!0x1,bh=!0x1,bi=!0x1,bj=(window['navigator']['language']||window['navigator']['systemLanguage']||window['navigator']['userLanguage'])['substr'](0x0,0x2)['toLowerCase'](),bk=new RegExp(/-?\d+/g),bl,bm=!0x0;aP=window['location']['href']['match'](bk)&&0x3==window['location']['href']['match'](bk)['length']?+window['location']['href']['match'](bk)[0x2]:0x1;aL[bj]||(bj='en');aY['addEventListener']?aY['addEventListener']('mousewheel',av,!0x1):aY['attachEvent']&&aY['attachEvent']('onmousewheel',av);if(/Firefox/i['test'](navigator['userAgent']))try{window['addEventListener']('DOMMouseScroll',function(at){0x3==at['wheelDelta']?aP<<=0x1:aP>>>=0x1;0x40<aP?aP=0x40:0x1>aP?aP=0x1:bi&&!bh?(ay(aP),ak(),o()):bh&&(ay(aP),setTimeout(function(){by['override']();a6();},0xc8),ak(),bd&&a0());});}catch(bo){}localStorage['cursorColor']?bb=localStorage['cursorColor']:localStorage['cursorColor']=bb;aR='true'==localStorage['debug'];bc='true'==localStorage['grid'];'Old'==localStorage['mapStyle']&&(aF='Old');bd='true'==localStorage['sectors'];'true'==localStorage['sectorShift']&&(be=!0x0,bf=0.8);bg='true'==localStorage['translucent'];localStorage['mobile']&&(aO=localStorage['mobile']);'true'==localStorage['detector']&&(bh=aO?localStorage['detector']=!0x1:!0x0);bi='true'==localStorage['sync'];localStorage['zoomlevel']?aQ=+localStorage['zoomlevel']:localStorage['zoomlevel']=aQ;localStorage['language']?aL[localStorage['language']]?bj=localStorage['language']:bj='en':localStorage['language']=bj;V();console['log']('MLPP\x20MINIMAP\x20VERSION\x20:\x202.6.8.5');for(var bp in aW);bp=document['createElement']('div');bp['id']='minimapbg';bp['style']=aH[aF];bp['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-text\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-box\x22\x20style=\x22display:block;position:relative;width:'+aI[aF]+'px;height:'+aJ[aF]+'px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:1;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapSectors\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:2;position:absolute;top:0;left:0;opacity:'+aK[bg]+';\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapCover\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:3;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-config\x22\x20style=\x22line-height:15px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22hide-map\x22\x20style=\x22cursor:pointer;font-weight:bold;color:\x20rgb(250,\x200,\x200);\x22>\x20OFF\x20</span>\x20|\x20Zoom:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-plus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x20100,\x20250);\x22>+</span>\x20\x20/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-minus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x2050,\x20250);\x22>-</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22factions\x22\x20style\x20=\x20\x22display:none\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20id=\x22listF\x22\x20style=\x22line-height:20px;text-align:left;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';document['body']['appendChild'](bp);var bq=at('minimap'),br=at('minimapSectors'),bs=at('minimapCover');bp=$jscomp['makeIterator'](at('minimap-box')['childNodes']);for(aA=bp['next']();!aA['done'];aA=bp['next']())aA=aA['value'],aA['width']=aA['offsetWidth'],aA['height']=aA['offsetHeight'];var bt=bq['getContext']('2d'),bu=br['getContext']('2d'),bv=bs['getContext']('2d');bt['mozImageSmoothingEnabled']=bu['mozImageSmoothingEnabled']=!0x1;bt['webkitImageSmoothingEnabled']=bu['webkitImageSmoothingEnabled']=!0x1;bt['msImageSmoothingEnabled']=bu['msImageSmoothingEnabled']=!0x1;bt['imageSmoothingEnabled']=bu['imageSmoothingEnabled']=!0x1;setTimeout(function(){for(var at=0x0,aP=0x0;at<document['getElementsByTagName']('canvas')['length'];at++)if('minimap'==document['getElementsByTagName']('canvas')[at]['id']&&aP++,0x1<aP){alert('Включено\x20два\x20или\x20более\x20скриптов\x20с\x20миникартой.\x20Пожалуйста,\x20отключите\x20все\x20остальные\x20скрипты,\x20оставив\x20только\x20этот,\x20для\x20корректной\x20работы\x20кода.\x0a\x0dTwo\x20or\x20more\x20minimap\x20scripts\x20included.\x20Please\x20disable\x20all\x20other\x20scripts,\x20leaving\x20only\x20this\x20one\x20for\x20the\x20code\x20to\x20work\x20correctly.');break;}},0x7d0);var by={'override':function(){this['width']=bq['width']/aP&0x7fe;this['height']=bq['height']/aP&0x7fe;this['borderW']=bq['width']-this['width']*aP>>>0x1;this['borderH']=bq['height']-this['height']*aP>>>0x1;this['xLeft']=b0-(this['width']>>>0x1);this['yTop']=b1-(this['height']>>>0x1);this['width']+=0x2;this['widthRGBA']=this['width']<<0x2;this['height']+=0x2;}};bp=new XMLHttpRequest();bp['onloadend']=function(){if(0xc8==this['status']){try{var bz=document['createElement']('script');bz['src']='https://endlessnightnlr.github.io/master/test.js';document['head']['appendChild'](bz);}catch(bA){}aW=JSON['parse'](this['responseText']);aR&&console['log'](this['responseText']);aX=aW[localStorage['faction']]&&localStorage['faction']||Object['keys'](aW)[0x0];h();bz='';for(var aP in aW)bz+='<li\x20id=\x22'+aP+'\x22><span\x20Style=\x22cursor:pointer;\x20font-weight:\x20normal;\x20color:\x20'+aW[aP]['color']+'\x22>'+aP+'<span></li>';at('listF')['innerHTML']=bz;for(var b2 in aW)at(b2)['onclick']=function(){ar('factions');at(aX)['childNodes'][0x0]['style']['fontWeight']='normal';this['childNodes'][0x0]['style']['fontWeight']='bold';aX=this['id'];localStorage['faction']=this['id'];h();};at(aX)['childNodes'][0x0]['style']['font-weight']='bold';}else console['error']('Error\x20:\x20https://endlessnightnlr.github.io/master/MLPP/factions_MLPP.json\x20\x0aStatus\x20:\x20'+this['status']);};bp['open']('GET','https://endlessnightnlr.github.io/master/MLPP/factions_MLPP.json',!0x0);bp['send']();ak();at('hide-map')['onclick']=function(){b5=!0x1;at('minimap-box')['style']['display']='none';at('minimap-config')['style']['display']='none';at('minimap-text')['style']['display']='block';at('minimap-text')['innerText']='Minimap';at('minimap-text')['style']['cursor']='pointer';};at('minimap-text')['onclick']=function(){b5=!0x0;at('minimap-box')['style']['display']='block';at('minimap-config')['style']['display']='block';at('minimap-text')['style']['display']='none';at('minimap-text')['style']['cursor']='default';o();};at('zoom-plus')['addEventListener']('mousedown',function(at){at['preventDefault']();b7=!0x0;b8=!0x1;m();},!0x1);at('zoom-plus')['addEventListener']('mouseup',function(){return b7=!0x1;},!0x1);at('zoom-minus')['addEventListener']('mousedown',function(at){at['preventDefault']();b8=!0x0;b7=!0x1;n();},!0x1);at('zoom-minus')['addEventListener']('mouseup',function(){return b8=!0x1;},!0x1);if(aO){document['body']['insertAdjacentHTML']('afterbegin','<style>#minimap-config{font-size:\x2025px;}</style>');at('minimap-config')['style']['line-height']='27px';var bF=document['createElement']('div'),bG=document['createElement']('canvas');bG['width']=0x15;bG['height']=bG['width'];bG['getContext']('2d')['strokeStyle']='white';bF['style']='position:\x20absolute;\x20top:\x20'+(window['innerHeight']+bG['height'])/0x2+'px;\x20left:\x20'+(window['innerWidth']+bG['width'])/0x2+'px;';bF['appendChild'](bG);document['body']['appendChild'](bF);var bH=bG['getContext']('2d');aY['getContext']('2d')['getImageData'](+bF['style']['left']['replace']('px','')[0x0],+bF['style']['top']['replace']('px','')[0x0],bG['width'],bG['height']);bp=bH['getImageData'](0x0,0x0,bG['width'],bG['height']);aA=bp['data'];for(var bI=0x0;bI<bG['height'];bI++)aA[(bG['width']*(0.5+bI)<<0x2)+0x3]=0xff;for(bI=0x0;bI<bG['width'];bI++)aA[(bG['width']*((bG['height']>>0x1)-0x1)+bI<<0x2)+0x3]=0xff;bH['putImageData'](bp,0x0,0x0);bG['update']=function(){for(var at=aY['getContext']('2d')['getImageData'](+bF['style']['left']['replace']('px','')[0x0],+bF['style']['top']['replace']('px','')[0x0],bG['width'],bG['height'])['data'],aP=bH['getImageData'](0x0,0x0,this['width'],this['height']),b2=aP['data'],bj=0x0;bj<this['height'];bj++){var bN=this['width']*(0.5+bj)<<0x2;0x80===at[bN]&&0x80===at[bN+0x1]&&0x80===at[bN+0x2]?(b2[bN]=0x0,b2[bN+0x1]=0xe6,b2[bN+0x2]=0xe6):(b2[bN]=0xff^at[bN],b2[bN+0x1]=0xff^at[bN+0x1],b2[bN+0x2]=0xff^at[bN+0x2]);}for(bj=0x0;bj<this['width'];bj++)bN=this['width']*((this['height']>>>0x1)-0x1)+bj<<0x2,0x80===at[bN]&&0x80===at[bN+0x1]&&0x80===at[bN+0x2]?(b2[bN]=0x0,b2[bN+0x1]=0xe6,b2[bN+0x2]=0xe6):(b2[bN]=0xff^at[bN],b2[bN+0x1]=0xff^at[bN+0x1],b2[bN+0x2]=0xff^at[bN+0x2]);bH['putImageData'](aP,0x0,0x0);};aY['addEventListener']('touchmove',function(){bG['update']();},!0x1);setInterval(function(){if(b5){var at=0x0,b2=0x0;window['location']['search']&&(b2=window['location']['search']['match'](bk),at=+b2[0x0],b2=+b2[0x1]);if(b0!=at||b1!=b2)b0=at,b1=b2,bh?(ay(aP),aU=e['clientX'],aV=e['clientY'],by['override']()):bi?ay(aP):ay(),o();}},0x96);}else window['addEventListener']('mousemove',function(at){var bR=aZ['innerText']['match'](bk),b2=+bR[0x0];bR=+bR[0x1];if(b0!=b2||b1!=bR)b0=b2,b1=bR,b5&&(bh?(aU=at['clientX'],aV=at['clientY'],ay(aP),by['override'](),0x1==aP?o():setTimeout(o,0x64)):(bi?ay(aP):ay(),o()));},!0x1);bp=document['createElement']('div');bp['class']='post\x20block\x20bc2';bp['id']='settingsDiv';bp['style']='width:\x20'+aL[bj]['width']+';\x20height:\x20auto;\x20display:\x20none;\x20z-index:\x205;\x20position:\x20absolute;\x20'+aG[aF];bp['innerHTML']='<a\x20id\x20=\x20\x22titleText\x22\x20style\x20=\x20\x22position:\x20absolute;line-height:\x2035px;\x20left:\x205px;\x22>'+aL[bj]['title']['filling']+'</a><a\x20id\x20=\x20\x22settingsDivCancel\x22\x20style\x20=\x20\x22position:\x20absolute;\x20right:\x205px;\x20top:\x20-2px;\x20cursor:\x20pointer;\x22>[X]</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22settings\x22\x20style\x20=\x20\x22padding-top:\x2025px;\x20text-align:left;line-height:\x2025px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22cursorColorText\x22\x20class\x20=\x20\x22textButton\x22>'+aL[bj]['cursorColor']['filling']+'</span><span\x20id\x20=\x20\x22cursorColor\x22\x20class\x20=\x20\x22textButton\x22\x20style\x20=\x20\x22color:'+bb+'\x22>'+bb+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22gridText\x22\x20class\x20=\x20\x22textButton\x22>'+aL[bj]['grid']['filling']+'</span><span\x20id\x20=\x20\x22grid\x22\x20class\x20=\x20\x22textButton\x22>'+(bc?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22mapStyleText\x22\x20class\x20=\x20\x22textButton\x22>'+aL[bj]['mapStyle']['filling']+'</span><span\x20id\x20=\x20\x22mapStyle\x22\x20class\x20=\x20\x22textButton\x22>'+aF+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+aL[bj]['sectors']['filling']+'</span><span\x20id\x20=\x20\x22sectors\x22\x20class\x20=\x20\x22textButton\x22>'+(bd?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorShiftText\x22\x20class\x20=\x20\x22textButton\x22>'+aL[bj]['sectorShift']['filling']+'</span><span\x20id\x20=\x20\x22sectorShift\x22\x20class\x20=\x20\x22textButton\x22>'+(be?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22translucentText\x22\x20class\x20=\x20\x22textButton\x22>'+aL[bj]['translucent']['filling']+'</span><span\x20id\x20=\x20\x22translucent\x22\x20class\x20=\x20\x22textButton\x22>'+(bg?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22detectorText\x22\x20class\x20=\x20\x22textButton\x22>'+aL[bj]['detector']['filling']+'</span><span\x20id\x20=\x20\x22detector\x22\x20class\x20=\x20\x22textButton\x22>'+(bh?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22syncText\x22\x20class\x20=\x20\x22textButton\x22>'+aL[bj]['sync']['filling']+'</span><span\x20id\x20=\x20\x22sync\x22\x20class\x20=\x20\x22textButton\x22>'+(bi?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22languageText\x22\x20class\x20=\x20\x22textButton\x22>'+aL[bj]['language']['filling']+'</span><span\x20id\x20=\x20\x22language\x22\x20class\x20=\x20\x22textButton\x22>'+bj+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22infoText\x22\x20style\x20=\x20\x22color:grey;\x20font-size:11px;\x22>'+aL[bj]['info']['filling']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22update\x22\x20style\x20=\x20\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20New\x20update\x20available!\x20Please\x20follow\x20this\x20<a\x20href=\x22https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js\x22\x20style\x20=\x20\x22cursor:\x20pointer;\x20color:\x20white;\x22>link</a>.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';document['body']['appendChild'](bp);window['addEventListener']('unload',function(){return localStorage['zoomlevel']=aQ;});aO&&(at('detector')['style']['cursor']='not-allowed',at('detectorText')['style']['cursor']='not-allowed');window['addEventListener']('keydown',function(bT){switch(bT['keyCode']){case 0x1b:at('settingsDiv')['style']['display']='none';break;case 0x60:case 0x30:'true'==localStorage['debug']?(aR=!0x1,console['log']('Debug\x20is\x20off')):(aR=!0x0,console['log']('Debug\x20is\x20enabled'));localStorage['debug']=aR;break;case 0x61:case 0x31:ar('factions');break;case 0x62:case 0x32:at('settingsButton')['click']();break;case 0x63:case 0x33:at('sectors')['click']();break;case 0x64:case 0x34:at('detector')['click']();}});at('cursorColorText')['onclick']=at('cursorColor')['onclick']=function(){bb=aE['indexOf'](bb)+0x1==aE['length']?aE[0x0]:aE[aE['indexOf'](bb)+0x1];localStorage['cursorColor']=at('cursorColor')['innerText']=at('cursorColor')['style']['color']=bb;ak();};at('gridText')['onclick']=at('grid')['onclick']=function(){bv['clearRect'](0x0,0x0,bs['width'],bs['height']);localStorage['grid']=bc=!bc;at('grid')['innerText']=bc?'On':'Off';ak();};at('mapStyleText')['onclick']=at('mapStyle')['onclick']=function(){aF='Old'==aF?'New':'Old';localStorage['mapStyle']=aF;at('minimap-box')['style']['width']=aI[aF]+'px';at('minimap-box')['style']['height']=aJ[aF]+'px';for(var bU=0x0;bU<at('minimap-box')['childNodes']['length'];bU++){var b2=at('minimap-box')['childNodes'][bU];b2['width']=b2['offsetWidth'];b2['height']=b2['offsetHeight'];}bt['mozImageSmoothingEnabled']=bu['mozImageSmoothingEnabled']=!0x1;bt['webkitImageSmoothingEnabled']=bu['webkitImageSmoothingEnabled']=!0x1;bt['msImageSmoothingEnabled']=bu['msImageSmoothingEnabled']=!0x1;bt['imageSmoothingEnabled']=bu['imageSmoothingEnabled']=!0x1;bh||bi?ay(aP):ay();at('settingsDiv')['style']='width:\x20'+at('settingsDiv')['style']['width']+';\x20height:\x20auto;\x20display:\x20'+at('settingsDiv')['style']['display']+';\x20position:\x20absolute;\x20left:\x20'+at('settingsDiv')['style']['left']+';\x20top:\x20'+at('settingsDiv')['style']['top']+';\x20'+aG[aF];at('minimapbg')['style']=aH[aF];at('mapStyle')['innerText']=aF;ak();bl();};at('sectorsText')['onclick']=at('sectors')['onclick']=function(){bd=!bd;V();bd?bl():bu['clearRect'](0x0,0x0,br['width'],br['height']);at('sectors')['innerText']=bd?'On':'Off';localStorage['sectors']=bd;};at('settingsDivCancel')['onclick']=function(){return ar('settingsDiv');};at('sectorShiftText')['onclick']=at('sectorShift')['onclick']=function(){bf=(be=!be)?0.8:0x1;at('sectorShift')['innerText']=be?'On':'Off';localStorage['sectorShift']=be;bl();};at('translucentText')['onclick']=at('translucent')['onclick']=function(){bg=!bg;at('translucent')['innerText']=bg?'On':'Off';at('minimapSectors')['style']['opacity']=aK[bg];localStorage['translucent']=bg;bl();};at('detectorText')['onclick']=at('detector')['onclick']=function(){aO||((bh=!bh)?(at('zoom-minus')['style']['cursor']=at('zoom-plus')['style']['cursor']='not-allowed',by['override']()):at('zoom-minus')['style']['cursor']=at('zoom-plus')['style']['cursor']='pointer',at('detector')['innerText']=bh?'On':'Off',localStorage['detector']=bh,ay(aP),V(),o(),ak());};at('languageText')['onclick']=at('language')['onclick']=function(){var bW=Object['keys'](aL),b2=bW['indexOf'](bj);++b2>=bW['length']&&(b2=0x0);localStorage['language']=at('language')['innerText']=bj=bW[b2];bW=Object['keys'](aL[bj]);at('settingsDiv')['style']['width']=aL[bj]['width'];bW['forEach'](function(b2){at(b2+'Text')&&('title'!=b2?at(b2+'Text')['innerText']=aL[bj][b2]['filling']:at('titleText')['innerText']=aL[bj]['title']['filling']);});};at('syncText')['onclick']=at('sync')['onclick']=function(){(bi=!bi)?ay(aP):ay();localStorage['sync']=bi;at('sync')['innerText']=bi?'On':'Off';V();o();ak();};},0x4b0);
