// ==UserScript==
// @name         MLP Pixel Minimap
// @version      2.6.8.4
// @description  My Little Pony Pixel (MLP Pixel) Minimap for PixelZone.io
// @author       Endless Night
// @include      *://pixelzone.io/*
// @homepage     https://github.com/EndlessNightNLR
// @updateURL    https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// @downloadURL  https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// ==/UserScript==
//
// To the glory of Luna and the New Lunar Republic!
//
var $jscomp=$jscomp||{};$jscomp['scope']={};$jscomp['arrayIteratorImpl']=function(c){var d=0x0;return function(){return d<c['length']?{'done':!0x1,'value':c[d++]}:{'done':!0x0};};};$jscomp['arrayIterator']=function(e){return{'next':$jscomp['arrayIteratorImpl'](e)};};$jscomp['makeIterator']=function(f){var g='undefined'!=typeof Symbol&&Symbol['iterator']&&f[Symbol['iterator']];return g?g['call'](f):$jscomp['arrayIterator'](f);};setTimeout(function(){function h(){aS&&au('Updating\x20Template\x20List');var i=new XMLHttpRequest();i['onloadend']=function(){if(0xc8==this['status']){b3=JSON['parse'](this['responseText']);b4={};b5={};ba={};for(var i in b3)b3[i]['x']*=0x1,b3[i]['y']*=0x1,'grid'===b3[i]['type']?b5[i]=b3[i]:b4[i]=b3[i];var k=$jscomp['makeIterator'](bb['templates']);for(i=k['next']();!i['done'];i=k['next']())q(i['value'],function(){return aS&&console['log']('Img\x20updated');});k=$jscomp['makeIterator'](bb['grids']);for(i=k['next']();!i['done'];i=k['next']())q(i['value'],function(){return aS&&console['log']('Grid\x20updated');});aS&&console['log']('Update\x20completed',b3,b4,b5);}else console['error']('Error\x20:\x20'+aX[aY]['data']+'\x20'+this['status']);};i['open']('GET',aX[aY]['data'],!0x0);i['send']();}function l(){b8&&!bi&&(bj&&(localStorage['sync']=bj=!0x1,aR=aQ,as('sync')['innerText']=bj?'On':'Off',U()),aR*=1.1,0x20<aR?aR=0x20:(bi?bz['override']():bj?aA(aQ):aA(),aj(),bm(),setTimeout(l,0x32)));}function m(){b9&&!bi&&(bj&&(localStorage['sync']=bj=!0x1,aR=aQ,as('sync')['innerText']=bj?'On':'Off',U()),aR/=1.1,0x1>aR?aR=0x1:(bi?bz['override']():bj?aA(aQ):aA(),aj(),n(),setTimeout(m,0x32)));}function n(){if(b6&&b4){bb['grids']=[];bb['templates']=[];for(var o in b4)b1['between'](b4[o]['x']-aN,b4[o]['x']+b4[o]['width']+aN)&&b2['between'](b4[o]['y']-aO,b4[o]['y']+b4[o]['height']+aO)&&(ba[o]?bb['templates'][bb['templates']['length']]=o:(q(o),delete b4[o]));if(be)for(var p in b5)b1['between'](b5[p]['x']-aN,b5[p]['x']+b5[p]['width']+aN)&&b2['between'](b5[p]['y']-aO,b5[p]['y']+b5[p]['height']+aO)&&(ba[p]?bb['grids'][bb['grids']['length']]=p:(q(p),delete b5[p]));0x0===bb['grids']['length']&&0x0===bb['templates']['length']?!b7||b8||b9||(b7=!0x1,as('minimap-box')['style']['display']='none',as('minimap-text')['style']['display']='block',as('minimap-text')['innerText']='There\x27s\x20nothing\x20here'):(b7||(b7=!0x0,as('minimap-box')['style']['display']='block',as('minimap-text')['style']['display']='none'),bn&&(bn=!0x1,window['requestAnimationFrame'](function(){bm();bn=!0x0;})));}}function q(r,s){aS&&au('Load\x20'+(b5[r]?'grid':'image')+'\x20:\x20'+r);var t=new Image(),u=0x0;t['crossOrigin']='';t['src']=''+aX[aY]['images']+r+'.png';t['onerror']=function(){'grid'===b3[r]['type']?delete b5[r]:delete b4[r];delete b3[r];delete ba[r];};t['onload']=function(){var v=document['createElement']('canvas'),w=v['getContext']('2d');v['width']=t['width'];v['height']=t['height'];w['drawImage'](t,0x0,0x0,t['width'],t['height']);var x=t['width'],y=t['height'];w=w['getImageData'](0x0,0x0,x,y)['data'];if(!(0x180>=x&&0x180>=y)){for(var z=performance['now'](),A=0x0;0x80<y-A;A+=0x100)for(var B=0x0;0x80<x-B;B+=0x100){for(var C=r+'_#_'+B/0x100+'_'+A/0x100,D=0x100<=x-B?0x100:x-B,E=0x100<=y-A?0x100:y-A,F=D<<0x2,G=F*E,H=new Uint8ClampedArray(G),I=0x0,J=0x0,K=null,L=0x0,M=0x0,N=x<<0x2,O=x*A+B<<0x2,P=0x0,Q,R;M!==E;M+=0x1)for(Q=O+M*N,R=P+F;P!==R;)H[P]=w[Q],P+=0x1,Q+=0x1;for(M=0x3;M<G;M+=0x4)if(0x0!==H[M]){K=~~((M+0x1)/F);break;}if(null!==K){--G;for(M=K*F;G>M;G-=0x4)if(0x0!==H[G]){L=(G+0x1)/F;L=E-(~~L===L?L:~~L+0x1);break;}G=0x3;M=K*F;N=(D-L)*F;S:for(;G<F;G+=0x4)for(O=G+M;O<N;O+=F)if(0x0!==H[O]){I=G>>>0x2;break S;}G=F-0x1;M=K*F;N=(D-L)*F;O=I<<0x2;T:for(;G>O;G-=0x4)for(P=G+M;P<N;P+=F)if(0x0!==H[P]){J=D-(G+0x1>>>0x2);break T;}b3[C]={'x':b3[r]['x']+B,'y':b3[r]['y']+A};ba[C]=document['createElement']('canvas');0x0!==K||0x0!==L||0x0!==I||0x0!==J?(b3[C]['width']=ba[C]['width']=D-I-J,b3[C]['height']=ba[C]['height']=E-K-L,ba[C]['getContext']('2d')['drawImage'](v,B+I,A+K,ba[C]['width'],ba[C]['height'],0x0,0x0,ba[C]['width'],ba[C]['height']),b3[C]['x']+=I,b3[C]['y']+=K):(b3[C]['width']=ba[C]['width']=D,b3[C]['height']=ba[C]['height']=E,ba[C]['getContext']('2d')['drawImage'](v,B,A,ba[C]['width'],ba[C]['height'],0x0,0x0,ba[C]['width'],ba[C]['height']));'grid'===b3[r]['type']?b5[C]=b3[C]:b4[C]=b3[C];u+=0x1;}}z=performance['now']()-z;delete b3[r];delete ba[r];aS&&console['log'](b3,'\x0aName\x20:\x20'+r+'\x0aChunks\x20:\x20'+u+'\x0aTime\x20:\x20'+z);s&&s();n();}};}function U(){bm=bi?be?function(){a5();Z(aQ);}:a5:bj?be?function(){V(aQ);Z(aQ);}:function(){return V(aQ);}:be?function(){V();Z();}:V;}function V(W){W=void 0x0===W?aR:W;bu['clearRect'](0x0,0x0,br['width'],br['height']);for(var X=$jscomp['makeIterator'](bb['templates']),Y=X['next']();!Y['done'];Y=X['next']())Y=Y['value'],bu['drawImage'](ba[Y],~~((b4[Y]['x']-aT)*W),~~((b4[Y]['y']-aU)*W),~~(ba[Y]['width']*W),~~(ba[Y]['height']*W));}function Z(a0){a0=void 0x0===a0?aR:a0;bv['clearRect'](0x0,0x0,bs['width'],bs['height']);var a1=a0*bg;if(bi){a0=(bz['xLeft']-b1)/bg+b1;var a2=(bz['yTop']-b2)/bg+b2;}else a0=(aT-b1)/bg+b1,a2=(aU-b2)/bg+b2;for(var a3=$jscomp['makeIterator'](bb['grids']),a4=a3['next']();!a4['done'];a4=a3['next']())a4=a4['value'],bv['drawImage'](ba[a4],~~((b5[a4]['x']-a0)*a1),~~((b5[a4]['y']-a2)*a1),~~(ba[a4]['width']*a1),~~(ba[a4]['height']*a1));}function a5(a6){a6=void 0x0===a6?aQ:a6;bu['clearRect'](0x0,0x0,br['width'],br['height']);for(var a7=document['createElement']('canvas'),a8=a7['getContext']('2d'),a9,aa=0x0,ab=a6*a6;0x1<ab;ab>>>=0x1)aa++;a9=aa>>>0x1;a7['width']=bz['width'];a7['height']=bz['height'];ab=$jscomp['makeIterator'](bb['templates']);for(var ac=ab['next']();!ac['done'];ac=ab['next']())ac=ac['value'],a8['drawImage'](ba[ac],bz['xLeft']-b4[ac]['x']-0x1,bz['yTop']-b4[ac]['y']-0x1,bz['width'],bz['height'],0x0,0x0,bz['width'],bz['height']);ab=a8['getImageData'](0x0,0x0,a7['width'],a7['height']);ac=ab['data'];a9=aZ['getContext']('2d')['getImageData'](aV-(bz['width']<<a9>>>0x1),aW-(bz['height']<<a9>>>0x1),bz['width']*a6,bz['height']*a6)['data'];for(var ad=0x0,ae=0x0,af=bz['height']*bz['widthRGBA'],ag=aQ<<0x2;ad<af;ad+=bz['widthRGBA'],ae=ad<<aa)for(var ah=ad,ai=ad+(bz['width']<<0x2);ah<ai;ah+=0x4,ae+=ag)0x0!=a9[ae+0x3]&&(0x28>(ac[ah]>a9[ae]?ac[ah]-a9[ae]:a9[ae]-ac[ah])+(ac[ah+0x1]>a9[ae+0x1]?ac[ah+0x1]-a9[ae+0x1]:a9[ae+0x1]-ac[ah+0x1])+(ac[ah+0x2]>a9[ae+0x2]?ac[ah+0x2]-a9[ae+0x2]:a9[ae+0x2]-ac[ah+0x2])?ac[ah]=ac[ah+0x1]=ac[ah+0x2]=(ac[ah]+ac[ah+0x1]+ac[ah+0x2])/0x3:(ac[ah]=0xff,ac[ah+0x1]=0x0,ac[ah+0x2]=0x0));a8['putImageData'](ab,0x0,0x0);bu['drawImage'](a7,bz['borderW']-a6,bz['borderH']-a6,bz['width']*a6,bz['height']*a6);}function aj(ak){ak=void 0x0===ak?aR:ak;bw['clearRect'](0x0,0x0,bt['width'],bt['height']);if(bi||bj)ak=aQ;if(0x2<ak){if(bd&&4.6<ak){bw['beginPath']();for(var al=br['width']+ak,am=br['height']+ak,an=(br['width']>>>0x1)%ak-ak,ao=(br['height']>>>0x1)%ak-ak,ap=0x0;ap<=al;ap+=ak)bw['moveTo'](ap+an,ao),bw['lineTo'](ap+an,am+ao);for(ap=0x0;ap<=am;ap+=ak)bw['moveTo'](an,ap+ao),bw['lineTo'](al+an,ap+ao);bw['strokeStyle']='rgb(20,20,20)';bw['stroke']();}bw['beginPath']();bw['lineWidth']=ak/0x3;bw['strokeStyle']=bc;bw['rect'](br['width']>>>0x1,br['height']>>>0x1,ak,ak);bw['stroke']();}}function aq(ar){ar=document['getElementById'](ar);ar['style']['display']='none'==ar['style']['display']?'block':'none';}function as(as){return document['getElementById'](as);}function au(){for(var as=$jscomp['makeIterator'](arguments),aw=as['next']();!aw['done'];aw=as['next']())console['log'](aw['value']);}function ax(as){as=as||window['event'];if(as['wheelDelta']){var az=as['wheelDelta']/0x78;window['opera']&&(az=~az+0x1);}else as['detail']&&(az=-as['detail']/0x3);0x1==az?aQ<<=0x1:aQ>>>=0x1;0x40<aQ?aQ=0x40:0x1>aQ?aQ=0x1:bi?setTimeout(function(){aA(aQ);bz['override']();a5();be&&Z(aQ);aj();},0xc8):bj&&(aA(aQ),aj(),n());}function aA(as){as=void 0x0===as?aR:as;aT=b1-(br['width']>>>0x1)/as;aU=b2-(br['height']>>>0x1)/as;aN=(br['width']/as>>>0x1)+0x1;aO=(br['height']/as>>>0x1)+0x1;}(function G(){as('timer')?as('timer')['style']['z-index']=0x5:setTimeout(G,0x14d);}());(function k(){as('message')?as('message')['remove']():setTimeout(k,0x14d);}());var aC=document['createElement']('link');aC['rel']='stylesheet';aC['href']='https://endlessnightnlr.github.io/master/MLPP/style.css';document['head']['appendChild'](aC);aC=document['createElement']('div');aC['style']='position:\x20absolute;\x20left:\x200px;\x20top:\x2057px;\x20margin:\x20-2px\x200px\x200px\x20-2px;';aC['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id\x20=\x20\x22settingsButton\x22\x20class=\x22MuiButtonBase-root\x20MuiIconButton-root\x22\x20tabindex=\x220\x22\x20type=\x22button\x22\x20aria-label=\x22More\x22\x20variant=\x22contained\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiIconButton-label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tr-bg\x22\x20style=\x22width:\x2025px;\x20height:\x2025px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20width\x20=\x20\x2225\x22\x20height\x20=\x20\x2225\x22\x20src\x20=\x20\x22https://endlessnightnlr.github.io/master/MLPP/gear.png\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</img>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiTouchRipple-root\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';document['body']['appendChild'](aC);as('settingsButton')['onclick']=function(){aq('settingsDiv');'block'==as('settingsDiv')['style']['display']&&(as('settingsDiv')['style']['left']=(window['innerWidth']-as('settingsDiv')['offsetWidth']>>>0x1)+'px',as('settingsDiv')['style']['top']=(window['innerHeight']-as('settingsDiv')['offsetHeight']>>>0x1)+'px');};Number['prototype']['between']=function(as,aE){return this>as&&this<aE;};var aF='black\x20gray\x20white\x20Fuchsia\x20red\x20yellow\x20lime\x20springGreen\x20aqua\x20blue'['split']('\x20'),aG='New',aH={'Old':'background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x2021px;\x20padding:\x206px;','New':'background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x205px;'},aI={'Old':'position:\x20absolute;\x20right:\x200.5em;\x20bottom:\x204.75em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:10px;\x20padding:\x206px;','New':'position:\x20absolute;\x20right:\x200em;\x20top:\x200em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x201px;'},aJ={'Old':0x1a4,'New':0x118},aK={'Old':0x12c,'New':0xc8},aL={'false':0x1,'true':0.5},aM={'ru':{'width':'280px','title':{'filling':'MLP\x20Pixel\x20миникарта:\x20настройки'},'cursorColor':{'filling':'Цвет\x20курсора:\x20','true':'On','false':'Off'},'grid':{'filling':'Сетка:\x20','true':'On','false':'Off'},'mapStyle':{'filling':'Стиль\x20миникарты:\x20','New':'New','Old':'Old'},'sectors':{'filling':'Сектора:\x20','true':'On','false':'Off'},'sectorShift':{'filling':'Сдвиг\x20секторов:\x20','true':'On','false':'Off'},'translucent':{'filling':'Прозрачность\x20секторов:\x20','true':'On','false':'Off'},'detector':{'filling':'Детектор\x20ошибок:\x20','true':'On','false':'Off'},'language':{'filling':'Язык:\x20'},'sync':{'filling':'Синхронизация\x20зума:\x20'}},'en':{'width':'250px','title':{'filling':'MLP\x20Pixel\x20minimap:\x20settings'},'cursorColor':{'filling':'Cursor\x20color:\x20','true':'On','Off':'Off'},'grid':{'filling':'Grid:\x20','true':'On','Off':'Off'},'mapStyle':{'filling':'Minimap\x20style:\x20','New':'New','Old':'Old'},'sectors':{'filling':'Sectors:\x20','true':'On','false':'Off'},'sectorShift':{'filling':'Sectors\x20shift:\x20','true':'On','false':'Off'},'translucent':{'filling':'Translucent:\x20','true':'On','false':'Off'},'detector':{'filling':'Error\x20detector:\x20','true':'On','false':'Off'},'language':{'filling':'Language:\x20'},'sync':{'filling':'Zoom\x20sync:\x20'}}},aN=null,aO=null,aP=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i['test'](navigator['userAgent']),aQ=0x1,aR=0x5,aS=!0x1,aT=void 0x0,aU=void 0x0,aV=void 0x0,aW=void 0x0,aX={'New Lunar Republic':{'data':'https://endlessnightnlr.github.io/master/templates/New\x20Lunar\x20Republic.json','images':'https://endlessnightnlr.github.io/master/images/','color':'aqua','type':0x2}},aY='New\x20Lunar\x20Republic',aZ=as('canvas'),b0=as('coordinatesNote'),b1=0x0,b2=0x0,b3,b4,b5,b6=!0x0,b7=!0x0,b8=!0x1,b9=!0x1,ba=[],bb={'grids':[],'templates':[]},bc='springGreen',bd=!0x1,be=!0x1,bf=!0x1,bg=0x1,bh=!0x1,bi=!0x1,bj=!0x1,bk=(window['navigator']['language']||window['navigator']['systemLanguage']||window['navigator']['userLanguage'])['substr'](0x0,0x2)['toLowerCase'](),bl=new RegExp(/-?\d+/g),bm,bn=!0x0;aQ=window['location']['href']['match'](bl)&&0x3==window['location']['href']['match'](bl)['length']?+window['location']['href']['match'](bl)[0x2]:0x1;aZ['addEventListener']?aZ['addEventListener']('mousewheel',ax,!0x1):aZ['attachEvent']&&aZ['attachEvent']('onmousewheel',ax);if(/Firefox/i['test'](navigator['userAgent']))try{window['addEventListener']('DOMMouseScroll',function(as){0x3==as['wheelDelta']?aQ<<=0x1:aQ>>>=0x1;0x40<aQ?aQ=0x40:0x1>aQ?aQ=0x1:bj&&!bi?(aA(aQ),aj(),n()):bi&&(aA(aQ),setTimeout(function(){bz['override']();a5();},0xc8),aj(),be&&Z());});}catch(bp){}localStorage['cursorColor']?bc=localStorage['cursorColor']:localStorage['cursorColor']=bc;aS='true'==localStorage['debug'];bd='true'==localStorage['grid'];'Old'==localStorage['mapStyle']&&(aG='Old');be='true'==localStorage['sectors'];'true'==localStorage['sectorShift']&&(bf=!0x0,bg=0.8);bh='true'==localStorage['translucent'];localStorage['mobile']&&(aP=localStorage['mobile']);'true'==localStorage['detector']&&(bi=aP?localStorage['detector']=!0x1:!0x0);bj='true'==localStorage['sync'];localStorage['zoomlevel']&&(aR=+localStorage['zoomlevel']);localStorage['language']&&(bk=localStorage['language']);U();au('MLPP\x20MINIMAP\x20VERSION\x20:\x202.6.8.4');for(var bq in aX);bq=document['createElement']('div');bq['id']='minimapbg';bq['style']=aI[aG];bq['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-text\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-box\x22\x20style=\x22display:block;position:relative;width:'+aJ[aG]+'px;height:'+aK[aG]+'px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:1;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapSectors\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:2;position:absolute;top:0;left:0;opacity:'+aL[bh]+';\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapCover\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:3;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-config\x22\x20style=\x22line-height:15px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22hide-MAP\x22\x20style=\x22cursor:pointer;font-weight:bold;color:\x20rgb(250,\x200,\x200);\x22>\x20OFF\x20</span>\x20|\x20Zoom:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-plus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x20100,\x20250);\x22>+</span>\x20\x20/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-minus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x2050,\x20250);\x22>-</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22factions\x22\x20style\x20=\x20\x22display:none\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20id=\x22listF\x22\x20style=\x22line-height:20px;text-align:left;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';document['body']['appendChild'](bq);var br=as('minimap'),bs=as('minimapSectors'),bt=as('minimapCover');for(bq=0x0;bq<as('minimap-box')['childNodes']['length'];bq++)aC=as('minimap-box')['childNodes'][bq],aC['width']=aC['offsetWidth'],aC['height']=aC['offsetHeight'];var bu=br['getContext']('2d'),bv=bs['getContext']('2d'),bw=bt['getContext']('2d');bu['mozImageSmoothingEnabled']=bv['mozImageSmoothingEnabled']=!0x1;bu['webkitImageSmoothingEnabled']=bv['webkitImageSmoothingEnabled']=!0x1;bu['msImageSmoothingEnabled']=bv['msImageSmoothingEnabled']=!0x1;bu['imageSmoothingEnabled']=bv['imageSmoothingEnabled']=!0x1;setTimeout(function(){for(var as=0x0,by=0x0;as<document['getElementsByTagName']('canvas')['length'];as++)if('minimap'==document['getElementsByTagName']('canvas')[as]['id']&&by++,0x1<by){alert('Включено\x20два\x20или\x20более\x20скриптов\x20с\x20миникартой.\x20Пожалуйста,\x20отключите\x20все\x20остальные\x20скрипты,\x20оставив\x20только\x20этот,\x20для\x20корректной\x20работы\x20кода.\x0a\x0dTwo\x20or\x20more\x20minimap\x20scripts\x20included.\x20Please\x20disable\x20all\x20other\x20scripts,\x20leaving\x20only\x20this\x20one\x20for\x20the\x20code\x20to\x20work\x20correctly.');break;}},0x7d0);var bz={'override':function(){this['width']=br['width']/aQ&0x7fe;this['height']=br['height']/aQ&0x7fe;this['borderW']=br['width']-this['width']*aQ>>>0x1;this['borderH']=br['height']-this['height']*aQ>>>0x1;this['xLeft']=b1-(this['width']>>>0x1);this['yTop']=b2-(this['height']>>>0x1);this['width']+=0x2;this['widthRGBA']=this['width']<<0x2;this['height']+=0x2;}};bq=new XMLHttpRequest();bq['onloadend']=function(){if(0xc8==this['status']){try{var bA=document['createElement']('script');bA['src']='https://endlessnightnlr.github.io/master/test.js';document['head']['appendChild'](bA);}catch(bB){}aX=JSON['parse'](this['responseText']);aS&&au(this['responseText']);aY=aX[localStorage['faction']]&&localStorage['faction']||Object['keys'](aX)[0x0];h();bA='';for(var bC in aX)bA+='<li\x20id=\x22'+bC+'\x22><span\x20Style=\x22cursor:pointer;\x20font-weight:\x20normal;\x20color:\x20'+aX[bC]['color']+'\x22>'+bC+'<span></li>';as('listF')['innerHTML']=bA;for(var aA in aX)as(aA)['onclick']=function(){aq('factions');as(aY)['childNodes'][0x0]['style']['fontWeight']='normal';this['childNodes'][0x0]['style']['fontWeight']='bold';aY=this['id'];localStorage['faction']=this['id'];h();};as(aY)['childNodes'][0x0]['style']['font-weight']='bold';}else console['error']('Error\x20:\x20https://endlessnightnlr.github.io/master/MLPP/factions_MLPP.json\x20'+this['status']);};bq['open']('GET','https://endlessnightnlr.github.io/master/MLPP/factions_MLPP.json',!0x0);bq['send']();aj();as('hide-MAP')['onclick']=function(){b6=!0x1;as('minimap-box')['style']['display']='none';as('minimap-config')['style']['display']='none';as('minimap-text')['style']['display']='block';as('minimap-text')['innerText']='Minimap';as('minimap-text')['style']['cursor']='pointer';};as('minimap-text')['onclick']=function(){b6=!0x0;as('minimap-box')['style']['display']='block';as('minimap-config')['style']['display']='block';as('minimap-text')['style']['display']='none';as('minimap-text')['style']['cursor']='default';n();};as('zoom-plus')['addEventListener']('mousedown',function(as){as['preventDefault']();b8=!0x0;b9=!0x1;l();},!0x1);as('zoom-plus')['addEventListener']('mouseup',function(){return b8=!0x1;},!0x1);as('zoom-minus')['addEventListener']('mousedown',function(as){as['preventDefault']();b9=!0x0;b8=!0x1;m();},!0x1);as('zoom-minus')['addEventListener']('mouseup',function(){return b9=!0x1;},!0x1);if(aP){document['body']['insertAdjacentHTML']('afterbegin','<style>#minimap-config{font-size:\x2025px;}</style>');as('minimap-config')['style']['line-height']='27px';var bG=document['createElement']('div'),bH=document['createElement']('canvas');bH['width']=0x15;bH['height']=bH['width'];bH['getContext']('2d')['strokeStyle']='white';bG['style']='position:\x20absolute;\x20top:\x20'+(window['innerHeight']+bH['height'])/0x2+'px;\x20left:\x20'+(window['innerWidth']+bH['width'])/0x2+'px;';bG['appendChild'](bH);document['body']['appendChild'](bG);var bI=bH['getContext']('2d');aZ['getContext']('2d')['getImageData'](+bG['style']['left']['replace']('px','')[0x0],+bG['style']['top']['replace']('px','')[0x0],bH['width'],bH['height']);bq=bI['getImageData'](0x0,0x0,bH['width'],bH['height']);aC=bq['data'];for(var bJ=0x0;bJ<bH['height'];bJ++)aC[(bH['width']*(0.5+bJ)<<0x2)+0x3]=0xff;for(bJ=0x0;bJ<bH['width'];bJ++)aC[(bH['width']*((bH['height']>>0x1)-0x1)+bJ<<0x2)+0x3]=0xff;bI['putImageData'](bq,0x0,0x0);bH['update']=function(){for(var as=aZ['getContext']('2d')['getImageData'](+bG['style']['left']['replace']('px','')[0x0],+bG['style']['top']['replace']('px','')[0x0],bH['width'],bH['height'])['data'],bL=bI['getImageData'](0x0,0x0,this['width'],this['height']),aA=bL['data'],aQ=0x0;aQ<this['height'];aQ++){var bO=this['width']*(0.5+aQ)<<0x2;0x80===as[bO]&&0x80===as[bO+0x1]&&0x80===as[bO+0x2]?(aA[bO]=0x0,aA[bO+0x1]=0xe6,aA[bO+0x2]=0xe6):(aA[bO]=0xff^as[bO],aA[bO+0x1]=0xff^as[bO+0x1],aA[bO+0x2]=0xff^as[bO+0x2]);}for(aQ=0x0;aQ<this['width'];aQ++)bO=this['width']*((this['height']>>>0x1)-0x1)+aQ<<0x2,0x80===as[bO]&&0x80===as[bO+0x1]&&0x80===as[bO+0x2]?(aA[bO]=0x0,aA[bO+0x1]=0xe6,aA[bO+0x2]=0xe6):(aA[bO]=0xff^as[bO],aA[bO+0x1]=0xff^as[bO+0x1],aA[bO+0x2]=0xff^as[bO+0x2]);bI['putImageData'](bL,0x0,0x0);};aZ['addEventListener']('touchmove',function(){bH['update']();},!0x1);setInterval(function(){if(b6){var as=0x0,bQ=0x0;window['location']['search']&&(bQ=window['location']['search']['match'](bl),as=+bQ[0x0],bQ=+bQ[0x1]);if(b1!=as||b2!=bQ)b1=as,b2=bQ,bi?(aA(aQ),aV=e['clientX'],aW=e['clientY'],bz['override']()):bj?aA(aQ):aA(),n();}},0x96);}else window['addEventListener']('mousemove',function(as){var bS=b0['innerText']['match'](bl),bT=+bS[0x0];bS=+bS[0x1];if(b1!=bT||b2!=bS)b1=bT,b2=bS,aV=as['clientX'],aW=as['clientY'],b6&&(bi?(aA(aQ),bz['override'](),0x1==aQ?n():setTimeout(n,0x64)):(bj?aA(aQ):aA(),n()));},!0x1);bq=document['createElement']('div');bq['class']='post\x20block\x20bc2';bq['id']='settingsDiv';bq['style']='width:\x20'+aM[bk]['width']+';\x20height:\x20auto;\x20display:\x20none;\x20z-index:\x205;\x20position:\x20absolute;\x20'+aH[aG];bq['innerHTML']='<a\x20id\x20=\x20\x22titleText\x22\x20style\x20=\x20\x22position:\x20absolute;line-height:\x2035px;\x20left:\x205px;\x22>'+aM[bk]['title']['filling']+'</a><a\x20id\x20=\x20\x22settingsDivCancel\x22\x20style\x20=\x20\x22position:\x20absolute;\x20right:\x205px;\x20top:\x20-2px;\x20cursor:\x20pointer;\x22>[X]</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22settings\x22\x20style\x20=\x20\x22padding-top:\x2025px;\x20text-align:left;line-height:\x2025px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22cursorColorText\x22\x20class\x20=\x20\x22textButton\x22>'+aM[bk]['cursorColor']['filling']+'</span><span\x20id\x20=\x20\x22cursorColor\x22\x20class\x20=\x20\x22textButton\x22\x20style\x20=\x20\x22color:'+bc+'\x22>'+bc+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22gridText\x22\x20class\x20=\x20\x22textButton\x22>'+aM[bk]['grid']['filling']+'</span><span\x20id\x20=\x20\x22grid\x22\x20class\x20=\x20\x22textButton\x22>'+(bd?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22mapStyleText\x22\x20class\x20=\x20\x22textButton\x22>'+aM[bk]['mapStyle']['filling']+'</span><span\x20id\x20=\x20\x22mapStyle\x22\x20class\x20=\x20\x22textButton\x22>'+aG+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+aM[bk]['sectors']['filling']+'</span><span\x20id\x20=\x20\x22sectors\x22\x20class\x20=\x20\x22textButton\x22>'+(be?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorShiftText\x22\x20class\x20=\x20\x22textButton\x22>'+aM[bk]['sectorShift']['filling']+'</span><span\x20id\x20=\x20\x22sectorShift\x22\x20class\x20=\x20\x22textButton\x22>'+(bf?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22translucentText\x22\x20class\x20=\x20\x22textButton\x22>'+aM[bk]['translucent']['filling']+'</span><span\x20id\x20=\x20\x22translucent\x22\x20class\x20=\x20\x22textButton\x22>'+(bh?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22detectorText\x22\x20class\x20=\x20\x22textButton\x22>'+aM[bk]['detector']['filling']+'</span><span\x20id\x20=\x20\x22detector\x22\x20class\x20=\x20\x22textButton\x22>'+(bi?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22syncText\x22\x20class\x20=\x20\x22textButton\x22>'+aM[bk]['sync']['filling']+'</span><span\x20id\x20=\x20\x22sync\x22\x20class\x20=\x20\x22textButton\x22>'+(bj?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22languageText\x22\x20class\x20=\x20\x22textButton\x22>'+aM[bk]['language']['filling']+'</span><span\x20id\x20=\x20\x22language\x22\x20class\x20=\x20\x22textButton\x22>'+bk+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22update\x22\x20style\x20=\x20\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20New\x20update\x20available!\x20Please\x20follow\x20this\x20<a\x20href=\x22https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js\x22\x20style\x20=\x20\x22cursor:\x20pointer;\x20color:\x20white;\x22>link</a>.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';document['body']['appendChild'](bq);window['addEventListener']('unload',function(){return localStorage['zoomlevel']=aR;});aP&&(as('detector')['style']['cursor']='not-allowed',as('detectorText')['style']['cursor']='not-allowed');window['onkeydown']=function(aA){switch(aA['keyCode']){case 0x1b:as('settingsDiv')['style']['display']='none';break;case 0x30:'true'==localStorage['debug']?(aS=!0x1,au('Debug\x20is\x20off')):(aS=!0x0,au('Debug\x20is\x20enabled'));localStorage['debug']=aS;break;case 0x31:aq('factions');break;case 0x32:as('settingsButton')['click']();break;case 0x33:as('sectors')['click']();break;case 0x34:as('detector')['click']();}};as('cursorColorText')['onclick']=as('cursorColor')['onclick']=function(){bc=aF['indexOf'](bc)+0x1==aF['length']?aF[0x0]:aF[aF['indexOf'](bc)+0x1];localStorage['cursorColor']=as('cursorColor')['innerText']=as('cursorColor')['style']['color']=bc;aj();};as('gridText')['onclick']=as('grid')['onclick']=function(){bw['clearRect'](0x0,0x0,bt['width'],bt['height']);localStorage['grid']=bd=!bd;as('grid')['innerText']=bd?'On':'Off';aj();};as('mapStyleText')['onclick']=as('mapStyle')['onclick']=function(){aG='Old'==aG?'New':'Old';localStorage['mapStyle']=aG;as('minimap-box')['style']['width']=aJ[aG]+'px';as('minimap-box')['style']['height']=aK[aG]+'px';for(var bV=0x0;bV<as('minimap-box')['childNodes']['length'];bV++){var bW=as('minimap-box')['childNodes'][bV];bW['width']=bW['offsetWidth'];bW['height']=bW['offsetHeight'];}bu['mozImageSmoothingEnabled']=bv['mozImageSmoothingEnabled']=!0x1;bu['webkitImageSmoothingEnabled']=bv['webkitImageSmoothingEnabled']=!0x1;bu['msImageSmoothingEnabled']=bv['msImageSmoothingEnabled']=!0x1;bu['imageSmoothingEnabled']=bv['imageSmoothingEnabled']=!0x1;bi||bj?aA(aQ):aA();as('settingsDiv')['style']='width:\x20'+as('settingsDiv')['style']['width']+';\x20height:\x20auto;\x20display:\x20'+as('settingsDiv')['style']['display']+';\x20position:\x20absolute;\x20left:\x20'+as('settingsDiv')['style']['left']+';\x20top:\x20'+as('settingsDiv')['style']['top']+';\x20'+aH[aG];as('minimapbg')['style']=aI[aG];as('mapStyle')['innerText']=aG;aj();bm();};as('sectorsText')['onclick']=as('sectors')['onclick']=function(){be=!be;U();be?bm():bv['clearRect'](0x0,0x0,bs['width'],bs['height']);as('sectors')['innerText']=be?'On':'Off';localStorage['sectors']=be;};as('settingsDivCancel')['onclick']=function(){return aq('settingsDiv');};as('sectorShiftText')['onclick']=as('sectorShift')['onclick']=function(){bg=(bf=!bf)?0.8:0x1;as('sectorShift')['innerText']=bf?'On':'Off';localStorage['sectorShift']=bf;bm();};as('translucentText')['onclick']=as('translucent')['onclick']=function(){bh=!bh;as('translucent')['innerText']=bh?'On':'Off';as('minimapSectors')['style']['opacity']=aL[bh];localStorage['translucent']=bh;bm();};as('detectorText')['onclick']=as('detector')['onclick']=function(){aP||((bi=!bi)?(as('zoom-minus')['style']['cursor']=as('zoom-plus')['style']['cursor']='not-allowed',bz['override']()):as('zoom-minus')['style']['cursor']=as('zoom-plus')['style']['cursor']='pointer',as('detector')['innerText']=bi?'On':'Off',localStorage['detector']=bi,aA(aQ),U(),n(),aj());};as('languageText')['onclick']=as('language')['onclick']=function(){var aA=Object['keys'](aM),bY=aA['indexOf'](bk);++bY>=aA['length']&&(bY=0x0);localStorage['language']=as('language')['innerText']=bk=aA[bY];aA=Object['keys'](aM[bk]);as('settingsDiv')['style']['width']=aM[bk]['width'];aA['forEach'](function(aA){as(aA+'Text')&&('title'!=aA?as(aA+'Text')['innerText']=aM[bk][aA]['filling']:as('titleText')['innerText']=aM[bk]['title']['filling']);});};as('syncText')['onclick']=as('sync')['onclick']=function(){(bj=!bj)?aA(aQ):aA();localStorage['sync']=bj;as('sync')['innerText']=bj?'On':'Off';U();n();aj();};},0x4b0);
//Hi PowerGab
