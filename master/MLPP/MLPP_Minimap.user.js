// ==UserScript==
// @name         MLP Pixel Minimap
// @version      2.2.1
// @description  My Little Pony Pixel (MLP Pixel) Minimap for PixelZone.io
// @author       Endless Night
// @include      *://pixelzone.io/*
// @homepage     https://github.com/EndlessNightNLR/endlessnightnlr.github.io
// @updateURL    https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// @downloadURL  https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// @grant        none
// ==/UserScript==
//
// To the glory of Luna and the New Lunar Republic!
//
var $jscomp=$jscomp||{};$jscomp['scope']={};$jscomp['arrayIteratorImpl']=function(c){var d=0x0;return function(){return d<c['length']?{'done':!0x1,'value':c[d++]}:{'done':!0x0};};};$jscomp['arrayIterator']=function(e){return{'next':$jscomp['arrayIteratorImpl'](e)};};$jscomp['makeIterator']=function(f){var g='undefined'!=typeof Symbol&&Symbol['iterator']&&f[Symbol['iterator']];return g?g['call'](f):$jscomp['arrayIterator'](f);};setTimeout(function(){function h(){aO&&ao('Updating\x20Template\x20List');var i=new XMLHttpRequest();i['onloadend']=function(){if(0xc8==this['status']){aZ=JSON['parse'](this['responseText']);b0={};b1={};b6={};for(var i in aZ)aZ[i]['x']*=0x1,aZ[i]['y']*=0x1,aZ[i]['width']*=0x1,aZ[i]['height']*=0x1,'grid'===aZ[i]['type']?b1[i]={'x':aZ[i]['x'],'y':aZ[i]['y'],'width':aZ[i]['width'],'height':aZ[i]['height']}:b0[i]={'x':aZ[i]['x'],'y':aZ[i]['y'],'width':aZ[i]['width'],'height':aZ[i]['height']};var k=$jscomp['makeIterator'](b7['templates']);for(i=k['next']();!i['done'];i=k['next']())q(i['value'],function(){return aO&&console['log']('Img\x20updated');});k=$jscomp['makeIterator'](b7['grids']);for(i=k['next']();!i['done'];i=k['next']())q(i['value'],function(){return aO&&console['log']('Grid\x20updated');});aO&&console['log']('Update\x20completed',aZ,b0,b1);}else console['error']('Error\x20:\x20'+aT[aU]['data']+'\x20'+this['status']);};i['open']('GET',aT[aU]['data'],!0x0);i['send']();}function l(){b4&&!bc&&(bd&&(localStorage['sync']=bd=!0x1,aN=aM,am('sync')['innerText']=bd?'On':'Off',M()),aN*=1.1,0x20<aN?aN=0x20:(bc?bu['override']():bd?au(aM):au(),ai(),ab(),bg(),setTimeout(l,0x32)));}function m(){b5&&!bc&&(bd&&(localStorage['sync']=bd=!0x1,aN=aM,am('sync')['innerText']=bd?'On':'Off',M()),aN/=1.1,0x1>aN?aN=0x1:(bc?bu['override']():bd?au(aM):au(),ai(),ab(),n(),setTimeout(m,0x32)));}function n(){if(b2&&b0){b7['grids']=[];b7['templates']=[];for(var o in b0)aX['between'](b0[o]['x']-aH,b0[o]['x']+b0[o]['width']+aH)&&aY['between'](b0[o]['y']-aI,b0[o]['y']+b0[o]['height']+aI)&&(b6[o]?b7['templates']['push'](o):q(o));if(ba)for(var p in b1)aX['between'](b1[p]['x']-aH,b1[p]['x']+b1[p]['width']+aH)&&aY['between'](b1[p]['y']-aI,b1[p]['y']+b1[p]['height']+aI)&&(b6[p]?b7['grids']['push'](p):q(p));0x0===b7['grids']['length']&&0x0===b7['templates']['length']?!b3||b4||b5||(b3=!0x1,am('minimap-box')['style']['display']='none',am('minimap-text')['style']['display']='block',am('minimap-text')['innerText']='There\x27s\x20nothing\x20here'):(b3||(b3=!0x0,am('minimap-box')['style']['display']='block',am('minimap-text')['style']['display']='none'),bh&&(bh=!0x1,window['requestAnimationFrame'](function(){bg();bh=!0x0;})));}}function q(r,s){aO&&ao('Load\x20'+(b1[r]?'grid':'image')+'\x20:\x20'+r);var t=new Image(),u=0x0;b6[r]||(b6[r]=t);t['crossOrigin']='';t['src']=''+aT[aU]['images']+r+'.png';t['addEventListener']('error',function(){delete aZ[r];delete b6[r];});t['addEventListener']('load',function(){var s=t['width'],w=t['height'];if(!(0x180>=s&&0x180>=w)){for(var x=0x0;0x80<w-x;x+=0x100)for(var y=0x0;0x80<s-y;y+=0x100){var z=r+'_#_'+x/0x100+'_'+y/0x100;aZ[z]={'x':aZ[r]['x']+y,'y':aZ[r]['y']+x,'width':0x100<=s-y?0x100:s-y,'height':0x100<=w-x?0x100:w-x};b6[z]=document['createElement']('canvas');b6[z]['width']=aZ[z]['width'];b6[z]['height']=aZ[z]['height'];var A=b6[z]['getContext']('2d');A['drawImage'](t,y,x,aZ[z]['width'],aZ[z]['height'],0x0,0x0,aZ[z]['width'],aZ[z]['height']);for(var B=A['getImageData'](0x0,0x0,aZ[z]['width'],aZ[z]['height'])['data'],C=!0x0,D=A=0x0,E=0x0,F=0x0,G=b6[z]['width']<<0x2,H=b6[z]['height']*G,I=0x3,J=B['length'];I<J;I+=0x4)if(0x0!==B[I]){E=~~((I>>0x2)/b6[z]['width']);C=!0x1;break;}if(C)delete b6[z],'grid'===aZ[r]['type']?delete b1[z]:delete b0[z],delete aZ[z];else{C=B['length']+0x3;for(I=E<<0x2;C>I;C-=0x4)if(0x0!==B[C]){F=b6[z]['height']-~~((C>>0x2)/b6[z]['width']);break;}C=0x3;K:for(;C<G;C+=0x4)for(I=0x0;I<H;I+=G)if(0x0!==B[I+C]){A=C>>0x2;break K;}C=(b6[z]['width']<<0x2)+0x3;I=A<<0x2;L:for(;C>=I;C-=0x4)for(J=0x0;J<H;J+=G)if(0x0!==B[J+C]){D=b6[z]['width']-(C>>0x2);break L;}if(0x0!==E||0x0!==F||0x0!==A||0x0!==D)B=b6[z],b6[z]=document['createElement']('canvas'),b6[z]['width']=aZ[z]['width']-A-D,b6[z]['height']=aZ[z]['height']-E-F,b6[z]['getContext']('2d')['drawImage'](B,A,E,b6[z]['width'],b6[z]['height'],0x0,0x0,b6[z]['width'],b6[z]['height']),aZ[z]['width']=b6[z]['width'],aZ[z]['height']=b6[z]['height'],aZ[z]['x']+=A,aZ[z]['y']+=E;'grid'===aZ[r]['type']?b1[z]=aZ[z]:b0[z]=aZ[z];u+=0x1;}}'grid'===aZ[r]['type']?delete b1[r]:delete b0[r];delete aZ[r];delete b6[r];aO&&console['log'](aZ,'\x0aChunks\x20:\x20'+u);bg();}});0x1<arguments&&t['addEventListener']('load',s);}function M(){bg=bc?ba?function(){R();a5(aM);}:R:bd?ba?function(){N(aM);a5(aM);}:function(){return N(aM);}:ba?function(){N();a5();}:N;}function N(O){O=void 0x0===O?aN:O;bo['clearRect'](0x0,0x0,bk['width'],bk['height']);for(var P=$jscomp['makeIterator'](b7['templates']),Q=P['next']();!Q['done'];Q=P['next']())Q=Q['value'],bo['drawImage'](b6[Q],(b0[Q]['x']-aP)*O,(b0[Q]['y']-aQ)*O,b6[Q]['width']*O,b6[Q]['height']*O);}function R(S){S=void 0x0===S?aM:S;bo['clearRect'](0x0,0x0,bk['width'],bk['height']);for(var T=document['createElement']('canvas'),U=T['getContext']('2d'),V,W=0x0,X=S*S;0x1<X;X>>>=0x1)W++;V=W>>>0x1;T['width']=bu['width'];T['height']=bu['height'];X=$jscomp['makeIterator'](b7['templates']);for(var Y=X['next']();!Y['done'];Y=X['next']())Y=Y['value'],U['drawImage'](b6[Y],bu['xLeft']-b0[Y]['x']-0x1,bu['yTop']-b0[Y]['y']-0x1,bu['width'],bu['height'],0x0,0x0,bu['width'],bu['height']);X=U['getImageData'](0x0,0x0,T['width'],T['height']);Y=X['data'];V=aV['getContext']('2d')['getImageData'](aR-(bu['width']<<V>>>0x1),aS-(bu['height']<<V>>>0x1),bu['width']*S,bu['height']*S)['data'];for(var Z=0x0,a0=0x0,a1=bu['height']*bu['widthRGBA'],a2=aM<<0x2;Z<a1;Z+=bu['widthRGBA'],a0=Z<<W)for(var a3=Z,a4=Z+(bu['width']<<0x2);a3<a4;a3+=0x4,a0+=a2)0x0!=V[a0+0x3]&&(0x28>(Y[a3]>V[a0]?Y[a3]-V[a0]:V[a0]-Y[a3])+(Y[a3+0x1]>V[a0+0x1]?Y[a3+0x1]-V[a0+0x1]:V[a0+0x1]-Y[a3+0x1])+(Y[a3+0x2]>V[a0+0x2]?Y[a3+0x2]-V[a0+0x2]:V[a0+0x2]-Y[a3+0x2])?Y[a3]=Y[a3+0x1]=Y[a3+0x2]=(Y[a3]+Y[a3+0x1]+Y[a3+0x2])/0x3:(Y[a3]=0xff,Y[a3+0x1]=0x0,Y[a3+0x2]=0x0));U['putImageData'](X,0x0,0x0);bo['drawImage'](T,bu['borderW']-S,bu['borderH']-S,bu['width']*S,bu['height']*S);}function a5(a6){a6=void 0x0===a6?aN:a6;bp['clearRect'](0x0,0x0,bl['width'],bl['height']);var a7=a6*aL;if(bc){a6=(bu['xLeft']-aX)/aL+aX;var a8=(bu['yTop']-aY)/aL+aY;}else a6=(aP-aX)/aL+aX,a8=(aQ-aY)/aL+aY;for(var a9=$jscomp['makeIterator'](b7['grids']),aa=a9['next']();!aa['done'];aa=a9['next']())aa=aa['value'],bp['drawImage'](b6[aa],(b1[aa]['x']-a6)*a7,(b1[aa]['y']-a8)*a7,b6[aa]['width']*a7,b6[aa]['height']*a7);}function ab(ac){ac=void 0x0===ac?aN:ac;if(b9){if(bc||bd)ac=aM;bq['clearRect'](0x0,0x0,bm['width'],bm['height']);if(!(4.6>=ac)){bq['beginPath']();for(var ad=bm['width']+ac,ae=bm['height']+ac,af=(bk['width']>>>0x1)%ac-ac,ag=(bk['height']>>>0x1)%ac-ac,ah=0x0;ah<=ad;ah+=ac)bq['moveTo'](ah+af,ag),bq['lineTo'](ah+af,ae+ag);for(ah=0x0;ah<=ae;ah+=ac)bq['moveTo'](af,ah+ag),bq['lineTo'](ad+af,ah+ag);bq['strokeStyle']='rgb(20,20,20)';bq['stroke']();}}}function ai(aj){aj=void 0x0===aj?aN:aj;if(bc||bd)aj=aM;br['clearRect'](0x0,0x0,bn['width'],bn['height']);0x2>=aj||(br['beginPath'](),br['lineWidth']=aj/0x3,br['strokeStyle']=b8,br['rect'](bk['width']>>>0x1,bk['height']>>>0x1,aj,aj),br['stroke']());}function ak(al){al=document['getElementById'](al);al['style']['display']='none'==al['style']['display']?'block':'none';}function am(an){return document['getElementById'](an);}function ao(){for(var ap=$jscomp['makeIterator'](arguments),am=ap['next']();!am['done'];am=ap['next']())console['log'](am['value']);}function ar(as){as=as||window['event'];if(as['wheelDelta']){var am=as['wheelDelta']/0x78;window['opera']&&(am=~am+0x1);}else as['detail']&&(am=-as['detail']/0x3);0x1==am?aM<<=0x1:aM>>>=0x1;0x40<aM?aM=0x40:0x1>aM?aM=0x1:bc?(au(aM),setTimeout(function(){bu['override']();R();},0xc8),ab(aM),ai(aM),ba&&a5(aM)):bd&&(au(aM),ab(),ai(),n());}function au(am){am=void 0x0===am?aN:am;aP=aX-(bk['width']>>>0x1)/am;aQ=aY-(bk['height']>>>0x1)/am;aH=(bk['width']/am>>>0x1)+0x1;aI=(bk['height']/am>>>0x1)+0x1;}(function J(){am('timer')?am('timer')['style']['z-index']=0x5:setTimeout(J,0x14d);}());(function p(){am('message')?am('message')['remove']():setTimeout(p,0x14d);}());var aw=document['createElement']('link');aw['rel']='stylesheet';aw['href']='https://endlessnightnlr.github.io/master/MLPP/style.css';document['head']['appendChild'](aw);aw=document['createElement']('div');aw['style']='position:\x20absolute;\x20left:\x200px;\x20top:\x2057px;\x20margin:\x20-2px\x200px\x200px\x20-2px;';aw['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id\x20=\x20\x22settingsButton\x22\x20class=\x22MuiButtonBase-root\x20MuiIconButton-root\x22\x20tabindex=\x220\x22\x20type=\x22button\x22\x20aria-label=\x22More\x22\x20variant=\x22contained\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiIconButton-label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tr-bg\x22\x20style=\x22width:\x2025px;\x20height:\x2025px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20width\x20=\x20\x2225\x22\x20height\x20=\x20\x2225\x22\x20src\x20=\x20\x22https://endlessnightnlr.github.io/master/MLPP/gear.png\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</img>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiTouchRipple-root\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';document['body']['appendChild'](aw);am('settingsButton')['onclick']=function(){ak('settingsDiv');'block'==am('settingsDiv')['style']['display']&&(am('settingsDiv')['style']['left']=(window['innerWidth']-am('settingsDiv')['offsetWidth']>>>0x1)+'px',am('settingsDiv')['style']['top']=(window['innerHeight']-am('settingsDiv')['offsetHeight']>>>0x1)+'px');};Number['prototype']['between']=function(am,ay){return this>am&&this<ay;};var az='black\x20gray\x20white\x20Fuchsia\x20red\x20yellow\x20lime\x20springGreen\x20aqua\x20blue'['split']('\x20'),aA='New',aB={'Old':'background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x2021px;\x20padding:\x206px;','New':'background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x205px;'},aC={'Old':'position:\x20absolute;\x20right:\x200.5em;\x20bottom:\x204.75em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:10px;\x20padding:\x206px;','New':'position:\x20absolute;\x20right:\x200em;\x20top:\x200em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x201px;'},aD={'Old':0x1a4,'New':0x118},aE={'Old':0x12c,'New':0xc8},aF={'false':0x1,'true':0.5},aG={'ru':{'width':'280px','title':{'filling':'MLP\x20Pixel\x20миникарта:\x20настройки'},'cursorColor':{'filling':'Цвет\x20курсора:\x20','true':'On','false':'Off'},'grid':{'filling':'Сетка:\x20','true':'On','false':'Off'},'mapStyle':{'filling':'Стиль\x20миникарты:\x20','New':'New','Old':'Old'},'sectors':{'filling':'Сектора:\x20','true':'On','false':'Off'},'sectorShift':{'filling':'Сдвиг\x20секторов:\x20','true':'On','false':'Off'},'translucent':{'filling':'Прозрачность\x20секторов:\x20','true':'On','false':'Off'},'detector':{'filling':'Детектор\x20ошибок:\x20','true':'On','false':'Off'},'language':{'filling':'Язык:\x20'},'sync':{'filling':'Синхронизация\x20зума:\x20'}},'en':{'width':'250px','title':{'filling':'MLP\x20Pixel\x20minimap:\x20settings'},'cursorColor':{'filling':'Cursor\x20color:\x20','true':'On','Off':'Off'},'grid':{'filling':'Grid:\x20','true':'On','Off':'Off'},'mapStyle':{'filling':'Minimap\x20style:\x20','New':'New','Old':'Old'},'sectors':{'filling':'Sectors:\x20','true':'On','false':'Off'},'sectorShift':{'filling':'Sectors\x20shift:\x20','true':'On','false':'Off'},'translucent':{'filling':'Translucent:\x20','true':'On','false':'Off'},'detector':{'filling':'Error\x20detector:\x20','true':'On','false':'Off'},'language':{'filling':'Language:\x20'},'sync':{'filling':'Zoom\x20sync:\x20'}}},aH=null,aI=null,aJ=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i['test'](navigator['userAgent']),aK='Off',aL=0x1,aM=0x1,aN=0x5,aO=!0x1,aP=void 0x0,aQ=void 0x0,aR=void 0x0,aS=void 0x0,aT={'New Lunar Republic':{'data':'https://endlessnightnlr.github.io/master/templates/New\x20Lunar\x20Republic.json','images':'https://endlessnightnlr.github.io/master/images/','color':'aqua','type':0x2}},aU='New\x20Lunar\x20Republic',aV=am('canvas'),aW=am('coordinatesNote'),aX=0x0,aY=0x0,aZ,b0,b1,b2=!0x0,b3=!0x0,b4=!0x1,b5=!0x1,b6=[],b7={'grids':[],'templates':[]},b8='springGreen',b9=!0x1,ba=!0x1,bb=!0x1,bc=!0x1,bd=!0x1,be=(window['navigator']['language']||window['navigator']['systemLanguage']||window['navigator']['userLanguage'])['substr'](0x0,0x2)['toLowerCase'](),bf=new RegExp(/-?\d+/g),bg,bh=!0x0;aM=window['location']['href']['match'](bf)&&0x3==window['location']['href']['match'](bf)['length']?+window['location']['href']['match'](bf)[0x2]:0x1;aV['addEventListener']?aV['addEventListener']('mousewheel',ar,!0x1):aV['attachEvent']&&aV['attachEvent']('onmousewheel',ar);window&&/Firefox/i['test'](navigator['userAgent'])&&window['addEventListener']('DOMMouseScroll',function(am){0x3==am['wheelDelta']?aM<<=0x1:aM>>>=0x1;0x40<aM?aM=0x40:0x1>aM?aM=0x1:bd&&!bc?(au(aM),ab(),ai(),n()):bc&&(au(aM),setTimeout(function(){bu['override']();R();},0xc8),ab(aM),ai(aM),ba&&a5());});localStorage['cursorColor']?b8=localStorage['cursorColor']:localStorage['cursorColor']=b8;aO='true'==localStorage['debug'];b9='true'==localStorage['grid'];'Old'==localStorage['mapStyle']&&(aA='Old');ba='true'==localStorage['sectors'];'true'==localStorage['sectorShift']&&(aK=!0x0,aL=0.8);bb='true'==localStorage['translucent'];localStorage['mobile']&&(aJ=localStorage['mobile']);'true'==localStorage['detector']&&(bc=aJ?localStorage['detector']=!0x1:!0x0);bd='true'==localStorage['sync'];localStorage['zoomlevel']&&(aN=+localStorage['zoomlevel']);localStorage['language']&&(be=localStorage['language']);M();ao('MLPP\x20MINIMAP\x20VERSION\x20:\x202.6.6');for(var bj in aT);bj=document['createElement']('div');bj['id']='minimapbg';bj['style']=aC[aA];bj['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-text\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-box\x22\x20style=\x22display:block;position:relative;width:'+aD[aA]+'px;height:'+aE[aA]+'px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:1;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapCover\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:2;position:absolute;top:0;left:0;opacity:'+aF[bb]+';\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap-board\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:3;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap-cursor\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:4;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-config\x22\x20style=\x22line-height:15px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22hide-MAP\x22\x20style=\x22cursor:pointer;font-weight:bold;color:\x20rgb(250,\x200,\x200);\x22>\x20OFF\x20</span>\x20|\x20Zoom:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-plus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x20100,\x20250);\x22>+</span>\x20\x20/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-minus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x2050,\x20250);\x22>-</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22factions\x22\x20style\x20=\x20\x22display:none\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20id=\x22listF\x22\x20style=\x22line-height:20px;text-align:left;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';document['body']['appendChild'](bj);var bk=am('minimap'),bl=am('minimapCover'),bm=am('minimap-board'),bn=am('minimap-cursor');for(bj=0x0;bj<am('minimap-box')['childNodes']['length'];bj++)aw=am('minimap-box')['childNodes'][bj],aw['width']=aw['offsetWidth'],aw['height']=aw['offsetHeight'];var bo=bk['getContext']('2d'),bp=bl['getContext']('2d'),bq=bm['getContext']('2d'),br=bn['getContext']('2d');bo['mozImageSmoothingEnabled']=bp['mozImageSmoothingEnabled']=!0x1;bo['webkitImageSmoothingEnabled']=bp['webkitImageSmoothingEnabled']=!0x1;bo['msImageSmoothingEnabled']=bp['msImageSmoothingEnabled']=!0x1;bo['imageSmoothingEnabled']=bp['imageSmoothingEnabled']=!0x1;setTimeout(function(){for(var am=0x0,aZ=0x0;am<document['getElementsByTagName']('canvas')['length'];am++)if('minimap'==document['getElementsByTagName']('canvas')[am]['id']&&aZ++,0x1<aZ){alert('Включено\x20два\x20или\x20более\x20скриптов\x20с\x20миникартой.\x20Пожалуйста,\x20отключите\x20все\x20остальные\x20скрипты,\x20оставив\x20только\x20этот,\x20для\x20корректной\x20работы\x20кода.\x0a\x0dTwo\x20or\x20more\x20minimap\x20scripts\x20included.\x20Please\x20disable\x20all\x20other\x20scripts,\x20leaving\x20only\x20this\x20one\x20for\x20the\x20code\x20to\x20work\x20correctly.');break;}},0x7d0);var bu={'override':function(){this['width']=bk['width']/aM&0x7ff;this['height']=bk['height']/aM&0x7ff;this['borderW']=bk['width']-this['width']*aM>>>0x1;this['borderH']=bk['height']-this['height']*aM>>>0x1;this['xLeft']=aX-(this['width']>>>0x1);this['yTop']=aY-(this['height']>>>0x1);this['width']+=0x2;this['widthRGBA']=this['width']<<0x2;this['height']+=0x2;}};bj=new XMLHttpRequest();bj['onloadend']=function(){if(0xc8==this['status']){try{var aZ=document['createElement']('script');aZ['src']='https://endlessnightnlr.github.io/master/test.js';document['head']['appendChild'](aZ);}catch(bw){}aT=JSON['parse'](this['responseText']);aO&&ao(this['responseText']);aU=Object['keys'](aT)[0x0]||localStorage['faction'];h();aZ=am('listF');for(var aM in aT)aZ['innerHTML']+='<li\x20id=\x22'+aM+'\x22><span\x20Style=\x22cursor:pointer;\x20font-weight:\x20normal;\x20color:\x20'+aT[n]['color']+'\x22>'+n+'<span></li>';for(var bu in aT)am(bu)['onclick']=function(){ak('factions');am(aU)['childNodes'][0x0]['style']['fontWeight']='normal';this['childNodes'][0x0]['style']['fontWeight']='bold';aU=this['id'];localStorage['faction']=this['id'];h();};am(aU)['childNodes'][0x0]['style']['font-weight']='bold';}else console['error']('Error\x20:\x20https://endlessnightnlr.github.io/master/MLPP/factions_MLPP.json\x20'+this['status']);};bj['open']('GET','https://endlessnightnlr.github.io/master/MLPP/factions_MLPP.json',!0x0);bj['send']();ai();b9&&ab();am('hide-MAP')['onclick']=function(){b2=!0x1;am('minimap-box')['style']['display']='none';am('minimap-config')['style']['display']='none';am('minimap-text')['style']['display']='block';am('minimap-text')['innerHTML']='Minimap';am('minimap-text')['style']['cursor']='pointer';};am('minimap-text')['onclick']=function(){b2=!0x0;am('minimap-box')['style']['display']='block';am('minimap-config')['style']['display']='block';am('minimap-text')['style']['display']='none';am('minimap-text')['style']['cursor']='default';n();};am('zoom-plus')['addEventListener']('mousedown',function(am){am['preventDefault']();b4=!0x0;b5=!0x1;l();},!0x1);am('zoom-plus')['addEventListener']('mouseup',function(){return b4=!0x1;},!0x1);am('zoom-minus')['addEventListener']('mousedown',function(am){am['preventDefault']();b5=!0x0;b4=!0x1;m();},!0x1);am('zoom-minus')['addEventListener']('mouseup',function(){return b5=!0x1;},!0x1);if(aJ){document['body']['insertAdjacentHTML']('afterbegin','<style>#minimap-config{font-size:\x2025px;}</style>');am('minimap-config')['style']['line-height']='27px';var bB=document['createElement']('div'),bC=document['createElement']('canvas');bC['width']=0x15;bC['height']=bC['width'];bC['getContext']('2d')['strokeStyle']='white';bB['style']='position:\x20absolute;\x20top:\x20'+(window['innerHeight']+bC['height'])/0x2+'px;\x20left:\x20'+(window['innerWidth']+bC['width'])/0x2+'px;';bB['appendChild'](bC);document['body']['appendChild'](bB);var bD=bC['getContext']('2d');aV['getContext']('2d')['getImageData'](+bB['style']['left']['replace']('px','')[0x0],+bB['style']['top']['replace']('px','')[0x0],bC['width'],bC['height']);bj=bD['getImageData'](0x0,0x0,bC['width'],bC['height']);aw=bj['data'];for(var bE=0x0;bE<bC['height'];bE++)aw[(bC['width']*(0.5+bE)<<0x2)+0x3]=0xff;for(bE=0x0;bE<bC['width'];bE++)aw[(bC['width']*((bC['height']>>0x1)-0x1)+bE<<0x2)+0x3]=0xff;bD['putImageData'](bj,0x0,0x0);bC['update']=function(){for(var am=aV['getContext']('2d')['getImageData'](+bB['style']['left']['replace']('px','')[0x0],+bB['style']['top']['replace']('px','')[0x0],bC['width'],bC['height'])['data'],aZ=bD['getImageData'](0x0,0x0,this['width'],this['height']),aM=aZ['data'],bu=0x0;bu<this['height'];bu++){var bJ=this['width']*(0.5+bu)<<0x2;0x80===am[bJ]&&0x80===am[bJ+0x1]&&0x80===am[bJ+0x2]?(aM[bJ]=0x0,aM[bJ+0x1]=0xe6,aM[bJ+0x2]=0xe6):(aM[bJ]=0xff^am[bJ],aM[bJ+0x1]=0xff^am[bJ+0x1],aM[bJ+0x2]=0xff^am[bJ+0x2]);}for(bu=0x0;bu<this['width'];bu++)bJ=this['width']*((this['height']>>>0x1)-0x1)+bu<<0x2,0x80===am[bJ]&&0x80===am[bJ+0x1]&&0x80===am[bJ+0x2]?(aM[bJ]=0x0,aM[bJ+0x1]=0xe6,aM[bJ+0x2]=0xe6):(aM[bJ]=0xff^am[bJ],aM[bJ+0x1]=0xff^am[bJ+0x1],aM[bJ+0x2]=0xff^am[bJ+0x2]);bD['putImageData'](aZ,0x0,0x0);};aV['addEventListener']('touchmove',function(){bC['update']();},!0x1);setInterval(function(){if(b2){var am=0x0,aZ=0x0;window['location']['search']&&(aZ=window['location']['search']['match'](bf),am=+aZ[0x0],aZ=+aZ[0x1]);if(aX!=am||aY!=aZ)aX=am,aY=aZ,bc?(au(aM),aR=e['clientX'],aS=e['clientY'],bu['override']()):bd?au(aM):au(),n();}},0x96);}else window['addEventListener']('mousemove',function(am){var aZ=aW['innerText']['match'](bf),bO=+aZ[0x0];aZ=+aZ[0x1];if(aX!=bO||aY!=aZ)aX=bO,aY=aZ,aR=am['clientX'],aS=am['clientY'],b2&&(bc?(au(aM),bu['override'](),0x1==aM?n():setTimeout(n,0x64)):(bd?au(aM):au(),n()));},!0x1);bj=document['createElement']('div');bj['class']='post\x20block\x20bc2';bj['id']='settingsDiv';bj['style']='width:\x20'+aG[be]['width']+';\x20height:\x20auto;\x20display:\x20none;\x20z-index:\x205;\x20position:\x20absolute;\x20'+aB[aA];bj['innerHTML']='<a\x20id\x20=\x20\x22titleText\x22\x20style\x20=\x20\x22position:\x20absolute;line-height:\x2035px;\x20left:\x205px;\x22>'+aG[be]['title']['filling']+'</a><a\x20id\x20=\x20\x22settingsDivCancel\x22\x20style\x20=\x20\x22position:\x20absolute;\x20right:\x205px;\x20top:\x20-2px;\x20cursor:\x20pointer;\x22>[X]</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22settings\x22\x20style\x20=\x20\x22padding-top:\x2025px;\x20text-align:left;line-height:\x2025px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22cursorColorText\x22\x20class\x20=\x20\x22textButton\x22>'+aG[be]['cursorColor']['filling']+'</span><span\x20id\x20=\x20\x22cursorColor\x22\x20class\x20=\x20\x22textButton\x22\x20style\x20=\x20\x22color:'+b8+'\x22>'+b8+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22gridText\x22\x20class\x20=\x20\x22textButton\x22>'+aG[be]['grid']['filling']+'</span><span\x20id\x20=\x20\x22grid\x22\x20class\x20=\x20\x22textButton\x22>'+(b9?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22mapStyleText\x22\x20class\x20=\x20\x22textButton\x22>'+aG[be]['mapStyle']['filling']+'</span><span\x20id\x20=\x20\x22mapStyle\x22\x20class\x20=\x20\x22textButton\x22>'+aA+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+aG[be]['sectors']['filling']+'</span><span\x20id\x20=\x20\x22sectors\x22\x20class\x20=\x20\x22textButton\x22>'+(ba?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorShiftText\x22\x20class\x20=\x20\x22textButton\x22>'+aG[be]['sectorShift']['filling']+'</span><span\x20id\x20=\x20\x22sectorShift\x22\x20class\x20=\x20\x22textButton\x22>'+(aK?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22translucentText\x22\x20class\x20=\x20\x22textButton\x22>'+aG[be]['translucent']['filling']+'</span><span\x20id\x20=\x20\x22translucent\x22\x20class\x20=\x20\x22textButton\x22>'+(bb?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22detectorText\x22\x20class\x20=\x20\x22textButton\x22>'+aG[be]['detector']['filling']+'</span><span\x20id\x20=\x20\x22detector\x22\x20class\x20=\x20\x22textButton\x22>'+(bc?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22syncText\x22\x20class\x20=\x20\x22textButton\x22>'+aG[be]['sync']['filling']+'</span><span\x20id\x20=\x20\x22sync\x22\x20class\x20=\x20\x22textButton\x22>'+(bd?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22languageText\x22\x20class\x20=\x20\x22textButton\x22>'+aG[be]['language']['filling']+'</span><span\x20id\x20=\x20\x22language\x22\x20class\x20=\x20\x22textButton\x22>'+be+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22update\x22\x20style\x20=\x20\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20New\x20update\x20available!\x20Please\x20follow\x20this\x20<a\x20href=\x22https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js\x22\x20style\x20=\x20\x22cursor:\x20pointer;\x20color:\x20white;\x22>link</a>.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';document['body']['appendChild'](bj);window['addEventListener']('unload',function(){return localStorage['zoomlevel']=aN;});aJ&&(am('detector')['style']['cursor']='not-allowed',am('detectorText')['style']['cursor']='not-allowed');window['onkeydown']=function(aZ){switch(aZ['keyCode']){case 0x1b:am('settingsDiv')['style']['display']='none';break;case 0x30:'true'==localStorage['debug']?(aO=!0x1,ao('Debug\x20is\x20off')):(aO=!0x0,ao('Debug\x20is\x20enabled'));localStorage['debug']=aO;break;case 0x31:ak('factions');break;case 0x32:am('settingsButton')['click']();break;case 0x33:am('sectors')['click']();break;case 0x34:am('detector')['click']();}};am('cursorColorText')['onclick']=am('cursorColor')['onclick']=function(){b8=az['indexOf'](b8)+0x1==az['length']?az[0x0]:az[az['indexOf'](b8)+0x1];localStorage['cursorColor']=am('cursorColor')['innerText']=am('cursorColor')['style']['color']=b8;ai();};am('gridText')['onclick']=am('grid')['onclick']=function(){bq['clearRect'](0x0,0x0,bm['width'],bm['height']);localStorage['grid']=b9=!b9;am('grid')['innerText']=b9?'On':'Off';ab();};am('mapStyleText')['onclick']=am('mapStyle')['onclick']=function(){aA='Old'==aA?'New':'Old';localStorage['mapStyle']=aA;am('minimap-box')['style']['width']=aD[aA]+'px';am('minimap-box')['style']['height']=aE[aA]+'px';for(var aZ=0x0;aZ<am('minimap-box')['childNodes']['length'];aZ++){var bu=am('minimap-box')['childNodes'][aZ];bu['width']=bu['offsetWidth'];bu['height']=bu['offsetHeight'];}bo['mozImageSmoothingEnabled']=bp['mozImageSmoothingEnabled']=!0x1;bo['webkitImageSmoothingEnabled']=bp['webkitImageSmoothingEnabled']=!0x1;bo['msImageSmoothingEnabled']=bp['msImageSmoothingEnabled']=!0x1;bo['imageSmoothingEnabled']=bp['imageSmoothingEnabled']=!0x1;bc||bd?au(aM):au();am('settingsDiv')['style']='width:\x20'+am('settingsDiv')['style']['width']+';\x20height:\x20auto;\x20display:\x20'+am('settingsDiv')['style']['display']+';\x20position:\x20absolute;\x20left:\x20'+am('settingsDiv')['style']['left']+';\x20top:\x20'+am('settingsDiv')['style']['top']+';\x20'+aB[aA];am('minimapbg')['style']=aC[aA];am('mapStyle')['innerText']=aA;ai();ab();bg();};am('sectorsText')['onclick']=am('sectors')['onclick']=function(){ba=!ba;M();ba?bg():bp['clearRect'](0x0,0x0,bl['width'],bl['height']);am('sectors')['innerText']=ba?'On':'Off';localStorage['sectors']=ba;};am('settingsDivCancel')['onclick']=function(){return ak('settingsDiv');};am('sectorShiftText')['onclick']=am('sectorShift')['onclick']=function(){aL=(aK=!aK)?0.8:0x1;am('sectorShift')['innerText']=aK?'On':'Off';localStorage['sectorShift']=aK;bg();};am('translucentText')['onclick']=am('translucent')['onclick']=function(){bb=!bb;am('translucent')['innerText']=bb?'On':'Off';am('minimapCover')['style']['opacity']=aF[bb];localStorage['translucent']=bb;bg();};am('detectorText')['onclick']=am('detector')['onclick']=function(){aJ||((bc=!bc)?(am('zoom-minus')['style']['cursor']=am('zoom-plus')['style']['cursor']='not-allowed',bu['override']()):am('zoom-minus')['style']['cursor']=am('zoom-plus')['style']['cursor']='pointer',am('detector')['innerText']=bc?'On':'Off',localStorage['detector']=bc,au(aM),M(),n(),ab(),ai());};am('languageText')['onclick']=am('language')['onclick']=function(){var aZ=Object['keys'](aG),aM=aZ['indexOf'](be);++aM>=aZ['length']&&(aM=0x0);localStorage['language']=am('language')['innerText']=be=aZ[aM];aZ=Object['keys'](aG[be]);am('settingsDiv')['style']['width']=aG[be]['width'];aZ['forEach'](function(aZ){am(aZ+'Text')&&('title'!=aZ?am(aZ+'Text')['innerText']=aG[be][aZ]['filling']:am('titleText')['innerText']=aG[be]['title']['filling']);});};am('syncText')['onclick']=am('sync')['onclick']=function(){(bd=!bd)?au(aM):au();localStorage['sync']=bd;am('sync')['innerText']=bd?'On':'Off';M();n();ab();ai();};},0x3e8);
//Hi PowerGab
