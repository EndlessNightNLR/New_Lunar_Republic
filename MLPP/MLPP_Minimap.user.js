// ==UserScript==
// @name         MLP Pixel Minimap
// @version      2.6.9.7
// @description  My Little Pony Pixel (MLP Pixel) Minimap for PixelZone.io
// @author       Endless Night
// @include      *://pixelzone.io/*
// @homepage     https://github.com/EndlessNightNLR
// @updateURL    https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// @downloadURL  https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// ==/UserScript==
//
// To the glory of Luna and the New Lunar Republic!
function initNLRM(){'use strict';//PZ CHANGES
(function specialFirst(){let c=ed('timer');if(c)c['style']['z-index']=0x13;else setTimeout(specialFirst,0x14d);}());(function specialSecond(){let d=ed('message');if(d)d['remove']();else setTimeout(specialSecond,0x14d);}());let e=document['createElement']('link');e['rel']='stylesheet';e['href']='https://endlessnightnlr.github.io/MLPP/style.css';document['head']['appendChild'](e);let f=document['createElement']('div');f['style']='position:\x20absolute;\x20left:\x200px;\x20top:\x2057px;\x20margin:\x20-2px\x200px\x200px\x20-2px;';f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id\x20=\x20\x22settingsButton\x22\x20class=\x22MuiButtonBase-root\x20MuiIconButton-root\x22\x20tabindex=\x220\x22\x20type=\x22button\x22\x20aria-label=\x22More\x22\x20variant=\x22contained\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiIconButton-label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tr-bg\x22\x20style=\x22width:\x2025px;\x20height:\x2025px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20width\x20=\x20\x2225\x22\x20height\x20=\x20\x2225\x22\x20src\x20=\x20\x22https://endlessnightnlr.github.io/MLPP/gear.png\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</img>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiTouchRipple-root\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';document['body']['appendChild'](f);ed('settingsButton')['addEventListener']('click',()=>{let g=ed('settingsDiv');ea(g);if(g['style']['display']==='block'){g['style']['left']=(window['innerWidth']-g['offsetWidth']>>>0x1)+'px';g['style']['top']=(window['innerHeight']-g['offsetHeight']>>>0x1)+'px';};});Number['prototype']['between']=function(h,i){return this>h&&this<i;};window['testPerformance']=()=>{console['log']('Start\x20testing');let j=null,k=!![],l=N['width']>>>0x1,m=N['height']>>>0x1;setTimeout(()=>clearInterval(j),0x1770);j=setInterval(()=>{if(k)k=![],er('mousemove',l+ev(0x0,l>>>0x1),m+ev(0x0,m>>>0x1));else k=!![],er('mousemove',l-ev(0x0,l>>>0x1),m-ev(0x0,m>>>0x1));},0x32);};const n='2.6.9.7',o=0x20,p=['black','gray','white','Fuchsia','red','yellow','lime','springGreen','aqua','blue'],q={'init':function(){this['style']=this['style'];},get 'style'(){return this['_style'];},set 'style'(s){if(this['availableStyles']['includes'](s))this['_style']=s;else console['warn']('Style\x20is\x20missing'),this['_style']='New';let t='_'+this['_style'];for(let u of['width','height','settings','minimapbg'])this[u]=this[t][u];},'_style':'New','availableStyles':['New','Old'],'_New':{'width':0x118,'height':0xc8,'settings':'z-index:\x2020\x20;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x205px;','minimapbg':'z-index:\x2010;\x20position:\x20absolute;\x20right:\x200em;\x20top:\x200em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x201px;'},'_Old':{'width':0x1a4,'height':0x12c,'settings':'z-index:\x2020\x20;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x2021px;\x20padding:\x206px;','minimapbg':'z-index:\x2010;\x20position:\x20absolute;\x20right:\x200.5em;\x20bottom:\x204.75em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:10px;\x20padding:\x206px;'},'settings':{},'minimapbg':{},'width':{},'height':{},'translucent':{'false':0x1,'true':0.5}},r={'init':function(){this['language']=this['language'];},'availableLan':['ru','en'],get 'language'(){return this['_language'];},set 'language'(v){if(this['availableLan']['includes'](v))this['_language']=v;else console['warn']('Localization\x20for\x20this\x20language\x20does\x20not\x20exist'),this['_language']='en';let w='_'+this['_language'];this['width']=this[w]['width'];this['text']=this[w]['text'];},'_language':(window['navigator']['language']||window['navigator']['systemLanguage']||window['navigator']['userLanguage'])['substr'](0x0,0x2)['toLowerCase'](),'width':{},'text':{},'_ru':{'width':'280px','text':{'title':'MLP\x20Pixel\x20миникарта:\x20настройки','cursorColor':'Цвет\x20курсора:\x20','grid':'Сетка:\x20','mapStyle':'Стиль\x20миникарты:\x20','sectors':'Сектора:\x20','sectorShift':'Сдвиг\x20секторов:\x20','translucent':'Прозрачность\x20секторов:\x20','detector':'Детектор\x20ошибок:\x20','autoSelect':'Автовыбор\x20цвета:\x20','language':'Язык:\x20','sync':'Синхронизация\x20зума:\x20','info':'Создано\x20учеными\x20<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20для\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20|\x20V.\x20'+n,'pixels':'Поставленные\x20пиксели:\x20','pixelsDay':'Поставленные\x20за\x20день\x20пиксели:\x20','expSectors':'Эксп.\x20сис.\x20секторов:\x20'}},'_en':{'width':'250px','text':{'title':'MLP\x20Pixel\x20minimap:\x20settings','cursorColor':'Cursor\x20color:\x20','grid':'Grid:\x20','mapStyle':'Minimap\x20style:\x20','sectors':'Sectors:\x20','sectorShift':'Sectors\x20shift:\x20','translucent':'Translucent:\x20','detector':'Error\x20detector:\x20','autoSelect':'Color\x20auto\x20selection:\x20','language':'Language:\x20','sync':'Zoom\x20sync:\x20','info':'Created\x20by\x20<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20scientists\x20for\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20|\x20V.\x20'+n,'pixels':'Right\x20pixels:\x20','pixelsDay':'Right\x20pixels\x20for\x20day:\x20','expSectors':'Sector\x20exp.\x20sys.\x20:\x20'}}};q['init']();r['init']();let z=null,A=null,B=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i['test'](navigator['userAgent']),C=0x1,D=0x5,E=new RegExp(/-?\d+/g),F=ed('colorSampleSelector')['parentNode']['style']['backgroundColor']['match'](E),G=!!void'Child\x20of\x20starfall',H=void'Luna,\x20child\x20of\x20starfall',I=void'Sunder\x20the\x20daylight',J=void'Open\x20my\x20heart',K=void'Let\x20me\x20bleed\x20thin',L={'New Lunar Republic':{'data':'https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/templates/New\x20Lunar\x20Republic.json','images':'https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/images/','color':'aqua','type':0x2,'chunks':![]}},M='New\x20Lunar\x20Republic',N=ed('canvas'),O=N['getContext']('2d'),P=ed('coordinatesNote'),Q=document['getElementsByClassName']('palette-color-box'),R=[],S=ed('timer'),T=0x0,U=0x0,V,W,X,Y=!![],Z=!![],a0=![],a1=![],a2=0x32,a3=[],a4={'grids':[],'templates':[]},a5={'canvas':document['createElement']('canvas'),'ctx':void 0x0},a6={'getLine':function(T){let ao=0x190,ap=ey(T%ao);if(this['_data']['has'](ap))return this['_data']['get'](ap);let aq=ao/0x3,ar=aq<<0x1,as=[this['conv'](this['fromTo'](ap,0x0,aq),aq),this['conv'](this['fromTo'](ap,aq,ar),aq),this['conv'](this['fromTo'](ap,ar,ao),aq)];this['_data']['set'](ap,as);return as;},'_data':new Map(),'conv':(T,au)=>~~(((T<<0x8)-T)/au),'fromTo':(T,aw,ax)=>T>ax||T<aw?0x0:T-aw},a7={'stat':{'pixels':0x0,'pixelsDay':0x0,'lastDate':0x0}},a8='springGreen',a9=![],aa=![],ab=![],ac=0x1,ad=![],ae=![],af=![],ag=![],ah=![],ai=()=>{},aj=!![],ak=!![],al=null,am=0x32;for(let ay of Q)R['push'](ay['style']['backgroundColor']['match'](E)['map'](T=>+T));if(window['location']['search']&&window['location']['search']['match'](E)['length']==0x3)C=+window['location']['search']['match'](E)[0x2];else C=0x1;a5['ctx']=a5['canvas']['getContext']('2d');let aA={'lastZoom':C,'setZoom':function(aB){this['zoom']=C=aB;if(ag){ep(C);e0();c4();}else if(ae&&~~C===C){setTimeout(()=>{b2['updateD']();ep(C);dK();aa&&cX(C);e0();},0xc8);};},'smoothZoom':function(aC){this['smoothZoomFrom']=this['zoom'];this['smoothZoomTo']=aC;this['smoothZoomStartDate']=Date['now']();this['smoothZoomUpdate']();},'executeZoom':function(aD){this['setZoom'](aD>0x40?0x40:aD<0x1?0x1:aD);},'smoothZoomUpdate':function(){let aE=(Date['now']()-this['smoothZoomStartDate'])/0xc8;if(aE>0x1){this['executeZoom'](this['smoothZoomTo']);return;};window['requestAnimationFrame'](()=>this['smoothZoomUpdate']());this['executeZoom'](this['smoothZoomFrom']+(0x1-(0x1-(aE>0x1?0x1:aE<0x0?0x0:aE))**0x3)*(this['smoothZoomTo']-this['smoothZoomFrom']));}};aA['setZoom'](C);if(N['addEventListener'])N['addEventListener']('mousewheel',ef,![]);else if(N['attachEvent'])N['attachEvent']('onmousewheel',ef);if(!B&&/Firefox/i['test'](navigator['userAgent']))try{window['addEventListener']('DOMMouseScroll',aF=>{aF['wheelDelta']==0x3?C<<=0x1:C>>>=0x1;if(C>0x40)C=0x40;else if(C<0x1)C=0x1;else if(ag&&!ae){ep(C);e0();c4();}else if(ae){ep(C);b2['updateD']();setTimeout(()=>{dK();},0xc8);e0();if(aa)cX();};});}catch(aG){};if(localStorage['cursorColor']&&p['includes'](localStorage['cursorColor']))a8=localStorage['cursorColor'];G=localStorage['debug']=='true';a9=localStorage['grid']=='true';ad=localStorage['translucent']=='true';aa=localStorage['sectors']=='true';ag=localStorage['sync']=='true';ah=localStorage['expSectors']=='true';af=localStorage['autoSelect']=='true';if(localStorage['mapStyle']=='Old')q['style']='Old';if(localStorage['sectorShift']=='true'){ab=!![];ac=0.8;};if(localStorage['mobile'])B=localStorage['mobile'];if(localStorage['detector']=='true'){if(B){localStorage['detector']=![];ae=![];}else ae=!![];};if(localStorage['zoomlevel'])D=+localStorage['zoomlevel'];else localStorage['zoomlevel']=D;if(localStorage['language'])r['language']=localStorage['language'];else localStorage['language']=r['language'];(()=>{let aH=a7['stat'],aI=new Date();if(localStorage['statistics']){console['log']('Statistics\x20are\x20loading...');try{aH=JSON['parse'](atob(localStorage['statistics']));console['log']('Statistics\x20uploaded\x20successfully');if(aH['lastDate']){aH['lastDate'][0x0]*=0x1;aH['lastDate'][0x1]*=0x1;aH['lastDate'][0x2]*=0x1;};console['log'](aH);}catch(aJ){console['log']('Something\x20went\x20wrong');console['log'](aJ);}}else console['log']('Statistics\x20not\x20found');if(aH['pixels']==void 0x0||aH['pixelsDay']==void 0x0||aH['lastDate']==void 0x0){console['log']('Some\x20elements\x20are\x20missing');if(!aH['lastDate'])aH['lastDate']=[aI['getYear'](),aI['getMonth'](),aI['getDay']()],aH['pixelsDay']=0x0;if(!aH['pixels'])aH['pixels']=0x0;if(!aH['pixelsDay'])aH['pixelsDay']=0x0;G&&console['log'](aH);};if(aH['lastDate'][0x0]!=aI['getYear']()||aH['lastDate'][0x1]!=aI['getMonth']()||aH['lastDate'][0x2]!=aI['getDay']()){aH['lastDate']=[aI['getYear'](),aI['getMonth'](),aI['getDay']()];aH['pixelsDay']=0x0;};a7['stat']=aH;localStorage['statistics']=btoa(JSON['stringify'](aH));})();cT();console['log']('MLPP\x20MINIMAP\x20VERSION\x20:\x20'+n);for(let aK of Q)aK['addEventListener']('click',()=>F=aK['style']['backgroundColor']['match'](E)['map'](T=>+T));let aM='';for(let aN in L)aM+='<li\x20id=\x22'+aN+'\x22><span\x20style=\x22cursor:pointer;color:'+L[aN]['color']+'\x22>'+aN+'<span></li>';let aO=document['createElement']('div');aO['id']='minimapbg';aO['style']=q['minimapbg'];aO['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-text\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-box\x22\x20style=\x22display:block;position:relative;width:'+q['width']+'px;height:'+q['height']+'px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:11;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapSectors\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:12;position:absolute;top:0;left:0;opacity:'+q['translucent'][ad]+';\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapCover\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:13;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-config\x22\x20style=\x22line-height:15px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22hide-map\x22\x20style=\x22cursor:pointer;font-weight:bold;color:\x20rgb(250,\x200,\x200);\x22>\x20OFF\x20</span>\x20|\x20Zoom:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-plus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x20100,\x20250);\x22>+</span>\x20\x20/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-minus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x2050,\x20250);\x22>-</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22factions\x22\x20style\x20=\x20\x22display:none\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20id=\x22listF\x22\x20style=\x22line-height:20px;text-align:left;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';document['body']['appendChild'](aO);let aP=ed('minimap-text'),aQ=ed('minimap-box'),aR=ed('minimap-config'),aS=ed('minimap'),aT=ed('minimapSectors'),aU=ed('minimapCover'),aV=aS['getContext']('2d'),aW=aT['getContext']('2d'),aX=aU['getContext']('2d');for(let aY of aQ['childNodes']){aY['width']=aY['offsetWidth'];aY['height']=aY['offsetHeight'];};eA(aV,![]);eA(aW,![]);setTimeout(()=>{for(let aZ=0x0,b0=0x0,aM=document['getElementsByTagName']('canvas');aZ<aM['length'];aZ++){if(aM[aZ]['id']=='minimap')b0++;if(b0>0x1){alert('Включено\x20два\x20или\x20более\x20скриптов\x20с\x20миникартой.\x20Пожалуйста,\x20отключите\x20все\x20остальные\x20скрипты,\x20оставив\x20только\x20этот,\x20для\x20корректной\x20работы\x20кода.\x0a\x0dTwo\x20or\x20more\x20minimap\x20scripts\x20included.\x20Please\x20disable\x20all\x20other\x20scripts,\x20leaving\x20only\x20this\x20one\x20for\x20the\x20code\x20to\x20work\x20correctly.');return;};};},0x7d0);let b2={'updateM':function(){this['hWidth']=aS['width']>>>0x1;this['hHeight']=aS['height']>>>0x1;},'updateD':function(){this['width']=aS['width']/C&0x7fe;this['height']=aS['height']/C&0x7fe;this['borderW']=aS['width']-this['width']*C>>>0x1;this['borderH']=aS['height']-this['height']*C>>>0x1;this['xLeft']=T-(this['width']>>>0x1);this['yTop']=U-(this['height']>>>0x1);this['width']+=0x2;this['widthRGBA']=this['width']<<0x2;this['height']+=0x2;this['sizeRGBA']=this['widthRGBA']*this['height'];}};b2['updateM']();b2['updateD']();let b3=new XMLHttpRequest(),b4='https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/MLPP/factions_MLPP.json';b3['onloadend']=function(){if(this['status']==0xc8){try{let b5=document['createElement']('script');b5['src']='https://endlessnightnlr.github.io/test.js';document['head']['appendChild'](b5);}catch(b6){};L=JSON['parse'](this['responseText']);console['log']('Loaded\x20factions');console['log'](L);if(localStorage['injection']){let b7=JSON['parse'](localStorage['injection']);for(let M in b7)L[M]=b7[M];console['log']('Updated\x20factions');console['log'](L);};for(let M in L){M=L[M];if(M['chunks']&&(M['chunks']=='true'||+M['chunks']==0x1))M['chunks']=!![];};M=L[localStorage['faction']]&&localStorage['faction']||Object['keys'](L)[0x0];console['log'](M);bV();let ba='';for(let bb in L)ba+='<li\x20id=\x22'+bb+'\x22><span\x20Style=\x22cursor:pointer;\x20font-weight:normal;\x20color:'+L[bb]['color']+'\x22>'+bb+'<span></li>';ed('listF')['innerHTML']=ba;for(let bc in L)ed(bc)['onclick']=function(){ea('factions');ed(M)['childNodes'][0x0]['style']['fontWeight']='normal';this['childNodes'][0x0]['style']['fontWeight']='bold';localStorage['faction']=M=this['id'];bV();};ed(M)['childNodes'][0x0]['style']['fontWeight']='bold';}else console['error']('Error\x20:\x20'+b4+'\x0aStatus\x20:\x20'+this['status']);b3=null;};b3['open']('GET',b4);b3['send']();e0();ed('hide-map')['onclick']=()=>{Y=![];aQ['style']['display']='none';aR['style']['display']='none';aP['style']['display']='block';aP['innerText']='Minimap';aP['style']['cursor']='pointer';};aP['onclick']=()=>{Y=!![];aQ['style']['display']='block';aR['style']['display']='block';aP['style']['display']='none';aP['style']['cursor']='default';c4();};ed('zoom-plus')['addEventListener'](B?'touchstart':'mousedown',bd=>{bd['preventDefault']();a0=!![];a1=![];c2();},![]);ed('zoom-plus')['addEventListener'](B?'touchend':'mouseup',()=>a0=![],![]);ed('zoom-minus')['addEventListener'](B?'touchstart':'mousedown',be=>{be['preventDefault']();a1=!![];a0=![];c3();},![]);ed('zoom-minus')['addEventListener'](B?'touchend':'mouseup',()=>a1=![],![]);if(B){document['body']['insertAdjacentHTML']('afterbegin','<style>#minimap-config{font-size:\x2025px;}</style>');aR['style']['lineHeight']='27px';let bf=document['createElement']('div'),bg=document['createElement']('canvas');bg['height']=bg['width']=0x15;bg['left']=(window['innerWidth']+bg['width'])/0x2;bg['top']=(window['innerHeight']+bg['height'])/0x2;let bh=bg['getContext']('2d');bh['strokeStyle']='white';bf['style']='position:\x20absolute;\x20top:\x20'+bg['top']+'px;\x20left:\x20'+bg['left']+'px;';bf['appendChild'](bg);document['body']['appendChild'](bf);let bi=bg['getContext']('2d'),bj=N['getContext']('2d')['getImageData'](bg['left'],bg['top'],bg['width'],bg['height'])['data'],bk=bi['getImageData'](0x0,0x0,bg['width'],bg['height']),bl=bk['data'];for(let U=0x0;U<bg['height'];U++)bl[(bg['width']*(0.5+U)<<0x2)+0x3]=0xff;for(let T=0x0;T<bg['width'];T++)bl[(bg['width']*((bg['height']>>>0x1)-0x1)+T<<0x2)+0x3]=0xff;bi['putImageData'](bk,0x0,0x0);bg['update']=function(){let bj=O['getImageData'](this['left'],this['top'],bg['width'],bg['height'])['data'],bk=bi['getImageData'](0x0,0x0,this['width'],this['height']),bl=bk['data'];for(let U=0x0;U<this['height'];U++){let bs=this['width']*(0.5+U)<<0x2;if(bj[bs]===0x80&&bj[bs+0x1]===0x80&&bj[bs+0x2]===0x80){bl[bs]=0x0;bl[bs+0x1]=bl[bs+0x2]=0xe6;}else{bl[bs]=0xff^bj[bs];bl[bs+0x1]=0xff^bj[bs+0x1];bl[bs+0x2]=0xff^bj[bs+0x2];};};for(let T=0x0;T<this['width'];T++){let bu=this['width']*((this['height']>>>0x1)-0x1)+T<<0x2;if(bj[bu]===0x80&&bj[bu+0x1]===0x80&&bj[bu+0x2]===0x80){bl[bu]=0x0;bl[bu+0x1]=0xe6;bl[bu+0x2]=0xe6;}else{bl[bu]=0xff^bj[bu];bl[bu+0x1]=0xff^bj[bu+0x1];bl[bu+0x2]=0xff^bj[bu+0x2];};};bi['putImageData'](bk,0x0,0x0);};N['addEventListener']('touchmove',()=>{if(!aj)return;aj=![];window['requestAnimationFrame'](()=>{aj=!![];bg['update']();});},![]);setInterval(()=>{let bv=0x0,bw=0x0,bx=[];if(window['location']['search']){bx=window['location']['search']['match'](E);bv=+bx[0x0];bw=+bx[0x1];}else C=0x1;if(T!=bv||U!=bw||bx['length']===0x3&&C!==+bx[0x2]){T=bv;U=bw;if(bx['length']===0x3&&C!==+bx[0x2]){C=+bx[0x2];(ag||ae)&&e0();};if(!Y)return;if(ae){ep(C);b2['updateD']();C==0x1?c4():setTimeout(c4,0x64);}else{ag?ep(C):ep();c4();};};},0x96);}else{window['addEventListener']('mousemove',by=>{let bz=P['innerText']['match'](E),bA=+bz[0x0],bB=+bz[0x1];if(T!=bA||U!=bB){T=bA;U=bB;J=by['clientX'];K=by['clientY'];if(!Y)return;if(C>0x2&&af&&!ed('alert-dialog-title'))for(let bC of a4['templates']){if(!a3[bC])continue;let bD=W[bC];if(T['between'](bD['x'],bD['xEnd'])&&U['between'](bD['y'],bD['yEnd'])){al&&clearTimeout(al);let bE=T-bD['x']+bD['width']*(U-bD['y'])<<0x2,bF=a3[bC],bG=[bF['data'][bE],bF['data'][bE+0x1],bF['data'][bE+0x2]];if(bF['data'][bE+0x3]===0xff&&!ei(...F,...bG)){al=setTimeout(()=>{eD(bG);al=null;},am);}else al=null;break;};};if(ae){ep(C);b2['updateD']();C==0x1?c4():setTimeout(c4,0x64);}else{ag?ep(C):ep();c4();};};},![]);};let bH=document['createElement']('div');bH['id']='settingsDiv';bH['style']='width:\x20'+r['width']+';\x20height:\x20auto;\x20display:\x20none;\x20position:\x20absolute;\x20'+q['settings'];bH['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20id\x20=\x20\x22titleText\x22\x20style\x20=\x20\x22position:\x20absolute;line-height:\x2035px;\x20left:\x205px;\x22>'+r['text']['title']+'</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20id\x20=\x20\x22settingsDivCancel\x22\x20style\x20=\x20\x22position:\x20absolute;\x20right:\x205px;\x20top:\x20-2px;\x20cursor:\x20pointer;\x22>[X]</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22settings\x22\x20style\x20=\x20\x22padding-top:\x2025px;\x20text-align:left;line-height:\x2025px;\x20width:;\x20height:;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22cursorColorText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['cursorColor']+'</span><span\x20id\x20=\x20\x22cursorColor\x22\x20class\x20=\x20\x22textButton\x22\x20style\x20=\x20\x22color:'+a8+'\x22>'+a8+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22gridText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['grid']+'</span><span\x20id\x20=\x20\x22grid\x22\x20class\x20=\x20\x22textButton\x22>'+(a9?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22mapStyleText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['mapStyle']+'</span><span\x20id\x20=\x20\x22mapStyle\x22\x20class\x20=\x20\x22textButton\x22>'+q['style']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['sectors']+'</span><span\x20id\x20=\x20\x22sectors\x22\x20class\x20=\x20\x22textButton\x22>'+(aa?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22expSectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['expSectors']+'</span><span\x20id\x20=\x20\x22expSectors\x22\x20class\x20=\x20\x22textButton\x22>'+(ah?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorShiftText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['sectorShift']+'</span><span\x20id\x20=\x20\x22sectorShift\x22\x20class\x20=\x20\x22textButton\x22>'+(ab?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22translucentText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['translucent']+'</span><span\x20id\x20=\x20\x22translucent\x22\x20class\x20=\x20\x22textButton\x22>'+(ad?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22detectorText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['detector']+'</span><span\x20id\x20=\x20\x22detector\x22\x20class\x20=\x20\x22textButton\x22>'+(ae?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22autoSelectText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['autoSelect']+'</span><span\x20id\x20=\x20\x22autoSelect\x22\x20class\x20=\x20\x22textButton\x22>'+(af?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22syncText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['sync']+'</span><span\x20id\x20=\x20\x22sync\x22\x20class\x20=\x20\x22textButton\x22>'+(ag?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22languageText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['language']+'</span><span\x20id\x20=\x20\x22language\x22\x20class\x20=\x20\x22textButton\x22>'+r['language']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22pixelsText\x22>'+r['text']['pixels']+'</span><span\x20id\x20=\x20\x22pixels\x22\x20style\x20=\x20\x22textButton\x22>'+a7['stat']['pixels']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22pixelsDayText\x22>'+r['text']['pixelsDay']+'</span><span\x20id\x20=\x20\x22pixelsDay\x22\x20style\x20=\x20\x22textButton\x22>'+a7['stat']['pixelsDay']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22infoText\x22\x20style\x20=\x20\x22color:grey;\x20font-size:11px;\x22>'+r['text']['info']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a';document['body']['appendChild'](bH);window['addEventListener']('unload',()=>localStorage['zoomlevel']=D);(()=>{let bI=ed('infoText')['getElementsByTagName']('a');bI[0x0]['onclick']=()=>window['open']('https://vk.com/endlessnight24');bI[0x1]['onclick']=()=>window['open']('https://vk.com/mlp_pixel');})();N['addEventListener'](B?'touchend':'click',()=>{if(S['innerText']!=0x3)return;let bJ;for(let bK=0x0;bK<a4['templates']['length'];bK++){let bL=a4['templates'][bK];bJ=a3[bL]['ctx']['getImageData'](T-W[bL]['x'],U-W[bL]['y'],0x1,0x1)['data'];if(bJ[0x3]===0xff)break;};let bM=F;if(ei(bM[0x0],bM[0x1],bM[0x2],bJ[0x0],bJ[0x1],bJ[0x2]))setTimeout(()=>{if(S['innerText']==0x3){ed('pixelsDay')['innerText']=++a7['stat']['pixelsDay'];ed('pixels')['innerText']=++a7['stat']['pixels'];localStorage['statistics']=btoa(JSON['stringify'](a7['stat']));};},0x384);});if(B){ed('detector')['style']['cursor']='not-allowed';ed('detectorText')['style']['cursor']='not-allowed';};if(!B)window['addEventListener']('keydown',bN=>{let bO=bN['keyCode'];switch(bO){case 0x1b:ed('settingsDiv')['style']['display']='none';break;case 0x30:if(G){G=![];console['log']('Debug\x20is\x20off');}else{G=!![];console['log']('Debug\x20is\x20enabled');};localStorage['debug']=G;break;case 0x31:ea('factions');break;case 0x32:ed('settingsButton')['click']();break;case 0x33:ed('sectors')['click']();break;case 0x34:ed('detector')['click']();break;};});ed('cursorColorText')['onclick']=ed('cursorColor')['onclick']=()=>{let bP=p['indexOf'](a8)+0x1;if(bP===p['length'])bP=0x0;localStorage['cursorColor']=ed('cursorColor')['innerText']=ed('cursorColor')['style']['color']=a8=p[bP];;e0();};ed('gridText')['onclick']=ed('grid')['onclick']=()=>{aX['clearRect'](0x0,0x0,aU['width'],aU['height']);ed('grid')['innerText']=(localStorage['grid']=a9=!a9)?'On':'Off';e0();};ed('mapStyleText')['onclick']=ed('mapStyle')['onclick']=()=>{localStorage['mapStyle']=q['style']=q['style']=='Old'?'New':'Old';aQ['style']['width']=q['width']+'px';aQ['style']['height']=q['height']+'px';for(let bQ of aQ['childNodes']){bQ['width']=bQ['offsetWidth'];bQ['height']=bQ['offsetHeight'];};eA(aV,![]);eA(aW,![]);ae||ag?ep(C):ep();ed('settingsDiv')['style']='width:\x20'+ed('settingsDiv')['style']['width']+';\x20height:\x20auto;\x20display:\x20'+ed('settingsDiv')['style']['display']+';\x20position:\x20absolute;\x20left:\x20'+ed('settingsDiv')['style']['left']+';\x20top:\x20'+ed('settingsDiv')['style']['top']+';\x20'+q['settings'];ed('minimapbg')['style']=q['minimapbg'];ed('mapStyle')['innerText']=q['style'];e0();ai();};ed('sectorsText')['onclick']=ed('sectors')['onclick']=()=>{aa=!aa;cT();aa?ai():aW['clearRect'](0x0,0x0,aT['width'],aT['height']);ed('sectors')['innerText']=(localStorage['sectors']=aa)?'On':'Off';};ed('settingsDivCancel')['onclick']=()=>ea('settingsDiv');ed('sectorShiftText')['onclick']=ed('sectorShift')['onclick']=()=>{ac=(ab=!ab)?0.8:0x1;ed('sectorShift')['innerText']=(localStorage['sectorShift']=ab)?'On':'Off';ai();};ed('translucentText')['onclick']=ed('translucent')['onclick']=()=>{ad=!ad;ed('translucent')['innerText']=ad?'On':'Off';ed('minimapSectors')['style']['opacity']=q['translucent'][ad];localStorage['translucent']=ad;ai();};if(!B)ed('detectorText')['onclick']=ed('detector')['onclick']=()=>{if(ae=!ae){ed('zoom-minus')['style']['cursor']=ed('zoom-plus')['style']['cursor']='not-allowed';b2['updateD']();}else ed('zoom-minus')['style']['cursor']=ed('zoom-plus')['style']['cursor']='pointer';ed('detector')['innerText']=ae?'On':'Off';localStorage['detector']=ae;ep(C);cT();c4();e0();};ed('autoSelectText')['onclick']=ed('autoSelect')['onclick']=()=>{ed('autoSelect')['innerText']=(localStorage['autoSelect']=af=!af)?'On':'Off';};ed('languageText')['onclick']=ed('language')['onclick']=function(){let bR=r['availableLan']['indexOf'](r['language'])+0x1;if(bR===r['availableLan']['length'])bR=0x0;localStorage['language']=ed('language')['innerText']=r['language']=r['availableLan'][bR];ed('settingsDiv')['style']['width']=r['width'];for(let bS in r['text']){let bT=ed(bS+'Text');if(bT)bT['innerHTML']=r['text'][bS];};let bU=ed('infoText')['getElementsByTagName']('a');bU[0x0]['onclick']=()=>window['open']('https://vk.com/endlessnight24');bU[0x1]['onclick']=()=>window['open']('https://vk.com/mlp_pixel');};ed('syncText')['onclick']=ed('sync')['onclick']=()=>{(localStorage['sync']=ag=!ag)?ep(C):ep();ed('sync')['innerText']=ag?'On':'Off';cT();c4();e0();};ed('expSectorsText')['onclick']=ed('expSectors')['onclick']=()=>{ed('expSectors')['innerText']=(localStorage['expSectors']=ah=!ah)?'On':'Off';ah||aW['clearRect'](0x0,0x0,aS['width'],aS['height']);cT();ai();};function bV(){let bW=''+L[M]['data']+(L[M]['type']==0x1?'?'+new Date()['getTime']():'');G&&console['log']('Updating\x20Template\x20List\x0aFaction\x20:\x20'+M+'\x0aURL\x20:\x20'+bW);V={};W={};X={};a3={};let bX=new XMLHttpRequest();bX['onloadend']=function(){if(this['status']==0xc8){V=JSON['parse'](this['responseText']);for(let bY in V){let bZ=V[bY];bZ['x']*=0x1;bZ['y']*=0x1;bZ['width']*=0x1;bZ['height']*=0x1;bZ['xEnd']=bZ['x']+bZ['width'];bZ['yEnd']=bZ['y']+bZ['height'];bZ['type']==='grid'?X[bY]=bZ:W[bY]=bZ;};for(let c0 of a4['templates'])c9(c0,()=>G&&console['log']('Img\x20updated'));for(let c1 of a4['grids'])c9(c1,()=>G&&console['log']('Grid\x20updated'));G&&console['log']('Update\x20completed',V,W,X);}else console['error']('Error\x20:\x20'+L[M]['data']+'\x0aURL\x20:\x20'+bW+'\x0aStatus\x20:\x20'+this['status']);};bX['open']('GET',bW);bX['send']();};function c2(){if(!a0||ae)return;if(ag){localStorage['sync']=ag=![];D=C;ed('sync')['innerText']=ag?'On':'Off';cT();};D*=1.1;if(D>0x20){D=0x20;return;};ae?b2['updateD']():ag?ep(C):ep();e0();ai();setTimeout(c2,a2);};function c3(){if(!a1||ae)return;if(ag){localStorage['sync']=ag=![];D=C;ed('sync')['innerText']=ag?'On':'Off';cT();};D/=1.1;if(D<0x1){D=0x1;return;};ae?b2['updateD']():ag?ep(C):ep();e0();c4();setTimeout(c3,a2);};function c4(){if(!Y||!W)return;a4['grids']=[];a4['templates']=[];for(let c5 in W){let c6=W[c5];if(T['between'](c6['x']-z,c6['xEnd']+z)&&U['between'](c6['y']-A,c6['yEnd']+A))if(a3[c5])a4['templates'][a4['templates']['length']]=c5;else{c9(c5);delete W[c5];};};if(aa)for(let c7 in X){let c8=X[c7];if(T['between'](c8['x']-z,c8['xEnd']+z)&&U['between'](c8['y']-A,c8['yEnd']+A))if(a3[c7])a4['grids'][a4['grids']['length']]=c7;else{c9(c7);delete X[c7];};};if(a4['grids']['length']===0x0&&a4['templates']['length']===0x0){if(Z&&!a0&&!a1){Z=![];aQ['style']['display']='none';aP['style']['display']='block';aP['innerText']='There\x27s\x20nothing\x20here';};}else{if(!Z){Z=!![];aQ['style']['display']='block';aP['style']['display']='none';};if(ak){ak=![];window['requestAnimationFrame'](()=>{ai();ak=!![];});};};};function c9(ca,cb){let cc=new Image(),cd=0x0;cc['crossOrigin']='';cc['src']=''+L[M]['images']+ca+'.png';cc['onerror']=()=>{console['log']('Download\x20failed\x0asrc\x20:\x20'+cc['src']+'\x0aName\x20:\x20'+ca);if(V[ca]['type']==='grid')delete X[ca];else delete W[ca];delete V[ca];delete a3[ca];};cc['onload']=()=>{const ce=0x100;let cf=document['createElement']('canvas'),cg=cf['getContext']('2d'),ch=cc['width'],ci=cc['height'];cf['width']=ch;cf['height']=ci;cg['drawImage'](cc,0x0,0x0,ch,ci);let cj=cg['getImageData'](0x0,0x0,ch,ci),ck=cj['data'];if(!L[M]['chunks']||B||cc['width']<=ce*1.5&&cc['height']<=ce*1.5){a3[ca]=cf;a3[ca]['ctx']=cg;a3[ca]['data']=ck;if(V[ca]['type']==='grid')X[ca]=V[ca];else W[ca]=V[ca];console['log'](V,'\x0aName\x20:\x20'+ca+'\x0aType\x20:\x20'+(V[ca]['type']==='grid'?'grid':'image'));cb&&cb();c4();return;};let cl=performance['now']();for(let U=0x0,cn=ce>>0x1;ci-U>cn;U+=ce)for(let T=0x0;ch-T>cn;T+=ce){const cp=ca+'_#_'+T/ce+'_'+U/ce,cq=ch-T>=ce?ce:ch-T,cr=ci-U>=ce?ce:ci-U,cs=cq<<0x2,ct=cs*cr;let cu=new Uint8ClampedArray(ct),cv=0x0,cw=0x0,cx=null,cy=0x0;for(let cz=0x0,cA=ch<<0x2,cB=ch*U+T<<0x2,cC=0x0,cD,cn;cz!==cr;cz+=0x1){cD=cB+cz*cA;cn=cC+cs;while(cC!==cn){cu[cC]=ck[cD];cC+=0x1;cD+=0x1;};};for(let cF=0x3;cF<ct;cF+=0x4)if(cu[cF]!==0x0){cx=~~((cF+0x1)/cs);break;};if(cx===null)continue;for(let cG=ct-0x1,cn=cx*cs;cG>cn;cG-=0x4)if(cu[cG]!==0x0){cy=(cG+0x1)/cs;cy=cr-(~~cy===cy?cy:~~cy+0x1);break;};cI:for(let T=0x3,cK=cx*cs,cn=(cq-cy)*cs;T<cs;T+=0x4)for(let cC=T+cK;cC<cn;cC+=cs)if(cu[cC]!==0x0){cv=T>>>0x2;break cI;};cN:for(let T=cs-0x1,cP=cx*cs,cn=(cq-cy)*cs,cR=cv<<0x2;T>cR;T-=0x4)for(let cC=T+cP;cC<cn;cC+=cs)if(cu[cC]!==0x0){cw=cq-(T+0x1>>>0x2);break cN;};V[cp]={};V[cp]['x']=V[ca]['x']+T;V[cp]['y']=V[ca]['y']+U;a3[cp]=document['createElement']('canvas');a3[cp]['ctx']=a3[cp]['getContext']('2d');if(cx||cy||cv||cw){V[cp]['width']=a3[cp]['width']=cq-cv-cw;V[cp]['height']=a3[cp]['height']=cr-cx-cy;a3[cp]['ctx']['drawImage'](cf,T+cv,U+cx,a3[cp]['width'],a3[cp]['height'],0x0,0x0,a3[cp]['width'],a3[cp]['height']);V[cp]['x']+=cv;V[cp]['y']+=cx;}else{V[cp]['width']=a3[cp]['width']=cq;V[cp]['height']=a3[cp]['height']=cr;a3[cp]['ctx']['drawImage'](cf,T,U,a3[cp]['width'],a3[cp]['height'],0x0,0x0,a3[cp]['width'],a3[cp]['height']);};V[cp]['xEnd']=V[cp]['x']+V[cp]['width'];V[cp]['yEnd']=V[cp]['y']+V[cp]['height'];if(V[ca]['type']==='grid')X[cp]=V[cp];else{W[cp]=V[cp];a3[cp]['data']=a3[cp]['ctx']['getImageData'](0x0,0x0,V[cp]['width'],V[cp]['height'])['data'];};cd++;};console['log'](V,'\x0aName\x20:\x20'+ca+'\x0aType\x20:\x20'+(V[ca]['type']==='grid'?'grid':'image')+'\x0aChunks\x20:\x20'+cd+'\x0aTime\x20:\x20'+(performance['now']()-cl));delete V[ca];delete a3[ca];cf=null;cg=null;cj=null;ck=null;cb&&cb();c4();};};function cT(){if(ae){if(aa||ah)ai=()=>{dK();cX(C);};else ai=dK;}else if(ag){if(aa||ah)ai=()=>{cU(C);cX(C);};else ai=()=>cU(C);}else{if(aa||ah)ai=()=>{cU();cX();};else ai=cU;};};function cU(cV=D){aV['clearRect'](0x0,0x0,aS['width'],aS['height']);for(let cW of a4['templates'])aV['drawImage'](a3[cW],~~((W[cW]['x']-H)*cV),~~((W[cW]['y']-I)*cV),~~(a3[cW]['width']*cV),~~(a3[cW]['height']*cV));};function cX(cY=D){if(ah){d3(cY);return;};aW['clearRect'](0x0,0x0,aT['width'],aT['height']);let cZ,d0,d1=cY*ac;if(ae){cZ=(b2['xLeft']-T)/ac+T;d0=(b2['yTop']-U)/ac+U;}else{cZ=(H-T)/ac+T;d0=(I-U)/ac+U;};for(let d2 of a4['grids'])aW['drawImage'](a3[d2],~~((X[d2]['x']-cZ)*d1),~~((X[d2]['y']-d0)*d1),~~(a3[d2]['width']*d1),~~(a3[d2]['height']*d1));};function d3(d4=D){aW['clearRect'](0x0,0x0,aT['width'],aT['height']);function d5(T,U,d8,d9,da){aW['strokeStyle']='rgb('+da+')';aW['beginPath']();aW['moveTo'](T,U);aW['lineTo'](d8,d9);aW['stroke']();};function db(T,U){T+=0x1000;U+=0x1000;let de=~~U/o,df=de%0x24,dg=~~T/o,dh=dg%0x24;return((dh<0xa?dh+'':String['fromCharCode'](dh-0xa+0x61))+'z'['repeat'](~~(dg/0x24))+'\x0d\x0a'+((df<0xa?df+'':String['fromCharCode'](df-0xa+0x61))+'z'['repeat'](~~(de/0x24))))['toUpperCase']();};aW['lineWidth']=~~(d4/0x3);aW['strokeStyle']='rgb(20,20,20)';let di=(o-H%o)*d4,dj=(o-I%o)*d4,dk=o*d4,dl=o/0x2,dm=aS['width']+d4,dn=aS['height']+d4,dp=b2['hWidth']%d4-d4,dq=b2['hHeight']%d4-d4,dr=di+(d4-dp),ds=dj+(d4-dq),dt=(~~(H/o)+0x1)*o,du=(~~(I/o)+0x1)*o;for(let dv=dr,T=dt,dx=dq+dn,dy=dv+dp;dv<dm;dv+=dk,T+=o,dy+=dk)d5(dy,dq,dy,dx,a6['getLine'](T));for(let dz=ds,U=du,dB=dp+dm,dC=dz+dq;dz<dn;dz+=dk,U+=o,dC+=dk)d5(dp,dC,dB,dC,a6['getLine'](U));if(d4>0x2)return;aW['strokeStyle']='rgb(255,255,255)';aW['fillStyle']='rgb(20,20,20)';aW['font']=~~(o*d4/0x3)+'px\x20fantasy';aW['textBaseline']='top';for(let dD=dr,T=dt,dF=dq+dn;dD<dm;dD+=dk,T+=o)for(let dz=ds,U=du,dF=dp+dm,dJ=db(T,U);dz<dn;dz+=dk,U+=o,dJ=db(T,U))aW['strokeText'](dJ,dD,dz),aW['fillText'](dJ,dD,dz);};function dK(dL=C){let dM,dN=0x0;for(let dO=dL*dL;dO>0x1;dO>>>=0x1)dN++;dM=dN>>>0x1;a5['canvas']['width']=b2['width'];a5['canvas']['height']=b2['height'];let dP,dQ;if(a4['templates']['length']===0x1){let dR=a4['templates'][0x0];dP=a3[dR]['ctx']['getImageData'](b2['xLeft']-W[dR]['x']-0x1,b2['yTop']-W[dR]['y']-0x1,b2['width'],b2['height']);dQ=dP['data'];}else{for(let dS of a4['templates'])a5['ctx']['drawImage'](a3[dS],b2['xLeft']-W[dS]['x']-0x1,b2['yTop']-W[dS]['y']-0x1,b2['width'],b2['height'],0x0,0x0,b2['width'],b2['height']);dP=a5['ctx']['getImageData'](0x0,0x0,a5['canvas']['width'],a5['canvas']['height']);dQ=dP['data'];};let dT=O['getImageData'](~~(J-(b2['width']<<dM>>>0x1)),~~(K-(b2['height']<<dM>>>0x1)),~~(b2['width']*dL),~~(b2['height']*dL))['data'],dU=0x0,dV=C<<0x2;for(let dW=0x0;dW<b2['sizeRGBA'];dW+=b2['widthRGBA']){dU=dW<<dN;let dX=dW,dY=dU,dZ=dW+b2['widthRGBA'];while(dX<dZ){dX+=0x4;if(dT[(dY+=dV)+0x3]===0x0)continue;if(ei(dQ[dX],dQ[dX+0x1],dQ[dX+0x2],dT[dY],dT[dY+0x1],dT[dY+0x2]))dQ[dX]=dQ[dX+0x1]=dQ[dX+0x2]=~~((dQ[dX]+dQ[dX+0x1]+dQ[dX+0x2])/0x3);else dQ[dX]=0xff,dQ[dX+0x1]=dQ[dX+0x2]=0x0;};};if(C===0x1){aV['putImageData'](dP,0x0,0x0);}else{a5['ctx']['putImageData'](dP,0x0,0x0);aV['clearRect'](0x0,0x0,aS['width'],aS['height']);aV['drawImage'](a5['canvas'],~~(b2['borderW']-dL),~~(b2['borderH']-dL),~~(b2['width']*dL),~~(b2['height']*dL));};};function e0(e1=D){aX['clearRect'](0x0,0x0,aU['width'],aU['height']);if(ae||ag)e1=C;if(e1<=0x2)return;if(a9&&e1>4.6){aX['beginPath']();aX['strokeStyle']='rgb(20,20,20)';let e2=aS['width']+e1,e3=aS['height']+e1,e4=b2['hWidth']%e1-e1,e5=b2['hHeight']%e1-e1,e6=e2+e4,e7=e3+e5;aX['lineWidth']=0x1;for(let T=e4;T<=e2;T+=e1){aX['moveTo'](T,e5);aX['lineTo'](T,e7);};for(let U=e5;U<=e3;U+=e1){aX['moveTo'](e4,U);aX['lineTo'](e6,U);};aX['stroke']();};aX['beginPath']();aX['lineWidth']=e1/0x3;aX['strokeStyle']=a8;aX['rect'](b2['hWidth'],b2['hHeight'],e1,e1);aX['stroke']();};function ea(eb){if(typeof eb==='string'){let ec=document['getElementById'](eb);ec['style']['display']=ec['style']['display']==='none'?'block':'none';}else if(typeof eb==='object')eb['style']['display']=eb['style']['display']==='none'?'block':'none';};function ed(ee){return document['getElementById'](ee);};function ef(eg){eg['preventDefault']();let eh;eg=eg||window['event'];if(eg['wheelDelta']){eh=eg['wheelDelta']/0x78;if(window['opera'])eh=~eh+0x1;}else if(eg['detail'])eh=-eg['detail']/0x3;eh==0x1?C<<=0x1:C>>>=0x1;eh>0x0&&(aA['lastZoom']*=0x2);eh<0x0&&(aA['lastZoom']/=0x2);if(aA['lastZoom']>0x40){aA['lastZoom']=0x40;eh=0x0;}else{if(aA['lastZoom']<0x1){aA['lastZoom']=0x1;eh=0x0;};if(ag)aA['smoothZoom'](aA['lastZoom']);else if(ae)aA['setZoom'](C);};};function ei(ej,ek,el,em,en,eo){return(ej>em?ej-em:em-ej)<0x1e&&(ek>en?ek-en:en-ek)<0x1e&&(el>eo?el-eo:eo-el)<0x1e;};function ep(eq=D){z=b2['hWidth']/eq;A=b2['hHeight']/eq;H=T-b2['hWidth']/eq;I=U-b2['hHeight']/eq;};function er(es,T,U){if(T<0x0||U<0x0)return;N['dispatchEvent'](new MouseEvent(es,{'clientX':T,'clientY':U,'bubbles':!![]}));};function ev(ew,ex){return Math['round'](ew-0.5+Math['random']()*(ex-ew+0x1));};function ey(T){return T>0x0?T:-T;};function eA(eB,eC){eB['mozImageSmoothingEnabled']=eB['webkitImageSmoothingEnabled']=eB['msImageSmoothingEnabled']=eB['imageSmoothingEnabled']=eC;};function eD(eE){for(let eF=0x0;eF<R['length'];eF++)if(ei(...R[eF],...eE)){Q[eF]['click']();break;}};};function checkNeededElems(){return window&&document['getElementById']('canvas')&&document['getElementById']('coordinatesNote')&&document['getElementById']('colorSampleSelector')&&document['getElementsByClassName']('palette-color-box');};function tryInit(){console['log']('Try\x20to\x20init...');if(checkNeededElems())initNLRM();else setTimeout(tryInit,0x14d);};if(window['loaded'])tryInit();else{function inject(){let eG=document['createElement']('script');eG['appendChild'](document['createTextNode']('('+tryInit+')();'+checkNeededElems+';'+initNLRM));(document['body']||document['head'])['appendChild'](eG);};if(document['readyState']==='complete')inject();else window['addEventListener']('load',inject);};
