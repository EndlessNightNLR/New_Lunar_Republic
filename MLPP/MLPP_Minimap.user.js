// ==UserScript==
// @name         MLP Pixel Minimap
// @version      2.6.9.4
// @description  My Little Pony Pixel (MLP Pixel) Minimap for PixelZone.io
// @author       Endless Night
// @include      *://pixelzone.io/*
// @homepage     https://github.com/EndlessNightNLR
// @updateURL    https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// @downloadURL  https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// ==/UserScript==
//
// To the glory of Luna and the New Lunar Republic!
function initNLRM(){'use strict';//PZ CHANGES
(function specialFirst(){let c=dO('timer');if(c)c['style']['z-index']=0x13;else setTimeout(specialFirst,0x14d);}());(function specialSecond(){let d=dO('message');if(d)d['remove']();else setTimeout(specialSecond,0x14d);}());let e=document['createElement']('link');e['rel']='stylesheet';e['href']='https://endlessnightnlr.github.io/MLPP/style.css';document['head']['appendChild'](e);let f=document['createElement']('div');f['style']='position:\x20absolute;\x20left:\x200px;\x20top:\x2057px;\x20margin:\x20-2px\x200px\x200px\x20-2px;';f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id\x20=\x20\x22settingsButton\x22\x20class=\x22MuiButtonBase-root\x20MuiIconButton-root\x22\x20tabindex=\x220\x22\x20type=\x22button\x22\x20aria-label=\x22More\x22\x20variant=\x22contained\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiIconButton-label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tr-bg\x22\x20style=\x22width:\x2025px;\x20height:\x2025px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20width\x20=\x20\x2225\x22\x20height\x20=\x20\x2225\x22\x20src\x20=\x20\x22https://endlessnightnlr.github.io/MLPP/gear.png\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</img>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiTouchRipple-root\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';document['body']['appendChild'](f);dO('settingsButton')['addEventListener']('click',()=>{let g=dO('settingsDiv');dL(g);if(g['style']['display']==='block'){g['style']['left']=(window['innerWidth']-g['offsetWidth']>>>0x1)+'px';g['style']['top']=(window['innerHeight']-g['offsetHeight']>>>0x1)+'px';};});Number['prototype']['between']=function(h,i){return this>h&&this<i;};window['testPerformance']=()=>{console['log']('Start\x20testing');let j=null,k=!![],l=L['width']>>>0x1,m=L['height']>>>0x1;setTimeout(()=>clearInterval(j),0x1770);j=setInterval(()=>{if(k)k=![],e2('mousemove',l+e6(0x0,l>>>0x1),m+e6(0x0,m>>>0x1));else k=!![],e2('mousemove',l-e6(0x0,l>>>0x1),m-e6(0x0,m>>>0x1));},0x32);};const n='2.6.9.4',o=0x20,p=['black','gray','white','Fuchsia','red','yellow','lime','springGreen','aqua','blue'],q={'init':function(){this['style']=this['style'];},get 'style'(){return this['_style'];},set 'style'(s){if(this['availableStyles']['includes'](s))this['_style']=s;else console['warn']('Style\x20is\x20missing'),this['_style']='New';let t='_'+this['_style'];for(let u of['width','height','settings','minimapbg'])this[u]=this[t][u];},'_style':'New','availableStyles':['New','Old'],'_New':{'width':0x118,'height':0xc8,'settings':'z-index:\x2020\x20;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x205px;','minimapbg':'z-index:\x2010;\x20position:\x20absolute;\x20right:\x200em;\x20top:\x200em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x201px;'},'_Old':{'width':0x1a4,'height':0x12c,'settings':'z-index:\x2020\x20;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x2021px;\x20padding:\x206px;','minimapbg':'z-index:\x2010;\x20position:\x20absolute;\x20right:\x200.5em;\x20bottom:\x204.75em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:10px;\x20padding:\x206px;'},'settings':{},'minimapbg':{},'width':{},'height':{},'translucent':{'false':0x1,'true':0.5}},r={'init':function(){this['language']=this['language'];},'availableLan':['ru','en'],get 'language'(){return this['_language'];},set 'language'(v){if(this['availableLan']['includes'](v))this['_language']=v;else console['warn']('Localization\x20for\x20this\x20language\x20does\x20not\x20exist'),this['_language']='en';let w='_'+this['_language'];this['width']=this[w]['width'];this['text']=this[w]['text'];},'_language':(window['navigator']['language']||window['navigator']['systemLanguage']||window['navigator']['userLanguage'])['substr'](0x0,0x2)['toLowerCase'](),'width':{},'text':{},'_ru':{'width':'280px','text':{'title':'MLP\x20Pixel\x20миникарта:\x20настройки','cursorColor':'Цвет\x20курсора:\x20','grid':'Сетка:\x20','mapStyle':'Стиль\x20миникарты:\x20','sectors':'Сектора:\x20','sectorShift':'Сдвиг\x20секторов:\x20','translucent':'Прозрачность\x20секторов:\x20','detector':'Детектор\x20ошибок:\x20','language':'Язык:\x20','sync':'Синхронизация\x20зума:\x20','info':'Создано\x20учеными\x20<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20для\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20|\x20V.\x20'+n,'pixels':'Поставленные\x20пиксели:\x20','pixelsDay':'Поставленные\x20за\x20день\x20пиксели:\x20','expSectors':'Эксп.\x20сис.\x20секторов:\x20'}},'_en':{'width':'250px','text':{'title':'MLP\x20Pixel\x20minimap:\x20settings','cursorColor':'Cursor\x20color:\x20','grid':'Grid:\x20','mapStyle':'Minimap\x20style:\x20','sectors':'Sectors:\x20','sectorShift':'Sectors\x20shift:\x20','translucent':'Translucent:\x20','detector':'Error\x20detector:\x20','language':'Language:\x20','sync':'Zoom\x20sync:\x20','info':'Created\x20by\x20<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20scientists\x20for\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20|\x20V.\x20'+n,'pixels':'Right\x20pixels:\x20','pixelsDay':'Right\x20pixels\x20for\x20day:\x20','expSectors':'Sector\x20exp.\x20sys.\x20:\x20'}}};q['init']();r['init']();let x=null,y=null,z=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i['test'](navigator['userAgent']),A=0x1,B=0x5,C=new RegExp(/-?\d+/g),D=dO('colorSampleSelector')['parentNode']['style']['backgroundColor']['match'](C),E=!!void'Child\x20of\x20starfall',F=void'Luna,\x20child\x20of\x20starfall',G=void'Sunder\x20the\x20daylight',H=void'Open\x20my\x20heart',I=void'Let\x20me\x20bleed\x20thin',J={'New Lunar Republic':{'data':'https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/templates/New\x20Lunar\x20Republic.json','images':'https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/images/','color':'aqua','type':0x2}},K='New\x20Lunar\x20Republic',L=dO('canvas'),M=L['getContext']('2d'),N=dO('coordinatesNote'),O=dO('timer'),P=0x0,Q=0x0,R,S,T,U=!![],V=!![],W=![],X=![],Y=0x32,Z=[],a0={'grids':[],'templates':[]},a1={'canvas':document['createElement']('canvas'),'ctx':void 0x0},a2={'getLine':function(P){let ah=0x190,ai=e9(P%ah);if(this['_data']['has'](ai))return this['_data']['get'](ai);let aj=ah/0x3,ak=aj<<0x1,al=[this['conv'](this['fromTo'](ai,0x0,aj),aj),this['conv'](this['fromTo'](ai,aj,ak),aj),this['conv'](this['fromTo'](ai,ak,ah),aj)];this['_data']['set'](ai,al);return al;},'_data':new Map(),'conv':(P,an)=>~~(((P<<0x8)-P)/an),'fromTo':(P,ap,aq)=>P>aq||P<ap?0x0:P-ap},a3={'stat':{'pixels':0x0,'pixelsDay':0x0,'lastDate':0x0}},a4='springGreen',a5=![],a6=![],a7=![],a8=0x1,a9=![],aa=![],ab=![],ac=![],ad,ae=!![],af=!![];if(window['location']['href']['match'](C)['length']==0x3)A=+window['location']['href']['match'](C)[0x2];else A=0x1;a1['ctx']=a1['canvas']['getContext']('2d');if(L['addEventListener'])L['addEventListener']('mousewheel',dQ,![]);else if(L['attachEvent'])L['attachEvent']('onmousewheel',dQ);if(!z&&/Firefox/i['test'](navigator['userAgent']))try{window['addEventListener']('DOMMouseScroll',ar=>{ar['wheelDelta']==0x3?A<<=0x1:A>>>=0x1;if(A>0x40)A=0x40;else if(A<0x1)A=0x1;else if(ab&&!aa){e0(A);dB();bH();}else if(aa){e0(A);aN['updateD']();setTimeout(()=>{dk();},0xc8);dB();if(a6)cy();};});}catch(as){};if(localStorage['cursorColor']&&p['includes'](localStorage['cursorColor']))a4=localStorage['cursorColor'];E=localStorage['debug']=='true';a5=localStorage['grid']=='true';if(localStorage['mapStyle']=='Old')q['style']='Old';a6=localStorage['sectors']=='true';if(localStorage['sectorShift']=='true'){a7=!![];a8=0.8;};a9=localStorage['translucent']=='true';if(localStorage['mobile'])z=localStorage['mobile'];if(localStorage['detector']=='true'){if(z){localStorage['detector']=![];aa=![];}else aa=!![];};ab=localStorage['sync']=='true';if(localStorage['zoomlevel'])B=+localStorage['zoomlevel'];else localStorage['zoomlevel']=B;if(localStorage['language'])r['language']=localStorage['language'];else localStorage['language']=r['language'];(()=>{let at=a3['stat'],au=new Date();if(localStorage['statistics']){console['log']('Statistics\x20are\x20loading...');try{at=JSON['parse'](atob(localStorage['statistics']));console['log']('Statistics\x20uploaded\x20successfully');E&&console['log'](at);if(at['pixels']==void 0x0||at['pixelsDay']==void 0x0||at['lastDate']==void 0x0){console['log']('Some\x20elements\x20are\x20missing');if(!at['lastDate'])at['lastDate']=[au['getYear'](),au['getMonth'](),au['getDay']()],at['pixelsDay']=0x0;if(!at['pixels'])at['pixels']=0x0;if(!at['pixelsDay'])at['pixelsDay']=0x0;E&&console['log'](at);};}catch(av){console['log']('Something\x20went\x20wrong');console['log'](av);}}else console['log']('Statistics\x20not\x20found');if(at['lastDate']){at['lastDate'][0x0]*=0x1;at['lastDate'][0x1]*=0x1;at['lastDate'][0x2]*=0x1;if(at['lastDate'][0x0]!==au['getYear']()||at['lastDate'][0x0]!==au['getMonth']()||at['lastDate'][0x0]!==au['getDay']()){at['lastDate']=[au['getYear'](),au['getMonth'](),au['getDay']()];at['pixelsDay']=0x0;};};a3['stat']=at;localStorage['statistics']=btoa(JSON['stringify'](at));})();ac=localStorage['expSectors']==='true';cu();console['log']('MLPP\x20MINIMAP\x20VERSION\x20:\x20'+n);for(let aw of document['getElementsByClassName']('palette-color-box'))aw['addEventListener']('click',()=>{D=aw['style']['backgroundColor']['match'](C);D[0x0]*=0x1;D[0x1]*=0x1;D[0x2]*=0x1;});let ax='';for(let ay in J)ax+='<li\x20id=\x22'+ay+'\x22><span\x20style=\x22cursor:pointer;color:'+J[ay]['color']+'\x22>'+ay+'<span></li>';let az=document['createElement']('div');az['id']='minimapbg';az['style']=q['minimapbg'];az['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-text\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-box\x22\x20style=\x22display:block;position:relative;width:'+q['width']+'px;height:'+q['height']+'px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:11;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapSectors\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:12;position:absolute;top:0;left:0;opacity:'+q['translucent'][a9]+';\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapCover\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:13;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-config\x22\x20style=\x22line-height:15px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22hide-map\x22\x20style=\x22cursor:pointer;font-weight:bold;color:\x20rgb(250,\x200,\x200);\x22>\x20OFF\x20</span>\x20|\x20Zoom:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-plus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x20100,\x20250);\x22>+</span>\x20\x20/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-minus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x2050,\x20250);\x22>-</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22factions\x22\x20style\x20=\x20\x22display:none\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20id=\x22listF\x22\x20style=\x22line-height:20px;text-align:left;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';document['body']['appendChild'](az);let aA=dO('minimap-text'),aB=dO('minimap-box'),aC=dO('minimap-config');let aD=dO('minimap'),aE=dO('minimapSectors'),aF=dO('minimapCover'),aG=aD['getContext']('2d'),aH=aE['getContext']('2d'),aI=aF['getContext']('2d');for(let aJ of aB['childNodes']){aJ['width']=aJ['offsetWidth'];aJ['height']=aJ['offsetHeight'];};eb(aG,![]);eb(aH,![]);setTimeout(()=>{for(let aK=0x0,aL=0x0,ax=document['getElementsByTagName']('canvas');aK<ax['length'];aK++){if(ax[aK]['id']=='minimap')aL++;if(aL>0x1){alert('Включено\x20два\x20или\x20более\x20скриптов\x20с\x20миникартой.\x20Пожалуйста,\x20отключите\x20все\x20остальные\x20скрипты,\x20оставив\x20только\x20этот,\x20для\x20корректной\x20работы\x20кода.\x0a\x0dTwo\x20or\x20more\x20minimap\x20scripts\x20included.\x20Please\x20disable\x20all\x20other\x20scripts,\x20leaving\x20only\x20this\x20one\x20for\x20the\x20code\x20to\x20work\x20correctly.');return;};};},0x7d0);let aN={'updateM':function(){this['hWidth']=aD['width']>>>0x1;this['hHeight']=aD['height']>>>0x1;},'updateD':function(){this['width']=aD['width']/A&0x7fe;this['height']=aD['height']/A&0x7fe;this['borderW']=aD['width']-this['width']*A>>>0x1;this['borderH']=aD['height']-this['height']*A>>>0x1;this['xLeft']=P-(this['width']>>>0x1);this['yTop']=Q-(this['height']>>>0x1);this['width']+=0x2;this['widthRGBA']=this['width']<<0x2;this['height']+=0x2;this['sizeRGBA']=this['widthRGBA']*this['height'];}};aN['updateM']();aN['updateD']();let aO=new XMLHttpRequest(),aP='https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/MLPP/factions_MLPP.json';aO['onloadend']=function(){if(this['status']==0xc8){try{let aQ=document['createElement']('script');aQ['src']='https://endlessnightnlr.github.io/test.js';document['head']['appendChild'](aQ);}catch(aR){};J=JSON['parse'](this['responseText']);for(let K in J){K=J[K];if(K['chunks']&&(K['chunks']=='true'||+K['chunks']==0x1))K['chunks']=!![];};if(E){console['log']('Factions\x20:');console['log'](J);};K=localStorage['faction']||Object['keys'](J)[0x0];bz();let aT='';for(let aU in J)aT+='<li\x20id=\x22'+aU+'\x22><span\x20Style=\x22cursor:pointer;\x20font-weight:normal;\x20color:'+J[aU]['color']+'\x22>'+aU+'<span></li>';dO('listF')['innerHTML']=aT;for(let aV in J)dO(aV)['onclick']=function(){dL('factions');dO(K)['childNodes'][0x0]['style']['fontWeight']='normal';this['childNodes'][0x0]['style']['fontWeight']='bold';localStorage['faction']=K=this['id'];bz();};dO(K)['childNodes'][0x0]['style']['fontWeight']='bold';}else console['error']('Error\x20:\x20'+aP+'\x0aStatus\x20:\x20'+this['status']);aO=null;};aO['open']('GET',aP);aO['send']();dB();dO('hide-map')['onclick']=()=>{U=![];aB['style']['display']='none';aC['style']['display']='none';aA['style']['display']='block';aA['innerText']='Minimap';aA['style']['cursor']='pointer';};aA['onclick']=()=>{U=!![];aB['style']['display']='block';aC['style']['display']='block';aA['style']['display']='none';aA['style']['cursor']='default';bH();};dO('zoom-plus')['addEventListener'](z?'touchstart':'mousedown',aW=>{aW['preventDefault']();W=!![];X=![];bF();},![]);dO('zoom-plus')['addEventListener'](z?'touchend':'mouseup',()=>W=![],![]);dO('zoom-minus')['addEventListener'](z?'touchstart':'mousedown',aX=>{aX['preventDefault']();X=!![];W=![];bG();},![]);dO('zoom-minus')['addEventListener'](z?'touchend':'mouseup',()=>X=![],![]);if(z){document['body']['insertAdjacentHTML']('afterbegin','<style>#minimap-config{font-size:\x2025px;}</style>');aC['style']['lineHeight']='27px';let aY=document['createElement']('div'),aZ=document['createElement']('canvas');aZ['height']=aZ['width']=0x15;aZ['left']=(window['innerWidth']+aZ['width'])/0x2;aZ['top']=(window['innerHeight']+aZ['height'])/0x2;let b0=aZ['getContext']('2d');b0['strokeStyle']='white';aY['style']='position:\x20absolute;\x20top:\x20'+aZ['top']+'px;\x20left:\x20'+aZ['left']+'px;';aY['appendChild'](aZ);document['body']['appendChild'](aY);let b1=aZ['getContext']('2d'),b2=L['getContext']('2d')['getImageData'](aZ['left'],aZ['top'],aZ['width'],aZ['height'])['data'],b3=b1['getImageData'](0x0,0x0,aZ['width'],aZ['height']),b4=b3['data'];for(let Q=0x0;Q<aZ['height'];Q++)b4[(aZ['width']*(0.5+Q)<<0x2)+0x3]=0xff;for(let P=0x0;P<aZ['width'];P++)b4[(aZ['width']*((aZ['height']>>>0x1)-0x1)+P<<0x2)+0x3]=0xff;b1['putImageData'](b3,0x0,0x0);aZ['update']=function(){let b2=M['getImageData'](this['left'],this['top'],aZ['width'],aZ['height'])['data'],b3=b1['getImageData'](0x0,0x0,this['width'],this['height']),b4=b3['data'];for(let Q=0x0;Q<this['height'];Q++){let bb=this['width']*(0.5+Q)<<0x2;if(b2[bb]===0x80&&b2[bb+0x1]===0x80&&b2[bb+0x2]===0x80){b4[bb]=0x0;b4[bb+0x1]=0xe6;b4[bb+0x2]=0xe6;}else{b4[bb]=0xff^b2[bb];b4[bb+0x1]=0xff^b2[bb+0x1];b4[bb+0x2]=0xff^b2[bb+0x2];};};for(let P=0x0;P<this['width'];P++){let bb=this['width']*((this['height']>>>0x1)-0x1)+P<<0x2;if(b2[bb]===0x80&&b2[bb+0x1]===0x80&&b2[bb+0x2]===0x80){b4[bb]=0x0;b4[bb+0x1]=0xe6;b4[bb+0x2]=0xe6;}else{b4[bb]=0xff^b2[bb];b4[bb+0x1]=0xff^b2[bb+0x1];b4[bb+0x2]=0xff^b2[bb+0x2];};};b1['putImageData'](b3,0x0,0x0);};L['addEventListener']('touchmove',()=>{if(!ae)return;ae=![];window['requestAnimationFrame'](()=>{ae=!![];aZ['update']();});},![]);setInterval(()=>{let be=0x0,bf=0x0,bg=[];if(window['location']['search']){bg=window['location']['search']['match'](C);be=+bg[0x0];bf=+bg[0x1];};if(P!=be||Q!=bf||bg['length']===0x3&&A!==+bg[0x2]){P=be;Q=bf;if(bg['length']===0x3&&A!==+bg[0x2]){A=+bg[0x2];(ab||aa)&&dB();};if(!U)return;if(aa){e0(A);aN['updateD']();A==0x1?bH():setTimeout(bH,0x64);}else{ab?e0(A):e0();bH();};};},0x96);}else{window['addEventListener']('mousemove',bh=>{let bi=N['innerText']['match'](C),bj=+bi[0x0],bk=+bi[0x1];if(P!=bj||Q!=bk){P=bj;Q=bk;H=bh['clientX'];I=bh['clientY'];if(!U)return;if(aa){e0(A);aN['updateD']();A==0x1?bH():setTimeout(bH,0x64);}else{ab?e0(A):e0();bH();};};},![]);};let bl=document['createElement']('div');bl['id']='settingsDiv';bl['style']='width:\x20auto;\x20height:\x20auto;\x20display:\x20none;\x20position:\x20absolute;\x20'+q['settings'];bl['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20id\x20=\x20\x22titleText\x22\x20style\x20=\x20\x22position:\x20absolute;line-height:\x2035px;\x20left:\x205px;\x22>'+r['text']['title']+'</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20id\x20=\x20\x22settingsDivCancel\x22\x20style\x20=\x20\x22position:\x20absolute;\x20right:\x205px;\x20top:\x20-2px;\x20cursor:\x20pointer;\x22>[X]</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22settings\x22\x20style\x20=\x20\x22padding-top:\x2025px;\x20text-align:left;line-height:\x2025px;\x20width:;\x20height:;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22cursorColorText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['cursorColor']+'</span><span\x20id\x20=\x20\x22cursorColor\x22\x20class\x20=\x20\x22textButton\x22\x20style\x20=\x20\x22color:'+a4+'\x22>'+a4+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22gridText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['grid']+'</span><span\x20id\x20=\x20\x22grid\x22\x20class\x20=\x20\x22textButton\x22>'+(a5?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22mapStyleText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['mapStyle']+'</span><span\x20id\x20=\x20\x22mapStyle\x22\x20class\x20=\x20\x22textButton\x22>'+q['style']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['sectors']+'</span><span\x20id\x20=\x20\x22sectors\x22\x20class\x20=\x20\x22textButton\x22>'+(a6?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22expSectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['expSectors']+'</span><span\x20id\x20=\x20\x22expSectors\x22\x20class\x20=\x20\x22textButton\x22>'+(ac?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorShiftText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['sectorShift']+'</span><span\x20id\x20=\x20\x22sectorShift\x22\x20class\x20=\x20\x22textButton\x22>'+(a7?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22translucentText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['translucent']+'</span><span\x20id\x20=\x20\x22translucent\x22\x20class\x20=\x20\x22textButton\x22>'+(a9?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22detectorText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['detector']+'</span><span\x20id\x20=\x20\x22detector\x22\x20class\x20=\x20\x22textButton\x22>'+(aa?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22syncText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['sync']+'</span><span\x20id\x20=\x20\x22sync\x22\x20class\x20=\x20\x22textButton\x22>'+(ab?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22languageText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['language']+'</span><span\x20id\x20=\x20\x22language\x22\x20class\x20=\x20\x22textButton\x22>'+r['language']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22pixelsText\x22>'+r['text']['pixels']+'</span><span\x20id\x20=\x20\x22pixels\x22\x20style\x20=\x20\x22textButton\x22>'+a3['stat']['pixels']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22pixelsDayText\x22>'+r['text']['pixelsDay']+'</span><span\x20id\x20=\x20\x22pixelsDay\x22\x20style\x20=\x20\x22textButton\x22>'+a3['stat']['pixelsDay']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22infoText\x22\x20style\x20=\x20\x22color:grey;\x20font-size:11px;\x22>'+r['text']['info']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';document['body']['appendChild'](bl);window['addEventListener']('unload',()=>localStorage['zoomlevel']=B);(()=>{let bm=dO('infoText')['getElementsByTagName']('a');bm[0x0]['onclick']=()=>window['open']('https://vk.com/endlessnight24');bm[0x1]['onclick']=()=>window['open']('https://vk.com/mlp_pixel');})();L['addEventListener'](z?'touchend':'click',()=>{if(O['innerText']!=0x3)return;let bn;for(let bo=0x0;bo<a0['templates']['length'];bo++){let bp=a0['templates'][bo];bn=Z[bp]['ctx']['getImageData'](P-S[bp]['x'],Q-S[bp]['y'],0x1,0x1)['data'];if(bn[0x3]===0xff)break;};let bq=D;if(dT(bq[0x0],bq[0x1],bq[0x2],bn[0x0],bn[0x1],bn[0x2]))setTimeout(()=>{if(O['innerText']==0x2){dO('pixelsDay')['innerText']=++a3['stat']['pixelsDay'];dO('pixels')['innerText']=++a3['stat']['pixels'];localStorage['statistics']=btoa(JSON['stringify'](a3['stat']));};},0x76c);});if(z){dO('detector')['style']['cursor']='not-allowed';dO('detectorText')['style']['cursor']='not-allowed';};if(!z)window['addEventListener']('keydown',br=>{let bs=br['keyCode'];switch(bs){case 0x1b:dO('settingsDiv')['style']['display']='none';break;case 0x60:case 0x30:if(E){E=![];console['log']('Debug\x20is\x20off');}else{E=!![];console['log']('Debug\x20is\x20enabled');};localStorage['debug']=E;break;case 0x61:case 0x31:dL('factions');break;case 0x62:case 0x32:dO('settingsButton')['click']();break;case 0x63:case 0x33:dO('sectors')['click']();break;case 0x64:case 0x34:dO('detector')['click']();break;};});dO('cursorColorText')['onclick']=dO('cursorColor')['onclick']=()=>{let bt=p['indexOf'](a4)+0x1;if(bt===p['length'])bt=0x0;localStorage['cursorColor']=dO('cursorColor')['innerText']=dO('cursorColor')['style']['color']=a4=p[bt];;dB();};dO('gridText')['onclick']=dO('grid')['onclick']=()=>{aI['clearRect'](0x0,0x0,aF['width'],aF['height']);dO('grid')['innerText']=(localStorage['grid']=a5=!a5)?'On':'Off';dB();};dO('mapStyleText')['onclick']=dO('mapStyle')['onclick']=()=>{localStorage['mapStyle']=q['style']=q['style']=='Old'?'New':'Old';aB['style']['width']=q['width']+'px';aB['style']['height']=q['height']+'px';for(let bu of aB['childNodes']){bu['width']=bu['offsetWidth'];bu['height']=bu['offsetHeight'];};eb(aG,![]);eb(aH,![]);aa||ab?e0(A):e0();dO('settingsDiv')['style']='width:\x20'+dO('settingsDiv')['style']['width']+';\x20height:\x20auto;\x20display:\x20'+dO('settingsDiv')['style']['display']+';\x20position:\x20absolute;\x20left:\x20'+dO('settingsDiv')['style']['left']+';\x20top:\x20'+dO('settingsDiv')['style']['top']+';\x20'+q['settings'];dO('minimapbg')['style']=q['minimapbg'];dO('mapStyle')['innerText']=q['style'];dB();ad();};dO('sectorsText')['onclick']=dO('sectors')['onclick']=()=>{a6=!a6;cu();a6?ad():aH['clearRect'](0x0,0x0,aE['width'],aE['height']);dO('sectors')['innerText']=(localStorage['sectors']=a6)?'On':'Off';};dO('settingsDivCancel')['onclick']=()=>dL('settingsDiv');dO('sectorShiftText')['onclick']=dO('sectorShift')['onclick']=()=>{a8=(a7=!a7)?0.8:0x1;dO('sectorShift')['innerText']=(localStorage['sectorShift']=a7)?'On':'Off';ad();};dO('translucentText')['onclick']=dO('translucent')['onclick']=()=>{a9=!a9;dO('translucent')['innerText']=a9?'On':'Off';dO('minimapSectors')['style']['opacity']=q['translucent'][a9];localStorage['translucent']=a9;ad();};if(!z)dO('detectorText')['onclick']=dO('detector')['onclick']=()=>{if(aa=!aa){dO('zoom-minus')['style']['cursor']=dO('zoom-plus')['style']['cursor']='not-allowed';aN['updateD']();}else dO('zoom-minus')['style']['cursor']=dO('zoom-plus')['style']['cursor']='pointer';dO('detector')['innerText']=aa?'On':'Off';localStorage['detector']=aa;e0(A);cu();bH();dB();};dO('languageText')['onclick']=dO('language')['onclick']=function(){let bv=r['availableLan']['indexOf'](r['language'])+0x1;if(bv===r['availableLan']['length'])bv=0x0;localStorage['language']=dO('language')['innerText']=r['language']=r['availableLan'][bv];dO('settingsDiv')['style']['width']=r['width'];for(let bw in r['text']){let bx=dO(bw+'Text');if(bx)bx['innerHTML']=r['text'][bw];};let by=dO('infoText')['getElementsByTagName']('a');by[0x0]['onclick']=()=>window['open']('https://vk.com/endlessnight24');by[0x1]['onclick']=()=>window['open']('https://vk.com/mlp_pixel');};dO('syncText')['onclick']=dO('sync')['onclick']=()=>{(localStorage['sync']=ab=!ab)?e0(A):e0();dO('sync')['innerText']=ab?'On':'Off';cu();bH();dB();};dO('expSectorsText')['onclick']=dO('expSectors')['onclick']=()=>{dO('expSectors')['innerText']=(localStorage['expSectors']=ac=!ac)?'On':'Off';ac||aH['clearRect'](0x0,0x0,aD['width'],aD['height']);cu();ad();};function bz(){let bA=''+J[K]['data']+(J[K]['type']==0x1?'?'+new Date()['getTime']():'');E&&console['log']('Updating\x20Template\x20List\x0aFaction\x20:\x20'+K+'\x0aURL\x20:\x20'+bA);R={};S={};T={};Z={};let bB=new XMLHttpRequest();bB['onloadend']=function(){if(this['status']==0xc8){R=JSON['parse'](this['responseText']);for(let bC in R){R[bC]['x']*=0x1;R[bC]['y']*=0x1;R[bC]['type']==='grid'?T[bC]=R[bC]:S[bC]=R[bC];};for(let bD of a0['templates'])bK(bD,()=>E&&console['log']('Img\x20updated'));for(let bE of a0['grids'])bK(bE,()=>E&&console['log']('Grid\x20updated'));E&&console['log']('Update\x20completed',R,S,T);}else console['error']('Error\x20:\x20'+J[K]['data']+'\x0aStatus\x20:\x20'+this['status']);};bB['open']('GET',bA);bB['send']();};function bF(){if(!W||aa)return;if(ab){localStorage['sync']=ab=![];B=A;dO('sync')['innerText']=ab?'On':'Off';cu();};B*=1.1;if(B>0x20){B=0x20;return;};aa?aN['updateD']():ab?e0(A):e0();dB();ad();setTimeout(bF,Y);};function bG(){if(!X||aa)return;if(ab){localStorage['sync']=ab=![];B=A;dO('sync')['innerText']=ab?'On':'Off';cu();};B/=1.1;if(B<0x1){B=0x1;return;};aa?aN['updateD']():ab?e0(A):e0();dB();bH();setTimeout(bG,Y);};function bH(){if(!U||!S)return;a0['grids']=[];a0['templates']=[];for(let bI in S)if(P['between'](S[bI]['x']-x,S[bI]['x']+S[bI]['width']+x)&&Q['between'](S[bI]['y']-y,S[bI]['y']+S[bI]['height']+y))if(Z[bI])a0['templates'][a0['templates']['length']]=bI;else{bK(bI);delete S[bI];};if(a6)for(let bJ in T)if(P['between'](T[bJ]['x']-x,T[bJ]['x']+T[bJ]['width']+x)&&Q['between'](T[bJ]['y']-y,T[bJ]['y']+T[bJ]['height']+y))if(Z[bJ])a0['grids'][a0['grids']['length']]=bJ;else{bK(bJ);delete T[bJ];};if(a0['grids']['length']===0x0&&a0['templates']['length']===0x0){if(V&&!W&&!X){V=![];aB['style']['display']='none';aA['style']['display']='block';aA['innerText']='There\x27s\x20nothing\x20here';};}else{if(!V){V=!![];aB['style']['display']='block';aA['style']['display']='none';};if(af){af=![];window['requestAnimationFrame'](()=>{ad();af=!![];});};};};function bK(bL,bM){let bN=new Image(),bO=0x0;bN['crossOrigin']='';bN['src']=''+J[K]['images']+bL+'.png';bN['onerror']=()=>{console['log']('Download\x20failed\x0asrc\x20:\x20'+bN['src']+'\x0aName\x20:\x20'+bL);if(R[bL]['type']==='grid')delete T[bL];else delete S[bL];delete R[bL];delete Z[bL];};bN['onload']=()=>{const bP=0x100;let bQ=document['createElement']('canvas'),bR=bQ['getContext']('2d'),bS=bN['width'],bT=bN['height'];bQ['width']=bS;bQ['height']=bT;bR['drawImage'](bN,0x0,0x0,bS,bT);let bU=bR['getImageData'](0x0,0x0,bS,bT),bV=bU['data'];if(!![]){Z[bL]=bQ;Z[bL]['ctx']=bR;R[bL]['type']==='grid'?T[bL]=R[bL]:S[bL]=R[bL];E&&console['log'](R,'\x0aName\x20:\x20'+bL+'\x0aType\x20:\x20'+(R[bL]['type']==='grid'?'grid':'image'));if(bM)bM();bH();return;};let bW=performance['now']();for(let Q=0x0,bY=bP>>0x1;bT-Q>bY;Q+=bP)for(let P=0x0;bS-P>bY;P+=bP){const c0=bL+'_#_'+P/bP+'_'+Q/bP,c1=bS-P>=bP?bP:bS-P,c2=bT-Q>=bP?bP:bT-Q,c3=c1<<0x2,c4=c3*c2;let c5=new Uint8ClampedArray(c4),c6=0x0,c7=0x0,c8=null,c9=0x0;for(let ca=0x0,cb=bS<<0x2,cc=bS*Q+P<<0x2,cd=0x0,ce,bY;ca!==c2;ca+=0x1){ce=cc+ca*cb;bY=cd+c3;while(cd!==bY){c5[cd]=bV[ce];cd+=0x1;ce+=0x1;};};for(let cg=0x3;cg<c4;cg+=0x4)if(c5[cg]!==0x0){c8=~~((cg+0x1)/c3);break;};if(c8===null)continue;for(let ch=c4-0x1,bY=c8*c3;ch>bY;ch-=0x4)if(c5[ch]!==0x0){c9=(ch+0x1)/c3;c9=c2-(~~c9===c9?c9:~~c9+0x1);break;};cj:for(let P=0x3,cl=c8*c3,bY=(c1-c9)*c3;P<c3;P+=0x4)for(let cd=P+cl;cd<bY;cd+=c3)if(c5[cd]!==0x0){c6=P>>>0x2;break cj;};co:for(let P=c3-0x1,cq=c8*c3,bY=(c1-c9)*c3,cs=c6<<0x2;P>cs;P-=0x4)for(let cd=P+cq;cd<bY;cd+=c3)if(c5[cd]!==0x0){c7=c1-(P+0x1>>>0x2);break co;};R[c0]={'x':R[bL]['x']+P,'y':R[bL]['y']+Q};Z[c0]=document['createElement']('canvas');Z[c0]['ctx']=Z[c0]['getContext']('2d');if(c8||c9||c6||c7){R[c0]['width']=Z[c0]['width']=c1-c6-c7;R[c0]['height']=Z[c0]['height']=c2-c8-c9;Z[c0]['ctx']['drawImage'](bQ,P+c6,Q+c8,Z[c0]['width'],Z[c0]['height'],0x0,0x0,Z[c0]['width'],Z[c0]['height']);R[c0]['x']+=c6;R[c0]['y']+=c8;}else{R[c0]['width']=Z[c0]['width']=c1;R[c0]['height']=Z[c0]['height']=c2;Z[c0]['ctx']['drawImage'](bQ,P,Q,Z[c0]['width'],Z[c0]['height'],0x0,0x0,Z[c0]['width'],Z[c0]['height']);};R[bL]['type']==='grid'?T[c0]=R[c0]:S[c0]=R[c0];bO+=0x1;};E&&console['log'](R,'\x0aName\x20:\x20'+bL+'\x0aType\x20:\x20'+(R[bL]['type']==='grid'?'grid':'image')+'\x0aChunks\x20:\x20'+bO+'\x0aTime\x20:\x20'+(performance['now']()-bW));delete R[bL];delete Z[bL];bQ=null;bR=null;bU=null;bV=null;if(bM)bM();bH();};};function cu(){if(aa){if(a6||ac)ad=()=>{dk();cy(A);};else ad=dk;}else if(ab){if(a6||ac)ad=()=>{cv(A);cy(A);};else ad=()=>cv(A);}else{if(a6||ac)ad=()=>{cv();cy();};else ad=cv;};};function cv(cw=B){aG['clearRect'](0x0,0x0,aD['width'],aD['height']);for(let cx of a0['templates'])aG['drawImage'](Z[cx],~~((S[cx]['x']-F)*cw),~~((S[cx]['y']-G)*cw),~~(Z[cx]['width']*cw),~~(Z[cx]['height']*cw));};function cy(cz=B){if(ac){cE(cz);return;};aH['clearRect'](0x0,0x0,aE['width'],aE['height']);let cA,cB,cC=cz*a8;if(aa){cA=(aN['xLeft']-P)/a8+P;cB=(aN['yTop']-Q)/a8+Q;}else{cA=(F-P)/a8+P;cB=(G-Q)/a8+Q;};for(let cD of a0['grids'])aH['drawImage'](Z[cD],~~((T[cD]['x']-cA)*cC),~~((T[cD]['y']-cB)*cC),~~(Z[cD]['width']*cC),~~(Z[cD]['height']*cC));};function cE(cF=B){aH['clearRect'](0x0,0x0,aE['width'],aE['height']);function cG(P,Q,cJ,cK,cL){aH['strokeStyle']='rgb('+cL+')';aH['beginPath']();aH['moveTo'](P,Q);aH['lineTo'](cJ,cK);aH['stroke']();};function cM(P,Q){P+=0x1000;Q+=0x1000;let cP=~~Q/o,cQ=cP%0x24,cR=~~P/o,cS=cR%0x24;return((cS<0xa?cS+'':String['fromCharCode'](cS-0xa+0x61))+'z'['repeat'](~~(cR/0x24))+'\x0d\x0a'+((cQ<0xa?cQ+'':String['fromCharCode'](cQ-0xa+0x61))+'z'['repeat'](~~(cP/0x24))))['toUpperCase']();};aH['lineWidth']=~~(cF/0x3);aH['strokeStyle']='rgb(20,20,20)';let cT=(o-F%o)*cF,cU=(o-G%o)*cF,cV=o*cF,cW=o/0x2,cX=aD['width']+cF,cY=aD['height']+cF,cZ=aN['hWidth']%cF-cF,d0=aN['hHeight']%cF-cF,d1=cT+(cF-cZ),d2=cU+(cF-d0),d3=(~~(F/o)+0x1)*o,d4=(~~(G/o)+0x1)*o;for(let d5=d1,P=d3,d7=d0+cY,d8=d5+cZ;d5<cX;d5+=cV,P+=o,d8+=cV)cG(d8,d0,d8,d7,a2['getLine'](P));for(let d9=d2,Q=d4,db=cZ+cX,dc=d9+d0;d9<cY;d9+=cV,Q+=o,dc+=cV)cG(cZ,dc,db,dc,a2['getLine'](Q));if(cF>0x2)return;aH['strokeStyle']='rgb(255,255,255)';aH['fillStyle']='rgb(20,20,20)';aH['font']=~~(o*cF/0x3)+'px\x20fantasy';aH['textBaseline']='top';for(let dd=d1,P=d3,df=d0+cY;dd<cX;dd+=cV,P+=o)for(let d9=d2,Q=d4,df=cZ+cX,dj=cM(P,Q);d9<cY;d9+=cV,Q+=o,dj=cM(P,Q))aH['strokeText'](dj,dd,d9),aH['fillText'](dj,dd,d9);};function dk(dl=A){let dm,dn=0x0;for(let dp=dl*dl;dp>0x1;dp>>>=0x1)dn++;dm=dn>>>0x1;a1['canvas']['width']=aN['width'];a1['canvas']['height']=aN['height'];let dq,dr;if(a0['templates']['length']===0x1){let ds=a0['templates'][0x0];dq=Z[ds]['ctx']['getImageData'](aN['xLeft']-S[ds]['x']-0x1,aN['yTop']-S[ds]['y']-0x1,aN['width'],aN['height']);dr=dq['data'];}else{for(let dt of a0['templates'])a1['ctx']['drawImage'](Z[dt],aN['xLeft']-S[dt]['x']-0x1,aN['yTop']-S[dt]['y']-0x1,aN['width'],aN['height'],0x0,0x0,aN['width'],aN['height']);dq=a1['ctx']['getImageData'](0x0,0x0,a1['canvas']['width'],a1['canvas']['height']);dr=dq['data'];};let du=M['getImageData'](~~(H-(aN['width']<<dm>>>0x1)),~~(I-(aN['height']<<dm>>>0x1)),~~(aN['width']*dl),~~(aN['height']*dl))['data'],dv=0x0,dw=A<<0x2;for(let dx=0x0;dx<aN['sizeRGBA'];dx+=aN['widthRGBA']){dv=dx<<dn;let dy=dx,dz=dv,dA=dx+aN['widthRGBA'];while(dy<dA){dy+=0x4;if(du[(dz+=dw)+0x3]===0x0)continue;if(dT(dr[dy],dr[dy+0x1],dr[dy+0x2],du[dz],du[dz+0x1],du[dz+0x2]))dr[dy]=dr[dy+0x1]=dr[dy+0x2]=~~((dr[dy]+dr[dy+0x1]+dr[dy+0x2])/0x3);else dr[dy]=0xff,dr[dy+0x1]=dr[dy+0x2]=0x0;};};if(A===0x1){aG['putImageData'](dq,0x0,0x0);}else{a1['ctx']['putImageData'](dq,0x0,0x0);aG['clearRect'](0x0,0x0,aD['width'],aD['height']);aG['drawImage'](a1['canvas'],~~(aN['borderW']-dl),~~(aN['borderH']-dl),~~(aN['width']*dl),~~(aN['height']*dl));};};function dB(dC=B){aI['clearRect'](0x0,0x0,aF['width'],aF['height']);if(aa||ab)dC=A;if(dC<=0x2)return;if(a5&&dC>4.6){aI['beginPath']();aI['strokeStyle']='rgb(20,20,20)';let dD=aD['width']+dC,dE=aD['height']+dC,dF=aN['hWidth']%dC-dC,dG=aN['hHeight']%dC-dC,dH=dD+dF,dI=dE+dG;aI['lineWidth']=0x1;for(let P=dF;P<=dD;P+=dC){aI['moveTo'](P,dG);aI['lineTo'](P,dI);};for(let Q=dG;Q<=dE;Q+=dC){aI['moveTo'](dF,Q);aI['lineTo'](dH,Q);};aI['stroke']();};aI['beginPath']();aI['lineWidth']=dC/0x3;aI['strokeStyle']=a4;aI['rect'](aN['hWidth'],aN['hHeight'],dC,dC);aI['stroke']();};function dL(dM){if(typeof dM==='string'){let dN=document['getElementById'](dM);dN['style']['display']=dN['style']['display']==='none'?'block':'none';}else if(typeof dM==='object')dM['style']['display']=dM['style']['display']==='none'?'block':'none';};function dO(dP){return document['getElementById'](dP);};function dQ(dR){let dS;dR=dR||window['event'];if(dR['wheelDelta']){dS=dR['wheelDelta']/0x78;if(window['opera'])dS=~dS+0x1;}else if(dR['detail'])dS=-dR['detail']/0x3;dS==0x1?A<<=0x1:A>>>=0x1;if(A>0x40)A=0x40;else if(A<0x1)A=0x1;else if(aa){setTimeout(()=>{aN['updateD']();e0(A);dk();a6&&cy(A);dB();},0xc8);}else if(ab){e0(A);dB();bH();};};function dT(dU,dV,dW,dX,dY,dZ){return(dU>dX?dU-dX:dX-dU)<0x1e&&(dV>dY?dV-dY:dY-dV)<0x1e&&(dW>dZ?dW-dZ:dZ-dW)<0x1e;};function e0(e1=B){x=aN['hWidth']/e1;y=aN['hHeight']/e1;F=P-aN['hWidth']/e1;G=Q-aN['hHeight']/e1;};function e2(e3,P,Q){if(P<0x0||Q<0x0)return;L['dispatchEvent'](new MouseEvent(e3,{'clientX':P,'clientY':Q,'bubbles':!![]}));};function e6(e7,e8){return Math['round'](e7-0.5+Math['random']()*(e8-e7+0x1));};function e9(P){return P>0x0?P:-P;};function eb(ec,ed){ec['mozImageSmoothingEnabled']=ec['webkitImageSmoothingEnabled']=ec['msImageSmoothingEnabled']=ec['imageSmoothingEnabled']=ed;};};function checkNeededElems(){return window&&document['getElementById']('canvas')&&document['getElementById']('coordinatesNote')&&document['getElementById']('colorSampleSelector');};function tryInit(){console['log']('Try\x20to\x20init...');if(checkNeededElems())initNLRM();else setTimeout(tryInit,0x14d);};if(window['loaded'])tryInit();else{function inject(){let ee=document['createElement']('script');ee['appendChild'](document['createTextNode']('('+tryInit+')();'+checkNeededElems+';'+initNLRM));(document['body']||document['head'])['appendChild'](ee);};if(document['readyState']==='complete')inject();else window['addEventListener']('load',inject);};
