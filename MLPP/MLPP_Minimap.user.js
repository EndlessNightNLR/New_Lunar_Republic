// ==UserScript==
// @name         MLP Pixel Minimap
// @version      2.7.0.1
// @description  My Little Pony Pixel (MLP Pixel) Minimap for PixelZone.io
// @author       Endless Night
// @include      *://pixelzone.io/*
// @homepage     https://github.com/EndlessNightNLR
// @updateURL    https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// @downloadURL  https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// ==/UserScript==
//
// To the glory of Luna and the New Lunar Republic!
function initNLRM(){'use strict';{let c=document['createElement']('div'),d=document['createElement']('div'),e,f=null;c['style']='position:fixed;\x20bottom:0px;\x20right:0px;\x20background-color:rgba(0,0,0,0.9);\x20padding:5px;\x20z-index:0;';c['appendChild'](d);{setInterval(()=>{if(f===null)return;let g=~~(new Date()['getTime']()/0x3e8-f),h=g%0x3c,i=~~(g/0x3c);e['innerText']=(i>=0xa?i:'0'+i)+':'+(h>=0xa?h:'0'+h);},0x3e8);let j=document['createElement']('div');j['innerText']='Since\x20last\x20captcha\x20';e=document['createElement']('span');e['innerText']='null';j['appendChild'](e);c['appendChild'](j);};const k=(l,m)=>{d['innerText']=l;d['style']['color']=m;};k(void 0x0,'grey');let n;(function(o){WebSocket['prototype']['send']=function(){if(arguments[0x0]==='2'){k('Online','springGreen');clearTimeout(n);n=setTimeout(()=>k('Offline','red'),0x1e*0x3e8);return o['apply'](this,arguments);}else if(typeof arguments[0x0]==='string'){if(arguments[0x0]['includes']('captchaToken')){f=new Date()['getTime']()/0x3e8;T&&console['log'](arguments[0x0]);return o['apply'](this,arguments);}else return o['apply'](this,arguments);};};}(WebSocket['prototype']['send']));document['body']['appendChild'](c);};(function specialFirst(){let p=er('timer');if(p)p['style']['z-index']=0x13;else setTimeout(specialFirst,0x14d);}());(function specialSecond(){let q=er('message');if(q)q['remove']();else setTimeout(specialSecond,0x14d);}());let r=document['createElement']('link');r['rel']='stylesheet';r['href']='https://endlessnightnlr.github.io/MLPP/style.css';document['head']['appendChild'](r);document['getElementsByClassName']('palette-container')[0x0]['style']['z-index']=0x1;let s=document['createElement']('div');s['style']='position:\x20absolute;\x20left:\x200px;\x20top:\x2057px;\x20margin:\x20-2px\x200px\x200px\x20-2px;';s['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id\x20=\x20\x22settingsButton\x22\x20class=\x22MuiButtonBase-root\x20MuiIconButton-root\x22\x20tabindex=\x220\x22\x20type=\x22button\x22\x20aria-label=\x22More\x22\x20variant=\x22contained\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiIconButton-label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tr-bg\x22\x20style=\x22width:\x2025px;\x20height:\x2025px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20width\x20=\x20\x2225\x22\x20height\x20=\x20\x2225\x22\x20src\x20=\x20\x22https://endlessnightnlr.github.io/MLPP/gear.png\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</img>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiTouchRipple-root\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';document['body']['appendChild'](s);er('settingsButton')['addEventListener']('click',()=>{let t=er('settingsDiv');eo(t);if(t['style']['display']==='block'){t['style']['left']=(window['innerWidth']-t['offsetWidth']>>>0x1)+'px';t['style']['top']=(window['innerHeight']-t['offsetHeight']>>>0x1)+'px';};});Number['prototype']['between']=function(u,v){return this>u&&this<v;};window['testPerformance']=()=>{console['log']('Start\x20testing');let w=null,z=!![],A=a0['width']>>>0x1,B=a0['height']>>>0x1;setTimeout(()=>clearInterval(w),0x1770);w=setInterval(()=>{if(z)z=![],eF('mousemove',A+eJ(0x0,A>>>0x1),B+eJ(0x0,B>>>0x1));else z=!![],eF('mousemove',A-eJ(0x0,A>>>0x1),B-eJ(0x0,B>>>0x1));},0x32);};const C='2.7.0.1',D=0x20,E=['black','gray','white','Fuchsia','red','yellow','lime','springGreen','aqua','blue'],F={'init':function(){this['style']=this['style'];},get 'style'(){return this['_style'];},set 'style'(H){if(this['availableStyles']['includes'](H))this['_style']=H;else console['warn']('Style\x20is\x20missing'),this['_style']='New';let I='_'+this['_style'];for(let J of['width','height','settings','minimapbg'])this[J]=this[I][J];},'_style':'New','availableStyles':['New','Old'],'_New':{'width':0x118,'height':0xc8,'settings':'z-index:\x2020\x20;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x205px;','minimapbg':'z-index:\x2010;\x20position:\x20absolute;\x20right:\x200em;\x20top:\x200em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x201px;'},'_Old':{'width':0x1a4,'height':0x12c,'settings':'z-index:\x2020\x20;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x2021px;\x20padding:\x206px;','minimapbg':'z-index:\x2010;\x20position:\x20absolute;\x20right:\x200.5em;\x20bottom:\x204.75em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:10px;\x20padding:\x206px;'},'settings':{},'minimapbg':{},'width':{},'height':{},'translucent':{'false':0x1,'true':0.5}},G={'init':function(){this['language']=this['language'];},'availableLan':['ru','en','tr'],get 'language'(){return this['_language'];},set 'language'(K){if(this['availableLan']['includes'](K))this['_language']=K;else console['warn']('Localization\x20for\x20this\x20language\x20does\x20not\x20exist'),this['_language']='en';let L='_'+this['_language'];this['width']=this[L]['width'];this['text']=this[L]['text'];},'_language':(window['navigator']['language']||window['navigator']['systemLanguage']||window['navigator']['userLanguage'])['substr'](0x0,0x2)['toLowerCase'](),'width':{},'text':{},'_ru':{'width':'280px','text':{'on':'On','off':'Off','title':'MLP\x20Pixel\x20миникарта:\x20настройки','cursorColor':'Цвет\x20курсора:\x20','grid':'Сетка:\x20','mapStyle':'Стиль\x20миникарты:\x20','sectors':'Сектора:\x20','sectorShift':'Сдвиг\x20секторов:\x20','translucent':'Прозрачность\x20секторов:\x20','detector':'Детектор\x20ошибок:\x20','autoSelect':'Автовыбор\x20цвета:\x20','language':'Язык:\x20','sync':'Синхронизация\x20зума:\x20','info':'Создано\x20учеными\x20<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20для\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20|\x20V.\x20'+C,'pixels':'Поставленные\x20пиксели:\x20','pixelsDay':'Поставленные\x20за\x20день\x20пиксели:\x20','expSectors':'Эксп.\x20сис.\x20секторов:\x20'}},'_en':{'width':'250px','text':{'on':'On','off':'Off','title':'MLP\x20Pixel\x20minimap:\x20settings','cursorColor':'Cursor\x20color:\x20','grid':'Grid:\x20','mapStyle':'Minimap\x20style:\x20','sectors':'Sectors:\x20','sectorShift':'Sectors\x20shift:\x20','translucent':'Translucent:\x20','detector':'Error\x20detector:\x20','autoSelect':'Auto\x20color\x20selection:\x20','language':'Language:\x20','sync':'Zoom\x20sync:\x20','info':'Created\x20by\x20<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20scientists\x20for\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20|\x20V.\x20'+C,'pixels':'Correct\x20pixels:\x20','pixelsDay':'Correct\x20pixels\x20per\x20day:\x20','expSectors':'Sector\x20exp.\x20sys.\x20:\x20'}},'_tr':{'width':'280px','text':{'on':'Açık','off':'Kapalı','title':'MLP\x20Pixel\x20:\x20harita\x20ayarları','cursorColor':'İmleç\x20rengi:\x20','grid':'Izgara:\x20','mapStyle':'Minimap\x20stili:\x20','sectors':'Sectors:\x20','sectorShift':'Sectors\x20shift:\x20','translucent':'Yarı\x20saydam:\x20','detector':'Hata\x20dedektörü:\x20','autoSelect':'Otomatik\x20renk\x20seçme:\x20','language':'Dil:\x20','sync':'Zoom\x20sync:\x20','info':'<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20tarafından\x20yapıldı\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20için\x20düzenlendi\x20|\x20V.\x20'+C,'pixels':'Doğru\x20pixeller:\x20','pixelsDay':'Günlük\x20doğru\x20pixeller:\x20','expSectors':'Sector\x20exp.\x20sys.\x20:\x20'}}};F['init']();G['init']();let M=null,N=null,O=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i['test'](navigator['userAgent']),P=0x1,Q=0x5,R=new RegExp(/-?\d+/g),S=er('colorSampleSelector')['parentNode']['style']['backgroundColor']['match'](R),T=!!void'Child\x20of\x20starfall',U=void'Luna,\x20child\x20of\x20starfall',V=void'Sunder\x20the\x20daylight',W=void'Open\x20my\x20heart',X=void'Let\x20me\x20bleed\x20thin',Y={'New Lunar Republic':{'data':'https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/templates/New\x20Lunar\x20Republic.json','images':'https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/images/','color':'aqua','type':0x2,'chunks':![]}},Z='New\x20Lunar\x20Republic',a0=er('canvas'),a1=a0['getContext']('2d'),a2=er('coordinatesNote'),a3=document['getElementsByClassName']('palette-color-box'),a4=[],a5=er('timer'),a6=0x0,a7=0x0,a8,a9,aa,ab=!![],ac=!![],ad=![],ae=![],af=0x32,ag=[],ah={'grids':[],'templates':[]},ai={'canvas':document['createElement']('canvas'),'ctx':void 0x0},aj={'getLine':function(a6){let aB=0x190,aC=eM(a6%aB);if(this['_data']['has'](aC))return this['_data']['get'](aC);let aD=aB/0x3,aE=aD<<0x1,aF=[this['conv'](this['fromTo'](aC,0x0,aD),aD),this['conv'](this['fromTo'](aC,aD,aE),aD),this['conv'](this['fromTo'](aC,aE,aB),aD)];this['_data']['set'](aC,aF);return aF;},'_data':new Map(),'conv':(a6,aH)=>~~(((a6<<0x8)-a6)/aH),'fromTo':(a6,aJ,aK)=>a6>aK||a6<aJ?0x0:a6-aJ},ak={'stat':{'pixels':0x0,'pixelsDay':0x0,'lastDate':0x0},'lastCoords':{'x':null,'y':null}},al='springGreen',am=![],an=![],ao=![],ap=0x1,aq=![],ar=![],as=![],at=![],au=![],av=()=>{},aw=!![],ax=!![],ay=null,az=0x32;{let aL=null,aM=![],aN='6Lf7mNAUAAAAAMlrqmboiBe_T9_yrSvZu2NSMtW7';function aO(aP=0x3e8){aL=setTimeout(()=>grecaptcha['execute'](aN,{'action':'navigation'}),aP);};aO();(function(aQ){grecaptcha['execute']=function(){if(arguments[0x0]===aN){if(arguments[0x1]['action']==='place'){T&&console['log']('recaptcha\x20place');aM=![];aO();}else if(arguments[0x1]['action']==='navigation'){aL===null||clearTimeout(aL);if(aM)return;T&&console['log']('recaptcha\x20navigation');aM=!![];};}else{if(arguments[0x0][0x1]['action']==='place'){T&&console['log']('recaptcha\x20place');aM=![];aO();}else if(arguments[0x0][0x1]['action']==='navigation'){aL===null||clearTimeout(aL);if(aM)return;T&&console['log']('recaptcha\x20navigation');aM=!![];};};return aQ['apply'](this,arguments);};}(grecaptcha['execute']));};for(let aR of a3)a4['push'](aR['style']['backgroundColor']['match'](R)['map'](a6=>+a6));if(window['location']['search']&&window['location']['search']['match'](R)['length']==0x3)P=+window['location']['search']['match'](R)[0x2];else P=0x1;ai['ctx']=ai['canvas']['getContext']('2d');let aT={'lastZoom':P,'setZoom':function(aU){this['zoom']=P=aU;if(at){eD(P);ee();cj();}else if(ar&&~~P===P){setTimeout(()=>{bk['updateD']();eD(P);dZ();an&&dc(P);ee();},0xc8);};},'smoothZoom':function(aV){this['smoothZoomFrom']=this['zoom'];this['smoothZoomTo']=aV;this['smoothZoomStartDate']=Date['now']();this['smoothZoomUpdate']();},'executeZoom':function(aW){this['setZoom'](aW>0x40?0x40:aW<0x1?0x1:aW);},'smoothZoomUpdate':function(){let aX=(Date['now']()-this['smoothZoomStartDate'])/0xc8;if(aX>0x1){this['executeZoom'](this['smoothZoomTo']);return;};window['requestAnimationFrame'](()=>this['smoothZoomUpdate']());this['executeZoom'](this['smoothZoomFrom']+(0x1-0x1-(aX>0x1?0x1:aX<0x0?0x0:aX)**0x3)*(this['smoothZoomTo']-this['smoothZoomFrom']));}};aT['setZoom'](P);if(a0['addEventListener'])a0['addEventListener']('mousewheel',et,![]);else if(a0['attachEvent'])a0['attachEvent']('onmousewheel',et);if(!O&&/Firefox/i['test'](navigator['userAgent']))try{window['addEventListener']('DOMMouseScroll',et);}catch(aY){};if(localStorage['cursorColor']&&E['includes'](localStorage['cursorColor']))al=localStorage['cursorColor'];T=localStorage['debug']=='true';am=localStorage['grid']=='true';aq=localStorage['translucent']=='true';an=localStorage['sectors']=='true';at=localStorage['sync']=='true';au=localStorage['expSectors']=='true';as=localStorage['autoSelect']=='true';if(localStorage['mapStyle']=='Old')F['style']='Old';if(localStorage['sectorShift']=='true'){ao=!![];ap=0.8;};if(localStorage['mobile'])O=localStorage['mobile'];if(localStorage['detector']=='true'){if(O){localStorage['detector']=![];ar=![];}else ar=!![];};if(localStorage['zoomlevel'])Q=+localStorage['zoomlevel'];else localStorage['zoomlevel']=Q;if(localStorage['language'])G['language']=localStorage['language'];else localStorage['language']=G['language'];{let aZ=ak['stat'],b0=new Date();if(localStorage['statistics']){console['log']('Statistics\x20are\x20loading...');try{aZ=JSON['parse'](atob(localStorage['statistics']));console['log']('Statistics\x20uploaded\x20successfully');if(aZ['lastDate']){aZ['lastDate'][0x0]*=0x1;aZ['lastDate'][0x1]*=0x1;aZ['lastDate'][0x2]*=0x1;};console['log'](aZ);}catch(b1){console['log']('Something\x20went\x20wrong');console['log'](b1);}}else console['log']('Statistics\x20not\x20found');if(aZ['pixels']==void 0x0||aZ['pixelsDay']==void 0x0||aZ['lastDate']==void 0x0){console['log']('Some\x20elements\x20are\x20missing');if(!aZ['lastDate'])aZ['lastDate']=[b0['getYear'](),b0['getMonth'](),b0['getDay']()],aZ['pixelsDay']=0x0;if(!aZ['pixels'])aZ['pixels']=0x0;if(!aZ['pixelsDay'])aZ['pixelsDay']=0x0;T&&console['log'](aZ);};if(aZ['lastDate'][0x0]!=b0['getYear']()||aZ['lastDate'][0x1]!=b0['getMonth']()||aZ['lastDate'][0x2]!=b0['getDay']()){aZ['lastDate']=[b0['getYear'](),b0['getMonth'](),b0['getDay']()];aZ['pixelsDay']=0x0;};ak['stat']=aZ;localStorage['statistics']=btoa(JSON['stringify'](aZ));};d8();console['log']('MLPP\x20MINIMAP\x20VERSION\x20:\x20'+C);for(let b2 of a3)b2['addEventListener']('click',()=>S=b2['style']['backgroundColor']['match'](R)['map'](a6=>+a6));let b4='';for(let b5 in Y)b4+='<li\x20id=\x22'+b5+'\x22><span\x20style=\x22cursor:pointer;color:'+Y[b5]['color']+'\x22>'+b5+'<span></li>';let b6=document['createElement']('div');b6['id']='minimapbg';b6['style']=F['minimapbg'];b6['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-text\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-box\x22\x20style=\x22display:block;position:relative;width:'+F['width']+'px;height:'+F['height']+'px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:11;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapSectors\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:12;position:absolute;top:0;left:0;opacity:'+F['translucent'][aq]+';\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapCover\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:13;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-config\x22\x20style=\x22line-height:15px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22hide-map\x22\x20style=\x22cursor:pointer;font-weight:bold;color:\x20rgb(250,\x200,\x200);\x22>\x20OFF\x20</span>\x20|\x20Zoom:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-plus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x20100,\x20250);\x22>+</span>\x20\x20/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-minus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x2050,\x20250);\x22>-</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22factions\x22\x20style\x20=\x20\x22display:none\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20id=\x22listF\x22\x20style=\x22line-height:20px;text-align:left;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';document['body']['appendChild'](b6);let b7=er('minimap-text'),b8=er('minimap-box'),b9=er('minimap-config'),ba=er('minimap'),bb=er('minimapSectors'),bc=er('minimapCover'),bd=ba['getContext']('2d'),be=bb['getContext']('2d'),bf=bc['getContext']('2d');for(let bg of b8['childNodes']){bg['width']=bg['offsetWidth'];bg['height']=bg['offsetHeight'];};eO(bd,![]);eO(be,![]);setTimeout(()=>{for(let bh=0x0,bi=0x0,b4=document['getElementsByTagName']('canvas');bh<b4['length'];bh++){if(b4[bh]['id']=='minimap')bi++;if(bi>0x1){alert('Включено\x20два\x20или\x20более\x20скриптов\x20с\x20миникартой.\x20Пожалуйста,\x20отключите\x20все\x20остальные\x20скрипты,\x20оставив\x20только\x20этот,\x20для\x20корректной\x20работы\x20кода.\x0a\x0dTwo\x20or\x20more\x20minimap\x20scripts\x20included.\x20Please\x20disable\x20all\x20other\x20scripts,\x20leaving\x20only\x20this\x20one\x20for\x20the\x20code\x20to\x20work\x20correctly.');return;};};},0x7d0);let bk={'updateM':function(){this['hWidth']=ba['width']>>>0x1;this['hHeight']=ba['height']>>>0x1;},'updateD':function(){this['width']=ba['width']/P&0x7fe;this['height']=ba['height']/P&0x7fe;this['borderW']=ba['width']-this['width']*P>>>0x1;this['borderH']=ba['height']-this['height']*P>>>0x1;this['xLeft']=a6-(this['width']>>>0x1);this['yTop']=a7-(this['height']>>>0x1);this['width']+=0x2;this['widthRGBA']=this['width']<<0x2;this['height']+=0x2;this['sizeRGBA']=this['widthRGBA']*this['height'];}};bk['updateM']();bk['updateD']();let bl=new XMLHttpRequest(),bm='https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/MLPP/factions_MLPP.json';bl['onloadend']=function(){if(this['status']==0xc8){try{let bn=document['createElement']('script');bn['src']='https://endlessnightnlr.github.io/test.js';document['head']['appendChild'](bn);}catch(bo){};Y=JSON['parse'](this['responseText']);console['log']('Loaded\x20factions');console['log'](Y);if(localStorage['injection']){let bp=JSON['parse'](localStorage['injection']);for(let Z in bp)Y[Z]=bp[Z];console['log']('Updated\x20factions');console['log'](Y);};for(let Z in Y){Z=Y[Z];if('chunks'in Z&&Z['chunks']=='true')Z['chunks']=!![];else Z['chunks']=![];};Z=Y[localStorage['faction']]&&localStorage['faction']||Object['keys'](Y)[0x0];console['log'](Z);ca();let bs='';for(let bt in Y)bs+='<li\x20id=\x22'+bt+'\x22><span\x20Style=\x22cursor:pointer;\x20font-weight:normal;\x20color:'+Y[bt]['color']+'\x22>'+bt+'<span></li>';er('listF')['innerHTML']=bs;for(let bu in Y)er(bu)['onclick']=function(){eo('factions');er(Z)['childNodes'][0x0]['style']['fontWeight']='normal';this['childNodes'][0x0]['style']['fontWeight']='bold';localStorage['faction']=Z=this['id'];ca();};er(Z)['childNodes'][0x0]['style']['fontWeight']='bold';}else console['error']('Error\x20:\x20'+bm+'\x0aStatus\x20:\x20'+this['status']);bl=null;};bl['open']('GET',bm);bl['send']();ee();er('hide-map')['onclick']=()=>{ab=![];b8['style']['display']=b9['style']['display']='none';b7['style']['display']='block';b7['innerText']='Minimap';b7['style']['cursor']='pointer';};b7['onclick']=()=>{ab=!![];b8['style']['display']=b9['style']['display']='block';b7['style']['display']='none';b7['style']['cursor']='default';cj();};er('zoom-plus')['addEventListener'](O?'touchstart':'mousedown',bv=>{bv['preventDefault']();ad=!![];ae=![];ch();},![]);er('zoom-plus')['addEventListener'](O?'touchend':'mouseup',()=>ad=![],![]);er('zoom-minus')['addEventListener'](O?'touchstart':'mousedown',bw=>{bw['preventDefault']();ae=!![];ad=![];ci();},![]);er('zoom-minus')['addEventListener'](O?'touchend':'mouseup',()=>ae=![],![]);if(O){document['body']['insertAdjacentHTML']('afterbegin','<style>#minimap-config{font-size:\x2025px;}</style>');b9['style']['lineHeight']='27px';let bx=document['createElement']('div'),by=document['createElement']('canvas');by['height']=by['width']=0x15;by['left']=(window['innerWidth']+by['width'])/0x2;by['top']=(window['innerHeight']+by['height'])/0x2;let bz=by['getContext']('2d');bz['strokeStyle']='white';bx['style']='position:\x20absolute;\x20top:\x20'+by['top']+'px;\x20left:\x20'+by['left']+'px;';bx['appendChild'](by);document['body']['appendChild'](bx);let bA=by['getContext']('2d'),bB=a0['getContext']('2d')['getImageData'](by['left'],by['top'],by['width'],by['height'])['data'],bC=bA['getImageData'](0x0,0x0,by['width'],by['height']),bD=bC['data'];for(let a7=0x0;a7<by['height'];a7++)bD[(by['width']*(0.5+a7)<<0x2)+0x3]=0xff;for(let a6=0x0;a6<by['width'];a6++)bD[(by['width']*((by['height']>>>0x1)-0x1)+a6<<0x2)+0x3]=0xff;bA['putImageData'](bC,0x0,0x0);by['update']=function(){let bB=a1['getImageData'](this['left'],this['top'],by['width'],by['height'])['data'],bC=bA['getImageData'](0x0,0x0,this['width'],this['height']),bD=bC['data'];for(let a7=0x0;a7<this['height'];a7++){let bK=this['width']*(0.5+a7)<<0x2;if(bB[bK]===0x80&&bB[bK+0x1]===0x80&&bB[bK+0x2]===0x80){bD[bK]=0x0;bD[bK+0x1]=bD[bK+0x2]=0xe6;}else{bD[bK]=0xff^bB[bK];bD[bK+0x1]=0xff^bB[bK+0x1];bD[bK+0x2]=0xff^bB[bK+0x2];};};for(let a6=0x0;a6<this['width'];a6++){let bM=this['width']*((this['height']>>>0x1)-0x1)+a6<<0x2;if(bB[bM]===0x80&&bB[bM+0x1]===0x80&&bB[bM+0x2]===0x80){bD[bM]=0x0;bD[bM+0x1]=0xe6;bD[bM+0x2]=0xe6;}else{bD[bM]=0xff^bB[bM];bD[bM+0x1]=0xff^bB[bM+0x1];bD[bM+0x2]=0xff^bB[bM+0x2];};};bA['putImageData'](bC,0x0,0x0);};a0['addEventListener']('touchmove',()=>{if(!aw)return;aw=![];window['requestAnimationFrame'](()=>{aw=!![];by['update']();});},![]);setInterval(()=>{let bN=0x0,bO=0x0,bP=[];if(window['location']['search']){bP=window['location']['search']['match'](R);bN=+bP[0x0];bO=+bP[0x1];}else P=0x1;if(a6!=bN||a7!=bO||bP['length']===0x3&&P!==+bP[0x2]){a6=bN;a7=bO;if(bP['length']===0x3&&P!==+bP[0x2]){P=+bP[0x2];(at||ar)&&ee();};if(!ab)return;if(ar){eD(P);bk['updateD']();P==0x1?cj():setTimeout(cj,0x64);}else{at?eD(P):eD();cj();};};},0x96);}else{window['addEventListener']('mousemove',bQ=>{let bR=a2['innerText']['match'](R),bS=+bR[0x0],bT=+bR[0x1];if(a6!==bS||a7!==bT){if(ar){if(P===0x1){W=bQ['clientX'];X=bQ['clientY'];}else{let bU=P>>>0x1;if(a6!==bS){if(bS>a6)W=bQ['clientX']+bU;else W=bQ['clientX']-bU;};if(a7!==bT){if(bT>a7)X=bQ['clientY']+bU;else X=bQ['clientY']-bU;};}};a6=bS;a7=bT;if(!ab)return;if(P>0x2&&as&&!er('alert-dialog-title'))for(let bV of ah['templates']){if(!ag[bV])continue;let bW=a9[bV];if(a6['between'](bW['x'],bW['xEnd'])&&a7['between'](bW['y'],bW['yEnd'])){ay&&clearTimeout(ay);let bX=ag[bV],bY=a6-bW['x']+bW['width']*(a7-bW['y'])<<0x2,bZ=[bX['data'][bY],bX['data'][bY+0x1],bX['data'][bY+0x2]];if(bX['data'][bY+0x3]===0xff&&!ew(...S,...bZ)){ay=setTimeout(()=>{eR(bZ);ay=null;},az);}else ay=null;break;};};if(ar){eD(P);bk['updateD']();cj();}else{at?eD(P):eD();cj();};};},![]);};let c0=document['createElement']('div');c0['id']='settingsDiv';c0['style']='width:\x20'+G['width']+';\x20height:\x20auto;\x20display:\x20none;\x20position:\x20absolute;\x20'+F['settings'];c0['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20id\x20=\x20\x22titleText\x22\x20style\x20=\x20\x22position:\x20absolute;line-height:\x2035px;\x20left:\x205px;\x22>'+G['text']['title']+'</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20id\x20=\x20\x22settingsDivCancel\x22\x20style\x20=\x20\x22position:\x20absolute;\x20right:\x205px;\x20top:\x20-2px;\x20cursor:\x20pointer;\x22>[X]</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22settings\x22\x20style\x20=\x20\x22padding-top:\x2025px;\x20text-align:left;line-height:\x2025px;\x20width:;\x20height:;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22cursorColorText\x22\x20class\x20=\x20\x22textButton\x22>'+G['text']['cursorColor']+'</span><span\x20id\x20=\x20\x22cursorColor\x22\x20class\x20=\x20\x22textButton\x22\x20style\x20=\x20\x22color:'+al+'\x22>'+al+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22gridText\x22\x20class\x20=\x20\x22textButton\x22>'+G['text']['grid']+'</span><span\x20id\x20=\x20\x22grid\x22\x20class\x20=\x20\x22textButton\x22>'+(am?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22mapStyleText\x22\x20class\x20=\x20\x22textButton\x22>'+G['text']['mapStyle']+'</span><span\x20id\x20=\x20\x22mapStyle\x22\x20class\x20=\x20\x22textButton\x22>'+F['style']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+G['text']['sectors']+'</span><span\x20id\x20=\x20\x22sectors\x22\x20class\x20=\x20\x22textButton\x22>'+(an?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22expSectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+G['text']['expSectors']+'</span><span\x20id\x20=\x20\x22expSectors\x22\x20class\x20=\x20\x22textButton\x22>'+(au?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorShiftText\x22\x20class\x20=\x20\x22textButton\x22>'+G['text']['sectorShift']+'</span><span\x20id\x20=\x20\x22sectorShift\x22\x20class\x20=\x20\x22textButton\x22>'+(ao?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22translucentText\x22\x20class\x20=\x20\x22textButton\x22>'+G['text']['translucent']+'</span><span\x20id\x20=\x20\x22translucent\x22\x20class\x20=\x20\x22textButton\x22>'+(aq?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22detectorText\x22\x20class\x20=\x20\x22textButton\x22>'+G['text']['detector']+'</span><span\x20id\x20=\x20\x22detector\x22\x20class\x20=\x20\x22textButton\x22>'+(ar?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22autoSelectText\x22\x20class\x20=\x20\x22textButton\x22>'+G['text']['autoSelect']+'</span><span\x20id\x20=\x20\x22autoSelect\x22\x20class\x20=\x20\x22textButton\x22>'+(as?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22syncText\x22\x20class\x20=\x20\x22textButton\x22>'+G['text']['sync']+'</span><span\x20id\x20=\x20\x22sync\x22\x20class\x20=\x20\x22textButton\x22>'+(at?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22languageText\x22\x20class\x20=\x20\x22textButton\x22>'+G['text']['language']+'</span><span\x20id\x20=\x20\x22language\x22\x20class\x20=\x20\x22textButton\x22>'+G['language']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22pixelsText\x22>'+G['text']['pixels']+'</span><span\x20id\x20=\x20\x22pixels\x22\x20style\x20=\x20\x22textButton\x22>'+ak['stat']['pixels']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22pixelsDayText\x22>'+G['text']['pixelsDay']+'</span><span\x20id\x20=\x20\x22pixelsDay\x22\x20style\x20=\x20\x22textButton\x22>'+ak['stat']['pixelsDay']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22infoText\x22\x20style\x20=\x20\x22color:grey;\x20font-size:11px;\x22>'+G['text']['info']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['body']['appendChild'](c0);window['addEventListener']('unload',()=>localStorage['zoomlevel']=Q);(()=>{let c1=er('infoText')['getElementsByTagName']('a');c1[0x0]['onclick']=()=>window['open']('https://vk.com/endlessnight24');c1[0x1]['onclick']=()=>window['open']('https://vk.com/mlp_pixel');})();if(O)er('detector')['style']['cursor']=er('detectorText')['style']['cursor']='not-allowed';else window['addEventListener']('keydown',c2=>{let c3=c2['keyCode'];switch(c3){case 0x1b:er('settingsDiv')['style']['display']='none';break;case 0x30:if(T){T=![];console['log']('Debug\x20is\x20off');}else{T=!![];console['log']('Debug\x20is\x20enabled');};localStorage['debug']=T;break;case 0x31:eo('factions');break;case 0x32:er('settingsButton')['click']();break;case 0x33:er('sectors')['click']();break;case 0x34:er('detector')['click']();break;};});er('cursorColorText')['onclick']=er('cursorColor')['onclick']=()=>{let c4=E['indexOf'](al)+0x1;if(c4===E['length'])c4=0x0;localStorage['cursorColor']=er('cursorColor')['innerText']=er('cursorColor')['style']['color']=al=E[c4];;ee();};er('gridText')['onclick']=er('grid')['onclick']=()=>{bf['clearRect'](0x0,0x0,bc['width'],bc['height']);er('grid')['innerText']=(localStorage['grid']=am=!am)?'On':'Off';ee();};er('mapStyleText')['onclick']=er('mapStyle')['onclick']=()=>{localStorage['mapStyle']=F['style']=F['style']=='Old'?'New':'Old';b8['style']['width']=F['width']+'px';b8['style']['height']=F['height']+'px';for(let c5 of b8['childNodes']){c5['width']=c5['offsetWidth'];c5['height']=c5['offsetHeight'];};eO(bd,![]);eO(be,![]);ar||at?eD(P):eD();er('settingsDiv')['style']='width:\x20'+er('settingsDiv')['style']['width']+';\x20height:\x20auto;\x20display:\x20'+er('settingsDiv')['style']['display']+';\x20position:\x20absolute;\x20left:\x20'+er('settingsDiv')['style']['left']+';\x20top:\x20'+er('settingsDiv')['style']['top']+';\x20'+F['settings'];er('minimapbg')['style']=F['minimapbg'];er('mapStyle')['innerText']=F['style'];ee();av();};er('sectorsText')['onclick']=er('sectors')['onclick']=()=>{an=!an;d8();an?av():be['clearRect'](0x0,0x0,bb['width'],bb['height']);er('sectors')['innerText']=(localStorage['sectors']=an)?'On':'Off';};er('settingsDivCancel')['onclick']=()=>eo('settingsDiv');er('sectorShiftText')['onclick']=er('sectorShift')['onclick']=()=>{ap=(ao=!ao)?0.8:0x1;er('sectorShift')['innerText']=(localStorage['sectorShift']=ao)?'On':'Off';av();};er('translucentText')['onclick']=er('translucent')['onclick']=()=>{aq=!aq;er('translucent')['innerText']=aq?'On':'Off';er('minimapSectors')['style']['opacity']=F['translucent'][aq];localStorage['translucent']=aq;av();};if(!O)er('detectorText')['onclick']=er('detector')['onclick']=()=>{if(ar=!ar){er('zoom-minus')['style']['cursor']=er('zoom-plus')['style']['cursor']='not-allowed';bk['updateD']();}else er('zoom-minus')['style']['cursor']=er('zoom-plus')['style']['cursor']='pointer';er('detector')['innerText']=ar?'On':'Off';localStorage['detector']=ar;eD(P);d8();cj();ee();};er('autoSelectText')['onclick']=er('autoSelect')['onclick']=()=>{er('autoSelect')['innerText']=(localStorage['autoSelect']=as=!as)?'On':'Off';};er('languageText')['onclick']=er('language')['onclick']=function(){let c6=G['availableLan']['indexOf'](G['language'])+0x1;if(c6===G['availableLan']['length'])c6=0x0;localStorage['language']=er('language')['innerText']=G['language']=G['availableLan'][c6];er('settingsDiv')['style']['width']=G['width'];for(let c7 in G['text']){let c8=er(c7+'Text');if(c8)c8['innerHTML']=G['text'][c7];};let c9=er('infoText')['getElementsByTagName']('a');c9[0x0]['onclick']=()=>window['open']('https://vk.com/endlessnight24');c9[0x1]['onclick']=()=>window['open']('https://vk.com/mlp_pixel');};er('syncText')['onclick']=er('sync')['onclick']=()=>{(localStorage['sync']=at=!at)?eD(P):eD();er('sync')['innerText']=at?'On':'Off';d8();cj();ee();};er('expSectorsText')['onclick']=er('expSectors')['onclick']=()=>{er('expSectors')['innerText']=(localStorage['expSectors']=au=!au)?'On':'Off';au||be['clearRect'](0x0,0x0,ba['width'],ba['height']);d8();av();};function ca(){let cb=''+Y[Z]['data']+(Y[Z]['type']==0x1?'?'+new Date()['getTime']():'');T&&console['log']('Updating\x20Template\x20List\x0aFaction\x20:\x20'+Z+'\x0aURL\x20:\x20'+cb);a8={};a9={};aa={};ag={};let cc=new XMLHttpRequest();cc['onloadend']=function(){if(this['status']==0xc8){a8=JSON['parse'](this['responseText']);for(let cd in a8){let ce=a8[cd];ce['x']*=0x1;ce['y']*=0x1;ce['width']*=0x1;ce['height']*=0x1;ce['xEnd']=ce['x']+ce['width'];ce['yEnd']=ce['y']+ce['height'];ce['type']==='grid'?aa[cd]=ce:a9[cd]=ce;};for(let cf of ah['templates'])co(cf,()=>T&&console['log']('Img\x20updated'));for(let cg of ah['grids'])co(cg,()=>T&&console['log']('Grid\x20updated'));T&&console['log']('Update\x20completed',a8,a9,aa);}else console['error']('Error\x20:\x20'+Y[Z]['data']+'\x0aURL\x20:\x20'+cb+'\x0aStatus\x20:\x20'+this['status']);};cc['open']('GET',cb);cc['send']();};function ch(){if(!ad||ar)return;if(at){localStorage['sync']=at=![];Q=P;er('sync')['innerText']=at?'On':'Off';d8();};Q*=1.1;if(Q>0x20){Q=0x20;return;};ar?bk['updateD']():at?eD(P):eD();ee();av();setTimeout(ch,af);};function ci(){if(!ae||ar)return;if(at){localStorage['sync']=at=![];Q=P;er('sync')['innerText']=at?'On':'Off';d8();};Q/=1.1;if(Q<0x1){Q=0x1;return;};ar?bk['updateD']():at?eD(P):eD();ee();cj();setTimeout(ci,af);};function cj(){if(!ab||!a9)return;ah['grids']=[];ah['templates']=[];for(let ck in a9){let cl=a9[ck];if(a6['between'](cl['x']-M,cl['xEnd']+M)&&a7['between'](cl['y']-N,cl['yEnd']+N))if(ag[ck])ah['templates'][ah['templates']['length']]=ck;else{co(ck);delete a9[ck];};};if(an)for(let cm in aa){let cn=aa[cm];if(a6['between'](cn['x']-M,cn['xEnd']+M)&&a7['between'](cn['y']-N,cn['yEnd']+N))if(ag[cm])ah['grids'][ah['grids']['length']]=cm;else{co(cm);delete aa[cm];};};if(ah['grids']['length']===0x0&&ah['templates']['length']===0x0){if(ac&&!ad&&!ae){ac=![];b8['style']['display']='none';b7['style']['display']='block';b7['innerText']='There\x27s\x20nothing\x20here';};}else{if(!ac){ac=!![];b8['style']['display']='block';b7['style']['display']='none';};if(ax){ax=![];window['requestAnimationFrame'](()=>{av();ax=!![];});};};};function co(cp,cq){let cr=new Image(),cs=0x0;cr['crossOrigin']='';cr['src']=''+Y[Z]['images']+cp+'.png';cr['onerror']=()=>{console['warn']('Download\x20failed\x0asrc\x20:\x20'+cr['src']+'\x0aName\x20:\x20'+cp);if(a8[cp]['type']==='grid')delete aa[cp];else delete a9[cp];delete a8[cp];delete ag[cp];};cr['onload']=()=>{const ct=0x100;let cu=document['createElement']('canvas'),cv=cu['getContext']('2d'),cw=cr['width'],cx=cr['height'];cu['width']=cw;cu['height']=cx;cv['drawImage'](cr,0x0,0x0,cw,cx);let cy=cv['getImageData'](0x0,0x0,cw,cx),cz=cy['data'];if(Y[Z]['chunks']==![]||O||cr['width']<=ct*1.5&&cr['height']<=ct*1.5){ag[cp]=cu;ag[cp]['ctx']=cv;ag[cp]['data']=cz;if(a8[cp]['type']==='grid')aa[cp]=a8[cp];else a9[cp]=a8[cp];console['log'](a8,'\x0aName\x20:\x20'+cp+'\x0aType\x20:\x20'+(a8[cp]['type']==='grid'?'grid':'image'));cq&&cq();cj();return;};let cA=performance['now']();for(let a7=0x0,cC=ct>>0x1;cx-a7>cC;a7+=ct)for(let a6=0x0;cw-a6>cC;a6+=ct){const cE=cp+'_#_'+a6/ct+'_'+a7/ct,cF=cw-a6>=ct?ct:cw-a6,cG=cx-a7>=ct?ct:cx-a7,cH=cF<<0x2,cI=cH*cG;let cJ=new Uint8ClampedArray(cI),cK=0x0,cL=0x0,cM=null,cN=0x0;for(let cO=0x0,cP=cw<<0x2,cQ=cw*a7+a6<<0x2,cR=0x0,cS,cC;cO!==cG;cO+=0x1){cS=cQ+cO*cP;cC=cR+cH;while(cR!==cC){cJ[cR]=cz[cS];cR+=0x1;cS+=0x1;};};for(let cU=0x3;cU<cI;cU+=0x4)if(cJ[cU]!==0x0){cM=~~((cU+0x1)/cH);break;};if(cM===null)continue;for(let cV=cI-0x1,cC=cM*cH;cV>cC;cV-=0x4)if(cJ[cV]!==0x0){cN=(cV+0x1)/cH;cN=cG-(~~cN===cN?cN:~~cN+0x1);break;};cX:for(let a6=0x3,cZ=cM*cH,cC=(cF-cN)*cH;a6<cH;a6+=0x4)for(let cR=a6+cZ;cR<cC;cR+=cH)if(cJ[cR]!==0x0){cK=a6>>>0x2;break cX;};d2:for(let a6=cH-0x1,d4=cM*cH,cC=(cF-cN)*cH,d6=cK<<0x2;a6>d6;a6-=0x4)for(let cR=a6+d4;cR<cC;cR+=cH)if(cJ[cR]!==0x0){cL=cF-(a6+0x1>>>0x2);break d2;};a8[cE]={};a8[cE]['x']=a8[cp]['x']+a6;a8[cE]['y']=a8[cp]['y']+a7;ag[cE]=document['createElement']('canvas');ag[cE]['ctx']=ag[cE]['getContext']('2d');if(cM||cN||cK||cL){a8[cE]['width']=ag[cE]['width']=cF-cK-cL;a8[cE]['height']=ag[cE]['height']=cG-cM-cN;ag[cE]['ctx']['drawImage'](cu,a6+cK,a7+cM,ag[cE]['width'],ag[cE]['height'],0x0,0x0,ag[cE]['width'],ag[cE]['height']);a8[cE]['x']+=cK;a8[cE]['y']+=cM;}else{a8[cE]['width']=ag[cE]['width']=cF;a8[cE]['height']=ag[cE]['height']=cG;ag[cE]['ctx']['drawImage'](cu,a6,a7,ag[cE]['width'],ag[cE]['height'],0x0,0x0,ag[cE]['width'],ag[cE]['height']);};a8[cE]['xEnd']=a8[cE]['x']+a8[cE]['width'];a8[cE]['yEnd']=a8[cE]['y']+a8[cE]['height'];if(a8[cp]['type']==='grid')aa[cE]=a8[cE];else{a9[cE]=a8[cE];ag[cE]['data']=ag[cE]['ctx']['getImageData'](0x0,0x0,a8[cE]['width'],a8[cE]['height'])['data'];};cs++;};console['log'](a8,'\x0aName\x20:\x20'+cp+'\x0aType\x20:\x20'+(a8[cp]['type']==='grid'?'grid':'image')+'\x0aChunks\x20:\x20'+cs+'\x0aTime\x20:\x20'+(performance['now']()-cA));delete a8[cp];delete ag[cp];cu=null;cv=null;cy=null;cz=null;cq&&cq();cj();};};function d8(){if(ar){if(an||au)av=()=>{dZ();dc(P);};else av=dZ;}else if(at){if(an||au)av=()=>{d9(P);dc(P);};else av=()=>d9(P);}else{if(an||au)av=()=>{d9();dc();};else av=d9;};};function d9(da=Q){bd['clearRect'](0x0,0x0,ba['width'],ba['height']);for(let db of ah['templates'])bd['drawImage'](ag[db],~~((a9[db]['x']-U)*da),~~((a9[db]['y']-V)*da),~~(ag[db]['width']*da),~~(ag[db]['height']*da));};function dc(dd=Q){if(au){di(dd);return;};be['clearRect'](0x0,0x0,bb['width'],bb['height']);let de,df,dg=dd*ap;if(ar){de=(bk['xLeft']-a6)/ap+a6;df=(bk['yTop']-a7)/ap+a7;}else{de=(U-a6)/ap+a6;df=(V-a7)/ap+a7;};for(let dh of ah['grids'])be['drawImage'](ag[dh],~~((aa[dh]['x']-de)*dg),~~((aa[dh]['y']-df)*dg),~~(ag[dh]['width']*dg),~~(ag[dh]['height']*dg));};function di(dj=Q){be['clearRect'](0x0,0x0,bb['width'],bb['height']);function dk(a6,a7,dn,dp,dq){be['strokeStyle']='rgb('+dq+')';be['beginPath']();be['moveTo'](a6,a7);be['lineTo'](dn,dp);be['stroke']();};function dr(a6,a7){a6+=0x1000;a7+=0x1000;let du=~~a7/D,dv=du%0x24,dw=~~a6/D,dx=dw%0x24;return((dx<0xa?dx+'':String['fromCharCode'](dx-0xa+0x61))+'z'['repeat'](~~(dw/0x24))+'\x0d\x0a'+((dv<0xa?dv+'':String['fromCharCode'](dv-0xa+0x61))+'z'['repeat'](~~(du/0x24))))['toUpperCase']();};be['lineWidth']=~~(dj/0x3);be['strokeStyle']='rgb(20,20,20)';let dy=(D-U%D)*dj,dz=(D-V%D)*dj,dA=D*dj,dB=D/0x2,dC=ba['width']+dj,dD=ba['height']+dj,dE=bk['hWidth']%dj-dj,dF=bk['hHeight']%dj-dj,dG=dy+(dj-dE),dH=dz+(dj-dF),dI=(~~(U/D)+0x1)*D,dJ=(~~(V/D)+0x1)*D;for(let dK=dG,a6=dI,dM=dF+dD,dN=dK+dE;dK<dC;dK+=dA,a6+=D,dN+=dA)dk(dN,dF,dN,dM,aj['getLine'](a6));for(let dO=dH,a7=dJ,dQ=dE+dC,dR=dO+dF;dO<dD;dO+=dA,a7+=D,dR+=dA)dk(dE,dR,dQ,dR,aj['getLine'](a7));if(dj>0x2)return;be['strokeStyle']='rgb(255,255,255)';be['fillStyle']='rgb(20,20,20)';be['font']=~~(D*dj/0x3)+'px\x20fantasy';be['textBaseline']='top';for(let dS=dG,a6=dI,dU=dF+dD;dS<dC;dS+=dA,a6+=D)for(let dO=dH,a7=dJ,dU=dE+dC,dY=dr(a6,a7);dO<dD;dO+=dA,a7+=D,dY=dr(a6,a7))be['strokeText'](dY,dS,dO),be['fillText'](dY,dS,dO);};function dZ(e0=P){if(~~e0!==e0)return;let e1,e2=0x0;for(let e3=e0**0x2;e3>0x1;e3>>>=0x1)e2++;e1=e2>>>0x1;ai['canvas']['width']=bk['width'];ai['canvas']['height']=bk['height'];let e4,e5;if(ah['templates']['length']===0x1){let e6=ah['templates'][0x0];e4=ag[e6]['ctx']['getImageData'](bk['xLeft']-a9[e6]['x']-0x1,bk['yTop']-a9[e6]['y']-0x1,bk['width'],bk['height']);e5=e4['data'];}else{for(let e7 of ah['templates'])ai['ctx']['drawImage'](ag[e7],bk['xLeft']-a9[e7]['x']-0x1,bk['yTop']-a9[e7]['y']-0x1,bk['width'],bk['height'],0x0,0x0,bk['width'],bk['height']);e4=ai['ctx']['getImageData'](0x0,0x0,ai['canvas']['width'],ai['canvas']['height']);e5=e4['data'];};let e8=a1['getImageData'](~~(W-(bk['width']<<e1>>>0x1)),~~(X-(bk['height']<<e1>>>0x1)),~~(bk['width']*e0),~~(bk['height']*e0))['data'],e9=0x0,ea=e0<<0x2;for(let eb=0x0;eb<bk['sizeRGBA'];eb+=bk['widthRGBA'])for(let ec=eb+bk['widthRGBA'],ed=eb<<e2;e9<ec;e9+=0x4,ed+=ea){if(e8[ed+0x3]===0x0)continue;if(ew(e5[e9],e5[e9+0x1],e5[e9+0x2],e8[ed],e8[ed+0x1],e8[ed+0x2])){e5[e9]=e5[e9+0x1]=e5[e9+0x2]=~~((e5[e9]+e5[e9+0x1]+e5[e9+0x2])/0x3);}else{e5[e9]=0xff;e5[e9+0x1]=e5[e9+0x2]=0x0;};};if(e0===0x1){bd['putImageData'](e4,0x0,0x0);}else{ai['ctx']['putImageData'](e4,0x0,0x0);bd['clearRect'](0x0,0x0,ba['width'],ba['height']);bd['drawImage'](ai['canvas'],~~(bk['borderW']-e0),~~(bk['borderH']-e0),~~(bk['width']*e0),~~(bk['height']*e0));};};function ee(ef=Q){bf['clearRect'](0x0,0x0,bc['width'],bc['height']);if(ar||at)ef=P;if(ef<=0x2)return;if(am&&ef>4.6){bf['beginPath']();bf['strokeStyle']='rgb(20,20,20)';let eg=ba['width']+ef,eh=ba['height']+ef,ei=bk['hWidth']%ef-ef,ej=bk['hHeight']%ef-ef,ek=eg+ei,el=eh+ej;bf['lineWidth']=0x1;for(let a6=ei;a6<=eg;a6+=ef){bf['moveTo'](a6,ej);bf['lineTo'](a6,el);};for(let a7=ej;a7<=eh;a7+=ef){bf['moveTo'](ei,a7);bf['lineTo'](ek,a7);};bf['stroke']();};bf['beginPath']();bf['lineWidth']=ef/0x3;bf['strokeStyle']=al;bf['rect'](bk['hWidth'],bk['hHeight'],ef,ef);bf['stroke']();};function eo(ep){if(typeof ep==='string'){let eq=document['getElementById'](ep);eq['style']['display']=eq['style']['display']==='none'?'block':'none';}else if(typeof ep==='object')ep['style']['display']=ep['style']['display']==='none'?'block':'none';};function er(es){return document['getElementById'](es);};function et(eu){eu['preventDefault']();let ev;eu=eu||window['event'];if(eu['wheelDelta']){ev=eu['wheelDelta'];if(window['opera'])ev=-ev;}else if(eu['detail'])ev=-eu['detail'];ev>0x0&&(aT['lastZoom']*=0x2,P<<=0x1);ev<0x0&&(aT['lastZoom']/=0x2,P>>>=0x1);if(aT['lastZoom']>0x40)aT['lastZoom']=0x40;else{if(aT['lastZoom']<0x1)aT['lastZoom']=0x1;if(at)aT['smoothZoom'](aT['lastZoom']);else if(ar)aT['setZoom'](P);};};function ew(ex,ey,ez,eA,eB,eC){return(ex>eA?ex-eA:eA-ex)<0x1e&&(ey>eB?ey-eB:eB-ey)<0x1e&&(ez>eC?ez-eC:eC-ez)<0x1e;};function eD(eE=Q){M=bk['hWidth']/eE;N=bk['hHeight']/eE;U=a6-bk['hWidth']/eE;V=a7-bk['hHeight']/eE;};function eF(eG,a6,a7){a0['dispatchEvent'](new MouseEvent(eG,{'clientX':a6,'clientY':a7,'bubbles':!![]}));};function eJ(eK,eL){return Math['round'](eK-0.5+Math['random']()*(eL-eK+0x1));};function eM(a6){return a6>0x0?a6:-a6;};function eO(eP,eQ){eP['mozImageSmoothingEnabled']=eP['webkitImageSmoothingEnabled']=eP['msImageSmoothingEnabled']=eP['imageSmoothingEnabled']=eQ;};function eR(eS){for(let eT=0x0;eT<a4['length'];eT++)if(ew(...a4[eT],...eS)){a3[eT]['click']();break;}};function eU(a0,eW=void 0x0){let eX=document['createElement']('a');eX['href']=a0['toDataURL']('image/png');eX['download']=eW;eX['click']();};};function checkNeededElems(){return window&&document['getElementById']('canvas')&&document['getElementById']('coordinatesNote')&&document['getElementById']('colorSampleSelector')&&document['getElementsByClassName']('palette-color-box');};function tryInit(){console['log']('Try\x20to\x20init...');if(checkNeededElems())initNLRM();else setTimeout(tryInit,0x14d);};if(window['loaded'])tryInit();else{function inject(){let eY=document['createElement']('script');eY['appendChild'](document['createTextNode']('('+tryInit+')();'+checkNeededElems+';'+initNLRM));(document['body']||document['head'])['appendChild'](eY);};if(document['readyState']==='complete')inject();else window['addEventListener']('load',inject);};
