// ==UserScript==
// @name         MLP Pixel Minimap
// @version      2.6.9.5
// @description  My Little Pony Pixel (MLP Pixel) Minimap for PixelZone.io
// @author       Endless Night
// @include      *://pixelzone.io/*
// @homepage     https://github.com/EndlessNightNLR
// @updateURL    https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// @downloadURL  https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// ==/UserScript==
//
// To the glory of Luna and the New Lunar Republic!
function initNLRM(){'use strict';//PZ CHANGES
(function specialFirst(){let c=dQ('timer');if(c)c['style']['z-index']=0x13;else setTimeout(specialFirst,0x14d);}());(function specialSecond(){let d=dQ('message');if(d)d['remove']();else setTimeout(specialSecond,0x14d);}());let e=document['createElement']('link');e['rel']='stylesheet';e['href']='https://endlessnightnlr.github.io/MLPP/style.css';document['head']['appendChild'](e);let f=document['createElement']('div');f['style']='position:\x20absolute;\x20left:\x200px;\x20top:\x2057px;\x20margin:\x20-2px\x200px\x200px\x20-2px;';f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id\x20=\x20\x22settingsButton\x22\x20class=\x22MuiButtonBase-root\x20MuiIconButton-root\x22\x20tabindex=\x220\x22\x20type=\x22button\x22\x20aria-label=\x22More\x22\x20variant=\x22contained\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiIconButton-label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tr-bg\x22\x20style=\x22width:\x2025px;\x20height:\x2025px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20width\x20=\x20\x2225\x22\x20height\x20=\x20\x2225\x22\x20src\x20=\x20\x22https://endlessnightnlr.github.io/MLPP/gear.png\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</img>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiTouchRipple-root\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';document['body']['appendChild'](f);dQ('settingsButton')['addEventListener']('click',()=>{let g=dQ('settingsDiv');dN(g);if(g['style']['display']==='block'){g['style']['left']=(window['innerWidth']-g['offsetWidth']>>>0x1)+'px';g['style']['top']=(window['innerHeight']-g['offsetHeight']>>>0x1)+'px';};});Number['prototype']['between']=function(h,i){return this>h&&this<i;};window['testPerformance']=()=>{console['log']('Start\x20testing');let j=null,k=!![],l=L['width']>>>0x1,m=L['height']>>>0x1;setTimeout(()=>clearInterval(j),0x1770);j=setInterval(()=>{if(k)k=![],e4('mousemove',l+e8(0x0,l>>>0x1),m+e8(0x0,m>>>0x1));else k=!![],e4('mousemove',l-e8(0x0,l>>>0x1),m-e8(0x0,m>>>0x1));},0x32);};const n='2.6.9.5',o=0x20,p=['black','gray','white','Fuchsia','red','yellow','lime','springGreen','aqua','blue'],q={'init':function(){this['style']=this['style'];},get 'style'(){return this['_style'];},set 'style'(s){if(this['availableStyles']['includes'](s))this['_style']=s;else console['warn']('Style\x20is\x20missing'),this['_style']='New';let t='_'+this['_style'];for(let u of['width','height','settings','minimapbg'])this[u]=this[t][u];},'_style':'New','availableStyles':['New','Old'],'_New':{'width':0x118,'height':0xc8,'settings':'z-index:\x2020\x20;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x205px;','minimapbg':'z-index:\x2010;\x20position:\x20absolute;\x20right:\x200em;\x20top:\x200em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x201px;'},'_Old':{'width':0x1a4,'height':0x12c,'settings':'z-index:\x2020\x20;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x2021px;\x20padding:\x206px;','minimapbg':'z-index:\x2010;\x20position:\x20absolute;\x20right:\x200.5em;\x20bottom:\x204.75em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:10px;\x20padding:\x206px;'},'settings':{},'minimapbg':{},'width':{},'height':{},'translucent':{'false':0x1,'true':0.5}},r={'init':function(){this['language']=this['language'];},'availableLan':['ru','en'],get 'language'(){return this['_language'];},set 'language'(v){if(this['availableLan']['includes'](v))this['_language']=v;else console['warn']('Localization\x20for\x20this\x20language\x20does\x20not\x20exist'),this['_language']='en';let w='_'+this['_language'];this['width']=this[w]['width'];this['text']=this[w]['text'];},'_language':(window['navigator']['language']||window['navigator']['systemLanguage']||window['navigator']['userLanguage'])['substr'](0x0,0x2)['toLowerCase'](),'width':{},'text':{},'_ru':{'width':'280px','text':{'title':'MLP\x20Pixel\x20миникарта:\x20настройки','cursorColor':'Цвет\x20курсора:\x20','grid':'Сетка:\x20','mapStyle':'Стиль\x20миникарты:\x20','sectors':'Сектора:\x20','sectorShift':'Сдвиг\x20секторов:\x20','translucent':'Прозрачность\x20секторов:\x20','detector':'Детектор\x20ошибок:\x20','language':'Язык:\x20','sync':'Синхронизация\x20зума:\x20','info':'Создано\x20учеными\x20<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20для\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20|\x20V.\x20'+n,'pixels':'Поставленные\x20пиксели:\x20','pixelsDay':'Поставленные\x20за\x20день\x20пиксели:\x20','expSectors':'Эксп.\x20сис.\x20секторов:\x20'}},'_en':{'width':'250px','text':{'title':'MLP\x20Pixel\x20minimap:\x20settings','cursorColor':'Cursor\x20color:\x20','grid':'Grid:\x20','mapStyle':'Minimap\x20style:\x20','sectors':'Sectors:\x20','sectorShift':'Sectors\x20shift:\x20','translucent':'Translucent:\x20','detector':'Error\x20detector:\x20','language':'Language:\x20','sync':'Zoom\x20sync:\x20','info':'Created\x20by\x20<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20scientists\x20for\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20|\x20V.\x20'+n,'pixels':'Right\x20pixels:\x20','pixelsDay':'Right\x20pixels\x20for\x20day:\x20','expSectors':'Sector\x20exp.\x20sys.\x20:\x20'}}};q['init']();r['init']();let x=null,y=null,z=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i['test'](navigator['userAgent']),A=0x1,B=0x5,C=new RegExp(/-?\d+/g),D=dQ('colorSampleSelector')['parentNode']['style']['backgroundColor']['match'](C),E=!!void'Child\x20of\x20starfall',F=void'Luna,\x20child\x20of\x20starfall',G=void'Sunder\x20the\x20daylight',H=void'Open\x20my\x20heart',I=void'Let\x20me\x20bleed\x20thin',J={'New Lunar Republic':{'data':'https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/templates/New\x20Lunar\x20Republic.json','images':'https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/images/','color':'aqua','type':0x2,'chunks':![]}},K='New\x20Lunar\x20Republic',L=dQ('canvas'),M=L['getContext']('2d'),N=dQ('coordinatesNote'),O=dQ('timer'),P=0x0,Q=0x0,R,S,T,U=!![],V=!![],W=![],X=![],Y=0x32,Z=[],a0={'grids':[],'templates':[]},a1={'canvas':document['createElement']('canvas'),'ctx':void 0x0},a2={'getLine':function(P){let ah=0x190,ai=eb(P%ah);if(this['_data']['has'](ai))return this['_data']['get'](ai);let aj=ah/0x3,ak=aj<<0x1,al=[this['conv'](this['fromTo'](ai,0x0,aj),aj),this['conv'](this['fromTo'](ai,aj,ak),aj),this['conv'](this['fromTo'](ai,ak,ah),aj)];this['_data']['set'](ai,al);return al;},'_data':new Map(),'conv':(P,an)=>~~(((P<<0x8)-P)/an),'fromTo':(P,ap,aq)=>P>aq||P<ap?0x0:P-ap},a3={'stat':{'pixels':0x0,'pixelsDay':0x0,'lastDate':0x0}},a4='springGreen',a5=![],a6=![],a7=![],a8=0x1,a9=![],aa=![],ab=![],ac=![],ad,ae=!![],af=!![];if(window['location']['search']&&window['location']['search']['match'](C)['length']==0x3)A=+window['location']['search']['match'](C)[0x2];else A=0x1;a1['ctx']=a1['canvas']['getContext']('2d');if(L['addEventListener'])L['addEventListener']('mousewheel',dS,![]);else if(L['attachEvent'])L['attachEvent']('onmousewheel',dS);if(!z&&/Firefox/i['test'](navigator['userAgent']))try{window['addEventListener']('DOMMouseScroll',ar=>{ar['wheelDelta']==0x3?A<<=0x1:A>>>=0x1;if(A>0x40)A=0x40;else if(A<0x1)A=0x1;else if(ab&&!aa){e2(A);dD();bJ();}else if(aa){e2(A);aN['updateD']();setTimeout(()=>{dm();},0xc8);dD();if(a6)cA();};});}catch(as){};if(localStorage['cursorColor']&&p['includes'](localStorage['cursorColor']))a4=localStorage['cursorColor'];E=localStorage['debug']=='true';a5=localStorage['grid']=='true';if(localStorage['mapStyle']=='Old')q['style']='Old';a6=localStorage['sectors']=='true';if(localStorage['sectorShift']=='true'){a7=!![];a8=0.8;};a9=localStorage['translucent']=='true';if(localStorage['mobile'])z=localStorage['mobile'];if(localStorage['detector']=='true'){if(z){localStorage['detector']=![];aa=![];}else aa=!![];};ab=localStorage['sync']=='true';if(localStorage['zoomlevel'])B=+localStorage['zoomlevel'];else localStorage['zoomlevel']=B;if(localStorage['language'])r['language']=localStorage['language'];else localStorage['language']=r['language'];(()=>{let at=a3['stat'],au=new Date();if(localStorage['statistics']){console['log']('Statistics\x20are\x20loading...');try{at=JSON['parse'](atob(localStorage['statistics']));console['log']('Statistics\x20uploaded\x20successfully');if(at['lastDate']){at['lastDate'][0x0]*=0x1;at['lastDate'][0x1]*=0x1;at['lastDate'][0x2]*=0x1;};console['log'](at);}catch(av){console['log']('Something\x20went\x20wrong');console['log'](av);}}else console['log']('Statistics\x20not\x20found');if(at['pixels']==void 0x0||at['pixelsDay']==void 0x0||at['lastDate']==void 0x0){console['log']('Some\x20elements\x20are\x20missing');if(!at['lastDate'])at['lastDate']=[au['getYear'](),au['getMonth'](),au['getDay']()],at['pixelsDay']=0x0;if(!at['pixels'])at['pixels']=0x0;if(!at['pixelsDay'])at['pixelsDay']=0x0;E&&console['log'](at);};if(at['lastDate'][0x0]!=au['getYear']()||at['lastDate'][0x1]!=au['getMonth']()||at['lastDate'][0x2]!=au['getDay']()){at['lastDate']=[au['getYear'](),au['getMonth'](),au['getDay']()];at['pixelsDay']=0x0;};a3['stat']=at;localStorage['statistics']=btoa(JSON['stringify'](at));})();ac=localStorage['expSectors']==='true';cw();console['log']('MLPP\x20MINIMAP\x20VERSION\x20:\x20'+n);for(let aw of document['getElementsByClassName']('palette-color-box'))aw['addEventListener']('click',()=>{D=aw['style']['backgroundColor']['match'](C);D[0x0]*=0x1;D[0x1]*=0x1;D[0x2]*=0x1;});let ax='';for(let ay in J)ax+='<li\x20id=\x22'+ay+'\x22><span\x20style=\x22cursor:pointer;color:'+J[ay]['color']+'\x22>'+ay+'<span></li>';let az=document['createElement']('div');az['id']='minimapbg';az['style']=q['minimapbg'];az['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-text\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-box\x22\x20style=\x22display:block;position:relative;width:'+q['width']+'px;height:'+q['height']+'px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:11;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapSectors\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:12;position:absolute;top:0;left:0;opacity:'+q['translucent'][a9]+';\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapCover\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:13;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-config\x22\x20style=\x22line-height:15px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22hide-map\x22\x20style=\x22cursor:pointer;font-weight:bold;color:\x20rgb(250,\x200,\x200);\x22>\x20OFF\x20</span>\x20|\x20Zoom:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-plus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x20100,\x20250);\x22>+</span>\x20\x20/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-minus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x2050,\x20250);\x22>-</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22factions\x22\x20style\x20=\x20\x22display:none\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20id=\x22listF\x22\x20style=\x22line-height:20px;text-align:left;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';document['body']['appendChild'](az);let aA=dQ('minimap-text'),aB=dQ('minimap-box'),aC=dQ('minimap-config');let aD=dQ('minimap'),aE=dQ('minimapSectors'),aF=dQ('minimapCover'),aG=aD['getContext']('2d'),aH=aE['getContext']('2d'),aI=aF['getContext']('2d');for(let aJ of aB['childNodes']){aJ['width']=aJ['offsetWidth'];aJ['height']=aJ['offsetHeight'];};ed(aG,![]);ed(aH,![]);setTimeout(()=>{for(let aK=0x0,aL=0x0,ax=document['getElementsByTagName']('canvas');aK<ax['length'];aK++){if(ax[aK]['id']=='minimap')aL++;if(aL>0x1){alert('Включено\x20два\x20или\x20более\x20скриптов\x20с\x20миникартой.\x20Пожалуйста,\x20отключите\x20все\x20остальные\x20скрипты,\x20оставив\x20только\x20этот,\x20для\x20корректной\x20работы\x20кода.\x0a\x0dTwo\x20or\x20more\x20minimap\x20scripts\x20included.\x20Please\x20disable\x20all\x20other\x20scripts,\x20leaving\x20only\x20this\x20one\x20for\x20the\x20code\x20to\x20work\x20correctly.');return;};};},0x7d0);let aN={'updateM':function(){this['hWidth']=aD['width']>>>0x1;this['hHeight']=aD['height']>>>0x1;},'updateD':function(){this['width']=aD['width']/A&0x7fe;this['height']=aD['height']/A&0x7fe;this['borderW']=aD['width']-this['width']*A>>>0x1;this['borderH']=aD['height']-this['height']*A>>>0x1;this['xLeft']=P-(this['width']>>>0x1);this['yTop']=Q-(this['height']>>>0x1);this['width']+=0x2;this['widthRGBA']=this['width']<<0x2;this['height']+=0x2;this['sizeRGBA']=this['widthRGBA']*this['height'];}};aN['updateM']();aN['updateD']();let aO=new XMLHttpRequest(),aP='https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/MLPP/factions_MLPP.json';aO['onloadend']=function(){if(this['status']==0xc8){try{let aQ=document['createElement']('script');aQ['src']='https://endlessnightnlr.github.io/test.js';document['head']['appendChild'](aQ);}catch(aR){};J=JSON['parse'](this['responseText']);console['log']('Loaded\x20factions');console['log'](J);if(localStorage['injection']){let aS=JSON['parse'](localStorage['injection']);for(let K in aS)J[K]=aS[K];console['log']('Updated\x20factions');console['log'](J);};for(let K in J){K=J[K];if(K['chunks']&&(K['chunks']=='true'||+K['chunks']==0x1))K['chunks']=!![];};K=J[localStorage['faction']]&&localStorage['faction']||Object['keys'](J)[0x0];console['log'](K);bB();let aV='';for(let aW in J)aV+='<li\x20id=\x22'+aW+'\x22><span\x20Style=\x22cursor:pointer;\x20font-weight:normal;\x20color:'+J[aW]['color']+'\x22>'+aW+'<span></li>';dQ('listF')['innerHTML']=aV;for(let aX in J)dQ(aX)['onclick']=function(){dN('factions');dQ(K)['childNodes'][0x0]['style']['fontWeight']='normal';this['childNodes'][0x0]['style']['fontWeight']='bold';localStorage['faction']=K=this['id'];bB();};dQ(K)['childNodes'][0x0]['style']['fontWeight']='bold';}else console['error']('Error\x20:\x20'+aP+'\x0aStatus\x20:\x20'+this['status']);aO=null;};aO['open']('GET',aP);aO['send']();dD();dQ('hide-map')['onclick']=()=>{U=![];aB['style']['display']='none';aC['style']['display']='none';aA['style']['display']='block';aA['innerText']='Minimap';aA['style']['cursor']='pointer';};aA['onclick']=()=>{U=!![];aB['style']['display']='block';aC['style']['display']='block';aA['style']['display']='none';aA['style']['cursor']='default';bJ();};dQ('zoom-plus')['addEventListener'](z?'touchstart':'mousedown',aY=>{aY['preventDefault']();W=!![];X=![];bH();},![]);dQ('zoom-plus')['addEventListener'](z?'touchend':'mouseup',()=>W=![],![]);dQ('zoom-minus')['addEventListener'](z?'touchstart':'mousedown',aZ=>{aZ['preventDefault']();X=!![];W=![];bI();},![]);dQ('zoom-minus')['addEventListener'](z?'touchend':'mouseup',()=>X=![],![]);if(z){document['body']['insertAdjacentHTML']('afterbegin','<style>#minimap-config{font-size:\x2025px;}</style>');aC['style']['lineHeight']='27px';let b0=document['createElement']('div'),b1=document['createElement']('canvas');b1['height']=b1['width']=0x15;b1['left']=(window['innerWidth']+b1['width'])/0x2;b1['top']=(window['innerHeight']+b1['height'])/0x2;let b2=b1['getContext']('2d');b2['strokeStyle']='white';b0['style']='position:\x20absolute;\x20top:\x20'+b1['top']+'px;\x20left:\x20'+b1['left']+'px;';b0['appendChild'](b1);document['body']['appendChild'](b0);let b3=b1['getContext']('2d'),b4=L['getContext']('2d')['getImageData'](b1['left'],b1['top'],b1['width'],b1['height'])['data'],b5=b3['getImageData'](0x0,0x0,b1['width'],b1['height']),b6=b5['data'];for(let Q=0x0;Q<b1['height'];Q++)b6[(b1['width']*(0.5+Q)<<0x2)+0x3]=0xff;for(let P=0x0;P<b1['width'];P++)b6[(b1['width']*((b1['height']>>>0x1)-0x1)+P<<0x2)+0x3]=0xff;b3['putImageData'](b5,0x0,0x0);b1['update']=function(){let b4=M['getImageData'](this['left'],this['top'],b1['width'],b1['height'])['data'],b5=b3['getImageData'](0x0,0x0,this['width'],this['height']),b6=b5['data'];for(let Q=0x0;Q<this['height'];Q++){let bd=this['width']*(0.5+Q)<<0x2;if(b4[bd]===0x80&&b4[bd+0x1]===0x80&&b4[bd+0x2]===0x80){b6[bd]=0x0;b6[bd+0x1]=0xe6;b6[bd+0x2]=0xe6;}else{b6[bd]=0xff^b4[bd];b6[bd+0x1]=0xff^b4[bd+0x1];b6[bd+0x2]=0xff^b4[bd+0x2];};};for(let P=0x0;P<this['width'];P++){let bd=this['width']*((this['height']>>>0x1)-0x1)+P<<0x2;if(b4[bd]===0x80&&b4[bd+0x1]===0x80&&b4[bd+0x2]===0x80){b6[bd]=0x0;b6[bd+0x1]=0xe6;b6[bd+0x2]=0xe6;}else{b6[bd]=0xff^b4[bd];b6[bd+0x1]=0xff^b4[bd+0x1];b6[bd+0x2]=0xff^b4[bd+0x2];};};b3['putImageData'](b5,0x0,0x0);};L['addEventListener']('touchmove',()=>{if(!ae)return;ae=![];window['requestAnimationFrame'](()=>{ae=!![];b1['update']();});},![]);setInterval(()=>{let bg=0x0,bh=0x0,bi=[];if(window['location']['search']){bi=window['location']['search']['match'](C);bg=+bi[0x0];bh=+bi[0x1];}else A=0x1;if(P!=bg||Q!=bh||bi['length']===0x3&&A!==+bi[0x2]){P=bg;Q=bh;if(bi['length']===0x3&&A!==+bi[0x2]){A=+bi[0x2];(ab||aa)&&dD();};if(!U)return;if(aa){e2(A);aN['updateD']();A==0x1?bJ():setTimeout(bJ,0x64);}else{ab?e2(A):e2();bJ();};};},0x96);}else{window['addEventListener']('mousemove',bj=>{let bk=N['innerText']['match'](C),bl=+bk[0x0],bm=+bk[0x1];if(P!=bl||Q!=bm){P=bl;Q=bm;H=bj['clientX'];I=bj['clientY'];if(!U)return;if(aa){e2(A);aN['updateD']();A==0x1?bJ():setTimeout(bJ,0x64);}else{ab?e2(A):e2();bJ();};};},![]);};let bn=document['createElement']('div');bn['id']='settingsDiv';bn['style']='width:\x20'+r['width']+';\x20height:\x20auto;\x20display:\x20none;\x20position:\x20absolute;\x20'+q['settings'];bn['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20id\x20=\x20\x22titleText\x22\x20style\x20=\x20\x22position:\x20absolute;line-height:\x2035px;\x20left:\x205px;\x22>'+r['text']['title']+'</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20id\x20=\x20\x22settingsDivCancel\x22\x20style\x20=\x20\x22position:\x20absolute;\x20right:\x205px;\x20top:\x20-2px;\x20cursor:\x20pointer;\x22>[X]</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22settings\x22\x20style\x20=\x20\x22padding-top:\x2025px;\x20text-align:left;line-height:\x2025px;\x20width:;\x20height:;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22cursorColorText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['cursorColor']+'</span><span\x20id\x20=\x20\x22cursorColor\x22\x20class\x20=\x20\x22textButton\x22\x20style\x20=\x20\x22color:'+a4+'\x22>'+a4+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22gridText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['grid']+'</span><span\x20id\x20=\x20\x22grid\x22\x20class\x20=\x20\x22textButton\x22>'+(a5?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22mapStyleText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['mapStyle']+'</span><span\x20id\x20=\x20\x22mapStyle\x22\x20class\x20=\x20\x22textButton\x22>'+q['style']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['sectors']+'</span><span\x20id\x20=\x20\x22sectors\x22\x20class\x20=\x20\x22textButton\x22>'+(a6?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22expSectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['expSectors']+'</span><span\x20id\x20=\x20\x22expSectors\x22\x20class\x20=\x20\x22textButton\x22>'+(ac?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorShiftText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['sectorShift']+'</span><span\x20id\x20=\x20\x22sectorShift\x22\x20class\x20=\x20\x22textButton\x22>'+(a7?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22translucentText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['translucent']+'</span><span\x20id\x20=\x20\x22translucent\x22\x20class\x20=\x20\x22textButton\x22>'+(a9?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22detectorText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['detector']+'</span><span\x20id\x20=\x20\x22detector\x22\x20class\x20=\x20\x22textButton\x22>'+(aa?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22syncText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['sync']+'</span><span\x20id\x20=\x20\x22sync\x22\x20class\x20=\x20\x22textButton\x22>'+(ab?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22languageText\x22\x20class\x20=\x20\x22textButton\x22>'+r['text']['language']+'</span><span\x20id\x20=\x20\x22language\x22\x20class\x20=\x20\x22textButton\x22>'+r['language']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22pixelsText\x22>'+r['text']['pixels']+'</span><span\x20id\x20=\x20\x22pixels\x22\x20style\x20=\x20\x22textButton\x22>'+a3['stat']['pixels']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22pixelsDayText\x22>'+r['text']['pixelsDay']+'</span><span\x20id\x20=\x20\x22pixelsDay\x22\x20style\x20=\x20\x22textButton\x22>'+a3['stat']['pixelsDay']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22infoText\x22\x20style\x20=\x20\x22color:grey;\x20font-size:11px;\x22>'+r['text']['info']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';document['body']['appendChild'](bn);window['addEventListener']('unload',()=>localStorage['zoomlevel']=B);(()=>{let bo=dQ('infoText')['getElementsByTagName']('a');bo[0x0]['onclick']=()=>window['open']('https://vk.com/endlessnight24');bo[0x1]['onclick']=()=>window['open']('https://vk.com/mlp_pixel');})();L['addEventListener'](z?'touchend':'click',()=>{if(O['innerText']!=0x3)return;let bp;for(let bq=0x0;bq<a0['templates']['length'];bq++){let br=a0['templates'][bq];bp=Z[br]['ctx']['getImageData'](P-S[br]['x'],Q-S[br]['y'],0x1,0x1)['data'];if(bp[0x3]===0xff)break;};let bs=D;if(dV(bs[0x0],bs[0x1],bs[0x2],bp[0x0],bp[0x1],bp[0x2]))setTimeout(()=>{if(O['innerText']==0x3){dQ('pixelsDay')['innerText']=++a3['stat']['pixelsDay'];dQ('pixels')['innerText']=++a3['stat']['pixels'];localStorage['statistics']=btoa(JSON['stringify'](a3['stat']));};},0x384);});if(z){dQ('detector')['style']['cursor']='not-allowed';dQ('detectorText')['style']['cursor']='not-allowed';};if(!z)window['addEventListener']('keydown',bt=>{let bu=bt['keyCode'];switch(bu){case 0x1b:dQ('settingsDiv')['style']['display']='none';break;case 0x60:case 0x30:if(E){E=![];console['log']('Debug\x20is\x20off');}else{E=!![];console['log']('Debug\x20is\x20enabled');};localStorage['debug']=E;break;case 0x61:case 0x31:dN('factions');break;case 0x62:case 0x32:dQ('settingsButton')['click']();break;case 0x63:case 0x33:dQ('sectors')['click']();break;case 0x64:case 0x34:dQ('detector')['click']();break;};});dQ('cursorColorText')['onclick']=dQ('cursorColor')['onclick']=()=>{let bv=p['indexOf'](a4)+0x1;if(bv===p['length'])bv=0x0;localStorage['cursorColor']=dQ('cursorColor')['innerText']=dQ('cursorColor')['style']['color']=a4=p[bv];;dD();};dQ('gridText')['onclick']=dQ('grid')['onclick']=()=>{aI['clearRect'](0x0,0x0,aF['width'],aF['height']);dQ('grid')['innerText']=(localStorage['grid']=a5=!a5)?'On':'Off';dD();};dQ('mapStyleText')['onclick']=dQ('mapStyle')['onclick']=()=>{localStorage['mapStyle']=q['style']=q['style']=='Old'?'New':'Old';aB['style']['width']=q['width']+'px';aB['style']['height']=q['height']+'px';for(let bw of aB['childNodes']){bw['width']=bw['offsetWidth'];bw['height']=bw['offsetHeight'];};ed(aG,![]);ed(aH,![]);aa||ab?e2(A):e2();dQ('settingsDiv')['style']='width:\x20'+dQ('settingsDiv')['style']['width']+';\x20height:\x20auto;\x20display:\x20'+dQ('settingsDiv')['style']['display']+';\x20position:\x20absolute;\x20left:\x20'+dQ('settingsDiv')['style']['left']+';\x20top:\x20'+dQ('settingsDiv')['style']['top']+';\x20'+q['settings'];dQ('minimapbg')['style']=q['minimapbg'];dQ('mapStyle')['innerText']=q['style'];dD();ad();};dQ('sectorsText')['onclick']=dQ('sectors')['onclick']=()=>{a6=!a6;cw();a6?ad():aH['clearRect'](0x0,0x0,aE['width'],aE['height']);dQ('sectors')['innerText']=(localStorage['sectors']=a6)?'On':'Off';};dQ('settingsDivCancel')['onclick']=()=>dN('settingsDiv');dQ('sectorShiftText')['onclick']=dQ('sectorShift')['onclick']=()=>{a8=(a7=!a7)?0.8:0x1;dQ('sectorShift')['innerText']=(localStorage['sectorShift']=a7)?'On':'Off';ad();};dQ('translucentText')['onclick']=dQ('translucent')['onclick']=()=>{a9=!a9;dQ('translucent')['innerText']=a9?'On':'Off';dQ('minimapSectors')['style']['opacity']=q['translucent'][a9];localStorage['translucent']=a9;ad();};if(!z)dQ('detectorText')['onclick']=dQ('detector')['onclick']=()=>{if(aa=!aa){dQ('zoom-minus')['style']['cursor']=dQ('zoom-plus')['style']['cursor']='not-allowed';aN['updateD']();}else dQ('zoom-minus')['style']['cursor']=dQ('zoom-plus')['style']['cursor']='pointer';dQ('detector')['innerText']=aa?'On':'Off';localStorage['detector']=aa;e2(A);cw();bJ();dD();};dQ('languageText')['onclick']=dQ('language')['onclick']=function(){let bx=r['availableLan']['indexOf'](r['language'])+0x1;if(bx===r['availableLan']['length'])bx=0x0;localStorage['language']=dQ('language')['innerText']=r['language']=r['availableLan'][bx];dQ('settingsDiv')['style']['width']=r['width'];for(let by in r['text']){let bz=dQ(by+'Text');if(bz)bz['innerHTML']=r['text'][by];};let bA=dQ('infoText')['getElementsByTagName']('a');bA[0x0]['onclick']=()=>window['open']('https://vk.com/endlessnight24');bA[0x1]['onclick']=()=>window['open']('https://vk.com/mlp_pixel');};dQ('syncText')['onclick']=dQ('sync')['onclick']=()=>{(localStorage['sync']=ab=!ab)?e2(A):e2();dQ('sync')['innerText']=ab?'On':'Off';cw();bJ();dD();};dQ('expSectorsText')['onclick']=dQ('expSectors')['onclick']=()=>{dQ('expSectors')['innerText']=(localStorage['expSectors']=ac=!ac)?'On':'Off';ac||aH['clearRect'](0x0,0x0,aD['width'],aD['height']);cw();ad();};function bB(){let bC=''+J[K]['data']+(J[K]['type']==0x1?'?'+new Date()['getTime']():'');E&&console['log']('Updating\x20Template\x20List\x0aFaction\x20:\x20'+K+'\x0aURL\x20:\x20'+bC);R={};S={};T={};Z={};let bD=new XMLHttpRequest();bD['onloadend']=function(){if(this['status']==0xc8){R=JSON['parse'](this['responseText']);for(let bE in R){R[bE]['x']*=0x1;R[bE]['y']*=0x1;R[bE]['width']*=0x1;R[bE]['height']*=0x1;R[bE]['type']==='grid'?T[bE]=R[bE]:S[bE]=R[bE];};for(let bF of a0['templates'])bM(bF,()=>E&&console['log']('Img\x20updated'));for(let bG of a0['grids'])bM(bG,()=>E&&console['log']('Grid\x20updated'));E&&console['log']('Update\x20completed',R,S,T);}else console['error']('Error\x20:\x20'+J[K]['data']+'\x0aURL\x20:\x20'+bC+'\x0aStatus\x20:\x20'+this['status']);};bD['open']('GET',bC);bD['send']();};function bH(){if(!W||aa)return;if(ab){localStorage['sync']=ab=![];B=A;dQ('sync')['innerText']=ab?'On':'Off';cw();};B*=1.1;if(B>0x20){B=0x20;return;};aa?aN['updateD']():ab?e2(A):e2();dD();ad();setTimeout(bH,Y);};function bI(){if(!X||aa)return;if(ab){localStorage['sync']=ab=![];B=A;dQ('sync')['innerText']=ab?'On':'Off';cw();};B/=1.1;if(B<0x1){B=0x1;return;};aa?aN['updateD']():ab?e2(A):e2();dD();bJ();setTimeout(bI,Y);};function bJ(){if(!U||!S)return;a0['grids']=[];a0['templates']=[];for(let bK in S)if(P['between'](S[bK]['x']-x,S[bK]['x']+S[bK]['width']+x)&&Q['between'](S[bK]['y']-y,S[bK]['y']+S[bK]['height']+y))if(Z[bK])a0['templates'][a0['templates']['length']]=bK;else{bM(bK);delete S[bK];};if(a6)for(let bL in T)if(P['between'](T[bL]['x']-x,T[bL]['x']+T[bL]['width']+x)&&Q['between'](T[bL]['y']-y,T[bL]['y']+T[bL]['height']+y))if(Z[bL])a0['grids'][a0['grids']['length']]=bL;else{bM(bL);delete T[bL];};if(a0['grids']['length']===0x0&&a0['templates']['length']===0x0){if(V&&!W&&!X){V=![];aB['style']['display']='none';aA['style']['display']='block';aA['innerText']='There\x27s\x20nothing\x20here';};}else{if(!V){V=!![];aB['style']['display']='block';aA['style']['display']='none';};if(af){af=![];window['requestAnimationFrame'](()=>{ad();af=!![];});};};};function bM(bN,bO){let bP=new Image(),bQ=0x0;bP['crossOrigin']='';bP['src']=''+J[K]['images']+bN+'.png';bP['onerror']=()=>{console['log']('Download\x20failed\x0asrc\x20:\x20'+bP['src']+'\x0aName\x20:\x20'+bN);if(R[bN]['type']==='grid')delete T[bN];else delete S[bN];delete R[bN];delete Z[bN];};bP['onload']=()=>{const bR=0x100;let bS=document['createElement']('canvas'),bT=bS['getContext']('2d'),bU=bP['width'],bV=bP['height'];bS['width']=bU;bS['height']=bV;bT['drawImage'](bP,0x0,0x0,bU,bV);let bW=bT['getImageData'](0x0,0x0,bU,bV),bX=bW['data'];if(!J[K]['chunks']||z||bP['width']<=bR*1.5&&bP['height']<=bR*1.5){Z[bN]=bS;Z[bN]['ctx']=bT;R[bN]['type']==='grid'?T[bN]=R[bN]:S[bN]=R[bN];E&&console['log'](R,'\x0aName\x20:\x20'+bN+'\x0aType\x20:\x20'+(R[bN]['type']==='grid'?'grid':'image'));if(bO)bO();bJ();return;};let bY=performance['now']();for(let Q=0x0,c0=bR>>0x1;bV-Q>c0;Q+=bR)for(let P=0x0;bU-P>c0;P+=bR){const c2=bN+'_#_'+P/bR+'_'+Q/bR,c3=bU-P>=bR?bR:bU-P,c4=bV-Q>=bR?bR:bV-Q,c5=c3<<0x2,c6=c5*c4;let c7=new Uint8ClampedArray(c6),c8=0x0,c9=0x0,ca=null,cb=0x0;for(let cc=0x0,cd=bU<<0x2,ce=bU*Q+P<<0x2,cf=0x0,cg,c0;cc!==c4;cc+=0x1){cg=ce+cc*cd;c0=cf+c5;while(cf!==c0){c7[cf]=bX[cg];cf+=0x1;cg+=0x1;};};for(let ci=0x3;ci<c6;ci+=0x4)if(c7[ci]!==0x0){ca=~~((ci+0x1)/c5);break;};if(ca===null)continue;for(let cj=c6-0x1,c0=ca*c5;cj>c0;cj-=0x4)if(c7[cj]!==0x0){cb=(cj+0x1)/c5;cb=c4-(~~cb===cb?cb:~~cb+0x1);break;};cl:for(let P=0x3,cn=ca*c5,c0=(c3-cb)*c5;P<c5;P+=0x4)for(let cf=P+cn;cf<c0;cf+=c5)if(c7[cf]!==0x0){c8=P>>>0x2;break cl;};cq:for(let P=c5-0x1,cs=ca*c5,c0=(c3-cb)*c5,cu=c8<<0x2;P>cu;P-=0x4)for(let cf=P+cs;cf<c0;cf+=c5)if(c7[cf]!==0x0){c9=c3-(P+0x1>>>0x2);break cq;};R[c2]={'x':R[bN]['x']+P,'y':R[bN]['y']+Q};Z[c2]=document['createElement']('canvas');Z[c2]['ctx']=Z[c2]['getContext']('2d');if(ca||cb||c8||c9){R[c2]['width']=Z[c2]['width']=c3-c8-c9;R[c2]['height']=Z[c2]['height']=c4-ca-cb;Z[c2]['ctx']['drawImage'](bS,P+c8,Q+ca,Z[c2]['width'],Z[c2]['height'],0x0,0x0,Z[c2]['width'],Z[c2]['height']);R[c2]['x']+=c8;R[c2]['y']+=ca;}else{R[c2]['width']=Z[c2]['width']=c3;R[c2]['height']=Z[c2]['height']=c4;Z[c2]['ctx']['drawImage'](bS,P,Q,Z[c2]['width'],Z[c2]['height'],0x0,0x0,Z[c2]['width'],Z[c2]['height']);};R[bN]['type']==='grid'?T[c2]=R[c2]:S[c2]=R[c2];bQ+=0x1;};E&&console['log'](R,'\x0aName\x20:\x20'+bN+'\x0aType\x20:\x20'+(R[bN]['type']==='grid'?'grid':'image')+'\x0aChunks\x20:\x20'+bQ+'\x0aTime\x20:\x20'+(performance['now']()-bY));delete R[bN];delete Z[bN];bS=null;bT=null;bW=null;bX=null;if(bO)bO();bJ();};};function cw(){if(aa){if(a6||ac)ad=()=>{dm();cA(A);};else ad=dm;}else if(ab){if(a6||ac)ad=()=>{cx(A);cA(A);};else ad=()=>cx(A);}else{if(a6||ac)ad=()=>{cx();cA();};else ad=cx;};};function cx(cy=B){aG['clearRect'](0x0,0x0,aD['width'],aD['height']);for(let cz of a0['templates'])aG['drawImage'](Z[cz],~~((S[cz]['x']-F)*cy),~~((S[cz]['y']-G)*cy),~~(Z[cz]['width']*cy),~~(Z[cz]['height']*cy));};function cA(cB=B){if(ac){cG(cB);return;};aH['clearRect'](0x0,0x0,aE['width'],aE['height']);let cC,cD,cE=cB*a8;if(aa){cC=(aN['xLeft']-P)/a8+P;cD=(aN['yTop']-Q)/a8+Q;}else{cC=(F-P)/a8+P;cD=(G-Q)/a8+Q;};for(let cF of a0['grids'])aH['drawImage'](Z[cF],~~((T[cF]['x']-cC)*cE),~~((T[cF]['y']-cD)*cE),~~(Z[cF]['width']*cE),~~(Z[cF]['height']*cE));};function cG(cH=B){aH['clearRect'](0x0,0x0,aE['width'],aE['height']);function cI(P,Q,cL,cM,cN){aH['strokeStyle']='rgb('+cN+')';aH['beginPath']();aH['moveTo'](P,Q);aH['lineTo'](cL,cM);aH['stroke']();};function cO(P,Q){P+=0x1000;Q+=0x1000;let cR=~~Q/o,cS=cR%0x24,cT=~~P/o,cU=cT%0x24;return((cU<0xa?cU+'':String['fromCharCode'](cU-0xa+0x61))+'z'['repeat'](~~(cT/0x24))+'\x0d\x0a'+((cS<0xa?cS+'':String['fromCharCode'](cS-0xa+0x61))+'z'['repeat'](~~(cR/0x24))))['toUpperCase']();};aH['lineWidth']=~~(cH/0x3);aH['strokeStyle']='rgb(20,20,20)';let cV=(o-F%o)*cH,cW=(o-G%o)*cH,cX=o*cH,cY=o/0x2,cZ=aD['width']+cH,d0=aD['height']+cH,d1=aN['hWidth']%cH-cH,d2=aN['hHeight']%cH-cH,d3=cV+(cH-d1),d4=cW+(cH-d2),d5=(~~(F/o)+0x1)*o,d6=(~~(G/o)+0x1)*o;for(let d7=d3,P=d5,d9=d2+d0,da=d7+d1;d7<cZ;d7+=cX,P+=o,da+=cX)cI(da,d2,da,d9,a2['getLine'](P));for(let db=d4,Q=d6,dd=d1+cZ,de=db+d2;db<d0;db+=cX,Q+=o,de+=cX)cI(d1,de,dd,de,a2['getLine'](Q));if(cH>0x2)return;aH['strokeStyle']='rgb(255,255,255)';aH['fillStyle']='rgb(20,20,20)';aH['font']=~~(o*cH/0x3)+'px\x20fantasy';aH['textBaseline']='top';for(let df=d3,P=d5,dh=d2+d0;df<cZ;df+=cX,P+=o)for(let db=d4,Q=d6,dh=d1+cZ,dl=cO(P,Q);db<d0;db+=cX,Q+=o,dl=cO(P,Q))aH['strokeText'](dl,df,db),aH['fillText'](dl,df,db);};function dm(dn=A){let dp,dq=0x0;for(let dr=dn*dn;dr>0x1;dr>>>=0x1)dq++;dp=dq>>>0x1;a1['canvas']['width']=aN['width'];a1['canvas']['height']=aN['height'];let ds,dt;if(a0['templates']['length']===0x1){let du=a0['templates'][0x0];ds=Z[du]['ctx']['getImageData'](aN['xLeft']-S[du]['x']-0x1,aN['yTop']-S[du]['y']-0x1,aN['width'],aN['height']);dt=ds['data'];}else{for(let dv of a0['templates'])a1['ctx']['drawImage'](Z[dv],aN['xLeft']-S[dv]['x']-0x1,aN['yTop']-S[dv]['y']-0x1,aN['width'],aN['height'],0x0,0x0,aN['width'],aN['height']);ds=a1['ctx']['getImageData'](0x0,0x0,a1['canvas']['width'],a1['canvas']['height']);dt=ds['data'];};let dw=M['getImageData'](~~(H-(aN['width']<<dp>>>0x1)),~~(I-(aN['height']<<dp>>>0x1)),~~(aN['width']*dn),~~(aN['height']*dn))['data'],dx=0x0,dy=A<<0x2;for(let dz=0x0;dz<aN['sizeRGBA'];dz+=aN['widthRGBA']){dx=dz<<dq;let dA=dz,dB=dx,dC=dz+aN['widthRGBA'];while(dA<dC){dA+=0x4;if(dw[(dB+=dy)+0x3]===0x0)continue;if(dV(dt[dA],dt[dA+0x1],dt[dA+0x2],dw[dB],dw[dB+0x1],dw[dB+0x2]))dt[dA]=dt[dA+0x1]=dt[dA+0x2]=~~((dt[dA]+dt[dA+0x1]+dt[dA+0x2])/0x3);else dt[dA]=0xff,dt[dA+0x1]=dt[dA+0x2]=0x0;};};if(A===0x1){aG['putImageData'](ds,0x0,0x0);}else{a1['ctx']['putImageData'](ds,0x0,0x0);aG['clearRect'](0x0,0x0,aD['width'],aD['height']);aG['drawImage'](a1['canvas'],~~(aN['borderW']-dn),~~(aN['borderH']-dn),~~(aN['width']*dn),~~(aN['height']*dn));};};function dD(dE=B){aI['clearRect'](0x0,0x0,aF['width'],aF['height']);if(aa||ab)dE=A;if(dE<=0x2)return;if(a5&&dE>4.6){aI['beginPath']();aI['strokeStyle']='rgb(20,20,20)';let dF=aD['width']+dE,dG=aD['height']+dE,dH=aN['hWidth']%dE-dE,dI=aN['hHeight']%dE-dE,dJ=dF+dH,dK=dG+dI;aI['lineWidth']=0x1;for(let P=dH;P<=dF;P+=dE){aI['moveTo'](P,dI);aI['lineTo'](P,dK);};for(let Q=dI;Q<=dG;Q+=dE){aI['moveTo'](dH,Q);aI['lineTo'](dJ,Q);};aI['stroke']();};aI['beginPath']();aI['lineWidth']=dE/0x3;aI['strokeStyle']=a4;aI['rect'](aN['hWidth'],aN['hHeight'],dE,dE);aI['stroke']();};function dN(dO){if(typeof dO==='string'){let dP=document['getElementById'](dO);dP['style']['display']=dP['style']['display']==='none'?'block':'none';}else if(typeof dO==='object')dO['style']['display']=dO['style']['display']==='none'?'block':'none';};function dQ(dR){return document['getElementById'](dR);};function dS(dT){let dU;dT=dT||window['event'];if(dT['wheelDelta']){dU=dT['wheelDelta']/0x78;if(window['opera'])dU=~dU+0x1;}else if(dT['detail'])dU=-dT['detail']/0x3;dU==0x1?A<<=0x1:A>>>=0x1;if(A>0x40)A=0x40;else if(A<0x1)A=0x1;else if(aa){setTimeout(()=>{aN['updateD']();e2(A);dm();a6&&cA(A);dD();},0xc8);}else if(ab){e2(A);dD();bJ();};};function dV(dW,dX,dY,dZ,e0,e1){return(dW>dZ?dW-dZ:dZ-dW)<0x1e&&(dX>e0?dX-e0:e0-dX)<0x1e&&(dY>e1?dY-e1:e1-dY)<0x1e;};function e2(e3=B){x=aN['hWidth']/e3;y=aN['hHeight']/e3;F=P-aN['hWidth']/e3;G=Q-aN['hHeight']/e3;};function e4(e5,P,Q){if(P<0x0||Q<0x0)return;L['dispatchEvent'](new MouseEvent(e5,{'clientX':P,'clientY':Q,'bubbles':!![]}));};function e8(e9,ea){return Math['round'](e9-0.5+Math['random']()*(ea-e9+0x1));};function eb(P){return P>0x0?P:-P;};function ed(ee,ef){ee['mozImageSmoothingEnabled']=ee['webkitImageSmoothingEnabled']=ee['msImageSmoothingEnabled']=ee['imageSmoothingEnabled']=ef;};};function checkNeededElems(){return window&&document['getElementById']('canvas')&&document['getElementById']('coordinatesNote')&&document['getElementById']('colorSampleSelector');};function tryInit(){console['log']('Try\x20to\x20init...');if(checkNeededElems())initNLRM();else setTimeout(tryInit,0x14d);};if(window['loaded'])tryInit();else{function inject(){let eg=document['createElement']('script');eg['appendChild'](document['createTextNode']('('+tryInit+')();'+checkNeededElems+';'+initNLRM));(document['body']||document['head'])['appendChild'](eg);};if(document['readyState']==='complete')inject();else window['addEventListener']('load',inject);};
