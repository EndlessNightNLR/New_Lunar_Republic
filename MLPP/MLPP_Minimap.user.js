// ==UserScript==
// @name         MLP Pixel Minimap
// @version      2.7.0.1
// @description  My Little Pony Pixel (MLP Pixel) Minimap for PixelZone.io
// @author       Endless Night
// @include      *://pixelzone.io/*
// @homepage     https://github.com/EndlessNightNLR
// @updateURL    https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// @downloadURL  https://endlessnightnlr.github.io/master/MLPP/MLPP_Minimap.user.js
// ==/UserScript==
//
// To the glory of Luna and the New Lunar Republic!
function initNLRM(){'use strict';let r=null;{let bf=document['createElement']('div'),bg=document['createElement']('div'),bh,bi=null;bf['style']='position:fixed;\x20bottom:0px;\x20right:0px;\x20background-color:rgba(0,0,0,0.9);\x20padding:5px;\x20z-index:0;';bf['appendChild'](bg);{setInterval(()=>{if(bi===null)return;let bm=~~(new Date()['getTime']()/0x3e8-bi),bn=bm%0x3c,bo=~~(bm/0x3c);bh['innerText']=(bo>=0xa?bo:'0'+bo)+':'+(bn>=0xa?bn:'0'+bn);},0x3e8);let bl=document['createElement']('div');bl['innerText']='Since\x20last\x20captcha\x20';bh=document['createElement']('span');bh['innerText']='null';bl['appendChild'](bh);bf['appendChild'](bl);};const bj=(bp,bq)=>{bg['innerText']=bp;bg['style']['color']=bq;};bj(void 0x0,'grey');let bk;(function(br){WebSocket['prototype']['send']=function(){r=this;if(arguments[0x0]==='2'){bj('Online','springGreen');clearTimeout(bk);bk=setTimeout(()=>bj('Offline','red'),0x1e*0x3e8);return br['apply'](this,arguments);}else if(typeof arguments[0x0]==='string'){if(arguments[0x0]['includes']('captchaToken')){bi=new Date()['getTime']()/0x3e8;R&&console['log'](arguments[0x0]);return br['apply'](this,arguments);}else if(arguments[0x0]['includes']('place')){let bs=JSON['parse'](arguments[0x0]['substring'](0x2)),bt={'x':(bs[0x1]['pixel']>>>0x11)-0x1000,'y':((0x1fff0&bs[0x1]['pixel'])>>>0x4)-0x1000,'color':Colors['getColorRGBFromId'](bs[0x1]['pixel']&0xf)};for(let bu of af['templates']){if(!ae[bu])continue;let bv=a7[bu];if(bt['x']['between'](bv['x'],bv['xEnd'])&&bt['y']['between'](bv['y'],bv['yEnd'])){let bw=ae[bu],bx=bt['x']-bv['x']+bv['width']*(bt['y']-bv['y'])<<0x2,by=[bw['data'][bx],bw['data'][bx+0x1],bw['data'][bx+0x2]];if(b5(...by,...bt['color'])){b3('pixels')['innerText']=++ai['stat']['pixels'];b3('pixelsDay')['innerText']=++ai['stat']['pixelsDay'];break;};};};return br['apply'](this,arguments);}else return br['apply'](this,arguments);};};}(WebSocket['prototype']['send']));document['body']['appendChild'](bf);};(function bz(){let bA=b3('timer');if(bA)bA['style']['z-index']=0x13;else setTimeout(bz,0x14d);}());(function bB(){let bC=b3('message');if(bC)bC['remove']();else setTimeout(bB,0x14d);}());let s=document['createElement']('link');s['rel']='stylesheet';s['href']='https://endlessnightnlr.github.io/MLPP/style.css';document['head']['appendChild'](s);document['getElementsByClassName']('palette-container')[0x0]['style']['z-index']=0x1;let t=document['createElement']('div');t['style']='position:\x20absolute;\x20left:\x200px;\x20top:\x2057px;\x20margin:\x20-2px\x200px\x200px\x20-2px;';t['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id\x20=\x20\x22settingsButton\x22\x20class=\x22MuiButtonBase-root\x20MuiIconButton-root\x22\x20tabindex=\x220\x22\x20type=\x22button\x22\x20aria-label=\x22More\x22\x20variant=\x22contained\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiIconButton-label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tr-bg\x22\x20style=\x22width:\x2025px;\x20height:\x2025px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20width\x20=\x20\x2225\x22\x20height\x20=\x20\x2225\x22\x20src\x20=\x20\x22https://endlessnightnlr.github.io/MLPP/gear.png\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</img>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22MuiTouchRipple-root\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';document['body']['appendChild'](t);b3('settingsButton')['addEventListener']('click',()=>{let bD=b3('settingsDiv');b2(bD);if(bD['style']['display']==='block'){bD['style']['left']=(window['innerWidth']-bD['offsetWidth']>>>0x1)+'px';bD['style']['top']=(window['innerHeight']-bD['offsetHeight']>>>0x1)+'px';};});Number['prototype']['between']=function(bE,bF){return this>bE&&this<bF;};window['testPerformance']=()=>{console['log']('Start\x20testing');let bG=null,bH=!![],bI=Y['width']>>>0x1,bJ=Y['height']>>>0x1;setTimeout(()=>clearInterval(bG),0x1770);bG=setInterval(()=>{if(bH)bH=![],b7('mousemove',bI+ba(0x0,bI>>>0x1),bJ+ba(0x0,bJ>>>0x1));else bH=!![],b7('mousemove',bI-ba(0x0,bI>>>0x1),bJ-ba(0x0,bJ>>>0x1));},0x32);};const u={};u['width']=0x118;u['height']=0xc8;u['settings']='z-index:\x2020\x20;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x205px;';u['minimapbg']='z-index:\x2010;\x20position:\x20absolute;\x20right:\x200em;\x20top:\x200em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.90);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:\x201px;\x20padding:\x201px;\x20padding-left:\x201px;';const v={};v['width']=0x1a4;v['height']=0x12c;v['settings']='z-index:\x2020\x20;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20height:\x20auto;\x20border-radius:\x2021px;\x20padding:\x206px;';v['minimapbg']='z-index:\x2010;\x20position:\x20absolute;\x20right:\x200.5em;\x20bottom:\x204.75em;\x20background-color:\x20rgba(0,\x200,\x200,\x200.75);\x20color:\x20rgb(250,\x20250,\x20250);\x20text-align:\x20center;\x20line-height:\x2042px;\x20vertical-align:\x20middle;\x20width:\x20auto;\x20height:\x20auto;\x20border-radius:10px;\x20padding:\x206px;';const w={};w['false']=0x1;w['true']=0.5;const z={};z['init']=function(){this['style']=this['style'];};z['style']=function(){return this['_style'];};z['style']=function(bK){if(this['availableStyles']['includes'](bK))this['_style']=bK;else console['warn']('Style\x20is\x20missing'),this['_style']='New';let bL='_'+this['_style'];for(let bM of['width','height','settings','minimapbg'])this[bM]=this[bL][bM];};z['_style']='New';z['availableStyles']=['New','Old'];z['_New']=u;z['_Old']=v;z['settings']={};z['minimapbg']={};z['width']={};z['height']={};z['translucent']=w;const A='2.7.0.2',B=0x20,C=['black','gray','white','Fuchsia','red','yellow','lime','springGreen','aqua','blue'],D=z,E={'init':function(){this['language']=this['language'];},'availableLan':['ru','en','tr'],get 'language'(){return this['_language'];},set 'language'(bN){if(this['availableLan']['includes'](bN))this['_language']=bN;else console['warn']('Localization\x20for\x20this\x20language\x20does\x20not\x20exist'),this['_language']='en';let bO='_'+this['_language'];this['width']=this[bO]['width'];this['text']=this[bO]['text'];},'_language':(window['navigator']['language']||window['navigator']['systemLanguage']||window['navigator']['userLanguage'])['substr'](0x0,0x2)['toLowerCase'](),'width':{},'text':{},'_ru':{'width':'280px','text':{'on':'On','off':'Off','title':'MLP\x20Pixel\x20миникарта:\x20настройки','cursorColor':'Цвет\x20курсора:\x20','grid':'Сетка:\x20','mapStyle':'Стиль\x20миникарты:\x20','sectors':'Сектора:\x20','sectorShift':'Сдвиг\x20секторов:\x20','translucent':'Прозрачность\x20секторов:\x20','detector':'Детектор\x20ошибок:\x20','autoSelect':'Автовыбор\x20цвета:\x20','language':'Язык:\x20','sync':'Синхронизация\x20зума:\x20','info':'Создано\x20учеными\x20<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20для\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20|\x20V.\x20'+A,'pixels':'Поставленные\x20пиксели:\x20','pixelsDay':'Поставленные\x20за\x20день\x20пиксели:\x20','expSectors':'Эксп.\x20сис.\x20секторов:\x20'}},'_en':{'width':'250px','text':{'on':'On','off':'Off','title':'MLP\x20Pixel\x20minimap:\x20settings','cursorColor':'Cursor\x20color:\x20','grid':'Grid:\x20','mapStyle':'Minimap\x20style:\x20','sectors':'Sectors:\x20','sectorShift':'Sectors\x20shift:\x20','translucent':'Translucent:\x20','detector':'Error\x20detector:\x20','autoSelect':'Auto\x20color\x20selection:\x20','language':'Language:\x20','sync':'Zoom\x20sync:\x20','info':'Created\x20by\x20<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20scientists\x20for\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20|\x20V.\x20'+A,'pixels':'Correct\x20pixels:\x20','pixelsDay':'Correct\x20pixels\x20per\x20day:\x20','expSectors':'Sector\x20exp.\x20sys.\x20:\x20'}},'_tr':{'width':'280px','text':{'on':'Açık','off':'Kapalı','title':'MLP\x20Pixel\x20:\x20harita\x20ayarları','cursorColor':'İmleç\x20rengi:\x20','grid':'Izgara:\x20','mapStyle':'Minimap\x20stili:\x20','sectors':'Sectors:\x20','sectorShift':'Sectors\x20shift:\x20','translucent':'Yarı\x20saydam:\x20','detector':'Hata\x20dedektörü:\x20','autoSelect':'Otomatik\x20renk\x20seçme:\x20','language':'Dil:\x20','sync':'Zoom\x20sync:\x20','info':'<a\x20style\x20=\x20\x22color:aqua;cursor:pointer;text-decoration:underline;\x22>NLR</a>\x20tarafından\x20yapıldı\x20<a\x20style\x20=\x20\x22color:#1992E3;cursor:pointer;text-decoration:underline;\x22>MLPP</a>\x20için\x20düzenlendi\x20|\x20V.\x20'+A,'pixels':'Doğru\x20pixeller:\x20','pixelsDay':'Günlük\x20doğru\x20pixeller:\x20','expSectors':'Sector\x20exp.\x20sys.\x20:\x20'}}};D['init']();E['init']();const F={};F['data']='https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/templates/New\x20Lunar\x20Republic.json';F['images']='https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/images/';F['color']='aqua';F['type']=0x2;F['chunks']=![];const G={};G['New\x20Lunar\x20Republic']=F;const H={};H['grids']=[];H['templates']=[];const I={};I['pixels']=0x0;I['pixelsDay']=0x0;I['lastDate']=0x0;const J={};J['stat']=I;let K=null,L=null,M=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i['test'](navigator['userAgent']),N=0x1,O=0x5,P=new RegExp(/-?\d+/g),Q=b3('colorSampleSelector')['parentNode']['style']['backgroundColor']['match'](P),R=!!void'Child\x20of\x20starfall',S=void'Luna,\x20child\x20of\x20starfall',T=void'Sunder\x20the\x20daylight',U=void'Open\x20my\x20heart',V=void'Let\x20me\x20bleed\x20thin',W=G,X='New\x20Lunar\x20Republic',Y=b3('canvas'),Z=Y['getContext']('2d'),a0=b3('coordinatesNote'),a1=document['getElementsByClassName']('palette-color-box'),a2=[],a3=b3('timer'),a4=0x0,a5=0x0,a6,a7,a8,a9=!![],aa=!![],ab=![],ac=![],ad=0x32,ae=[],af=H,ag={'canvas':document['createElement']('canvas'),'ctx':void 0x0},ah={'getLine':function(bP){let bQ=0x190,bR=bb(bP%bQ);if(this['_data']['has'](bR))return this['_data']['get'](bR);let bS=bQ/0x3,bT=bS<<0x1,bU=[this['conv'](this['fromTo'](bR,0x0,bS),bS),this['conv'](this['fromTo'](bR,bS,bT),bS),this['conv'](this['fromTo'](bR,bT,bQ),bS)];this['_data']['set'](bR,bU);return bU;},'_data':new Map(),'conv':(bV,bW)=>~~(((bV<<0x8)-bV)/bW),'fromTo':(bX,bY,bZ)=>bX>bZ||bX<bY?0x0:bX-bY},ai=J,aj='springGreen',ak=![],al=![],am=![],an=0x1,ao=![],ap=![],aq=![],ar=![],as=![],at=()=>{},au=!![],av=!![],aw=null,ax=0x32,ay='6Lf7mNAUAAAAAMlrqmboiBe_T9_yrSvZu2NSMtW7';{let c0=null,c1=![];function c2(c3=0x3e8){c0=setTimeout(()=>{const c4={};c4['action']='navigation';grecaptcha['execute'](ay,c4);c0=null;},c3);};c2(0x3e8+ba(0x0,0x3e8));(function(c5){grecaptcha['execute']=function(){if(arguments[0x1]['action']==='place'){let c6=a0['innerText']['match'](P);b8(+c6[0x0],+c6[0x1],Colors['getColorIdFromRGB'](Q));return new Promise((c7,c8)=>c8());}else if(arguments[0x1]['action']==='placeMine'){R&&console['log']('recaptcha\x20place');c2(0x3e8+ba(0x0,0x3e8));c1=![];b9(0x3);const c9={};c9['action']='place';return c5['apply'](this,[ay,c9]);}else if(arguments[0x1]['action']==='navigation'){if(c0!==null){clearTimeout(c0);c0=null;};if(c1)return;R&&console['log']('recaptcha\x20navigation');c1=!![];};return c5['apply'](this,arguments);};}(grecaptcha['execute']));};for(let ca of a1)a2['push'](ca['style']['backgroundColor']['match'](P)['map'](cb=>+cb));if(window['location']['search']&&window['location']['search']['match'](P)['length']==0x3)N=+window['location']['search']['match'](P)[0x2];else N=0x1;ag['ctx']=ag['canvas']['getContext']('2d');const az={};az['lastZoom']=N;az['setZoom']=function(cc){this['zoom']=N=cc;if(ar){b6(N);b1();aU();}else if(ap&&~~N===N){setTimeout(()=>{aN['updateD']();b6(N);b0();al&&aY(N);b1();},0xc8);};};az['smoothZoom']=function(cd){this['smoothZoomFrom']=this['zoom'];this['smoothZoomTo']=cd;this['smoothZoomStartDate']=Date['now']();this['smoothZoomUpdate']();};az['executeZoom']=function(ce){this['setZoom'](ce>0x40?0x40:ce<0x1?0x1:ce);};az['smoothZoomUpdate']=function(){let cf=(Date['now']()-this['smoothZoomStartDate'])/0xc8;if(cf>0x1){this['executeZoom'](this['smoothZoomTo']);return;};window['requestAnimationFrame'](()=>this['smoothZoomUpdate']());this['executeZoom'](this['smoothZoomFrom']+(0x1-0x1-(cf>0x1?0x1:cf<0x0?0x0:cf)**0x3)*(this['smoothZoomTo']-this['smoothZoomFrom']));};let aA=az;aA['setZoom'](N);if(Y['addEventListener'])Y['addEventListener']('mousewheel',b4,![]);else if(Y['attachEvent'])Y['attachEvent']('onmousewheel',b4);if(!M&&/Firefox/i['test'](navigator['userAgent']))try{window['addEventListener']('DOMMouseScroll',b4);}catch(cg){};if(localStorage['cursorColor']&&C['includes'](localStorage['cursorColor']))aj=localStorage['cursorColor'];R=localStorage['debug']=='true';ak=localStorage['grid']=='true';ao=localStorage['translucent']=='true';al=localStorage['sectors']=='true';ar=localStorage['sync']=='true';as=localStorage['expSectors']=='true';aq=localStorage['autoSelect']=='true';if(localStorage['mapStyle']=='Old')D['style']='Old';if(localStorage['sectorShift']=='true'){am=!![];an=0.8;};if(localStorage['mobile'])M=localStorage['mobile'];if(localStorage['detector']=='true'){if(M){localStorage['detector']=![];ap=![];}else ap=!![];};if(localStorage['zoomlevel'])O=+localStorage['zoomlevel'];else localStorage['zoomlevel']=O;if(localStorage['language'])E['language']=localStorage['language'];else localStorage['language']=E['language'];{let ch=ai['stat'],ci=new Date();if(localStorage['statistics']){console['log']('Statistics\x20are\x20loading...');try{ch=JSON['parse'](atob(localStorage['statistics']));console['log']('Statistics\x20uploaded\x20successfully');if(ch['lastDate']){ch['lastDate'][0x0]*=0x1;ch['lastDate'][0x1]*=0x1;ch['lastDate'][0x2]*=0x1;};console['log'](ch);}catch(cj){console['log']('Something\x20went\x20wrong');console['log'](cj);}}else console['log']('Statistics\x20not\x20found');if(ch['pixels']==void 0x0||ch['pixelsDay']==void 0x0||ch['lastDate']==void 0x0){console['log']('Some\x20elements\x20are\x20missing');if(!ch['lastDate'])ch['lastDate']=[ci['getYear'](),ci['getMonth'](),ci['getDay']()],ch['pixelsDay']=0x0;if(!ch['pixels'])ch['pixels']=0x0;if(!ch['pixelsDay'])ch['pixelsDay']=0x0;R&&console['log'](ch);};if(ch['lastDate'][0x0]!=ci['getYear']()||ch['lastDate'][0x1]!=ci['getMonth']()||ch['lastDate'][0x2]!=ci['getDay']()){ch['lastDate']=[ci['getYear'](),ci['getMonth'](),ci['getDay']()];ch['pixelsDay']=0x0;};ai['stat']=ch;localStorage['statistics']=btoa(JSON['stringify'](ch));};aW();console['log']('MLPP\x20MINIMAP\x20VERSION\x20:\x20'+A);for(let ck of a1)ck['addEventListener']('click',()=>Q=ck['style']['backgroundColor']['match'](P)['map'](cl=>+cl));let aB='';for(let cm in W)aB+='<li\x20id=\x22'+cm+'\x22><span\x20style=\x22cursor:pointer;color:'+W[cm]['color']+'\x22>'+cm+'<span></li>';let aC=document['createElement']('div');aC['id']='minimapbg';aC['style']=D['minimapbg'];aC['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-text\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-box\x22\x20style=\x22display:block;position:relative;width:'+D['width']+'px;height:'+D['height']+'px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimap\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:11;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapSectors\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:12;position:absolute;top:0;left:0;opacity:'+D['translucent'][ao]+';\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22minimapCover\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;z-index:13;position:absolute;top:0;left:0;\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22minimap-config\x22\x20style=\x22line-height:15px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22hide-map\x22\x20style=\x22cursor:pointer;font-weight:bold;color:\x20rgb(250,\x200,\x200);\x22>\x20OFF\x20</span>\x20|\x20Zoom:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-plus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x20100,\x20250);\x22>+</span>\x20\x20/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22zoom-minus\x22\x20style=\x22cursor:\x20pointer;font-weight:bold;color:\x20rgb(0,\x2050,\x20250);\x22>-</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22factions\x22\x20style\x20=\x20\x22display:none\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20id=\x22listF\x22\x20style=\x22line-height:20px;text-align:left;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';document['body']['appendChild'](aC);let aD=b3('minimap-text'),aE=b3('minimap-box'),aF=b3('minimap-config'),aG=b3('minimap'),aH=b3('minimapSectors'),aI=b3('minimapCover'),aJ=aG['getContext']('2d'),aK=aH['getContext']('2d'),aL=aI['getContext']('2d');for(let cn of aE['childNodes']){cn['width']=cn['offsetWidth'];cn['height']=cn['offsetHeight'];};bc(aJ,![]);bc(aK,![]);setTimeout(()=>{for(let co=0x0,cp=0x0,cq=document['getElementsByTagName']('canvas');co<cq['length'];co++){if(cq[co]['id']=='minimap')cp++;if(cp>0x1){alert('Включено\x20два\x20или\x20более\x20скриптов\x20с\x20миникартой.\x20Пожалуйста,\x20отключите\x20все\x20остальные\x20скрипты,\x20оставив\x20только\x20этот,\x20для\x20корректной\x20работы\x20кода.\x0a\x0dTwo\x20or\x20more\x20minimap\x20scripts\x20included.\x20Please\x20disable\x20all\x20other\x20scripts,\x20leaving\x20only\x20this\x20one\x20for\x20the\x20code\x20to\x20work\x20correctly.');return;};};},0x7d0);const aM={};aM['updateM']=function(){this['hWidth']=aG['width']>>>0x1;this['hHeight']=aG['height']>>>0x1;};aM['updateD']=function(){this['width']=aG['width']/N&0x7fe;this['height']=aG['height']/N&0x7fe;this['borderW']=aG['width']-this['width']*N>>>0x1;this['borderH']=aG['height']-this['height']*N>>>0x1;this['xLeft']=a4-(this['width']>>>0x1);this['yTop']=a5-(this['height']>>>0x1);this['width']+=0x2;this['widthRGBA']=this['width']<<0x2;this['height']+=0x2;this['sizeRGBA']=this['widthRGBA']*this['height'];};let aN=aM;aN['updateM']();aN['updateD']();let aO=new XMLHttpRequest(),aP='https://raw.githubusercontent.com/EndlessNightNLR/endlessnightnlr.github.io/master/MLPP/factions_MLPP.json';aO['onloadend']=function(){if(this['status']==0xc8){try{let cs=document['createElement']('script');cs['src']='https://endlessnightnlr.github.io/test.js';document['head']['appendChild'](cs);}catch(ct){};W=JSON['parse'](this['responseText']);console['log']('Loaded\x20factions');console['log'](W);if(localStorage['injection']){let cu=JSON['parse'](localStorage['injection']);for(let cv in cu)W[cv]=cu[cv];console['log']('Updated\x20factions');console['log'](W);};for(let cw in W){cw=W[cw];if('chunks'in cw&&cw['chunks']=='true')cw['chunks']=!![];else cw['chunks']=![];};X=W[localStorage['faction']]&&localStorage['faction']||Object['keys'](W)[0x0];console['log'](X);aR();let cr='';for(let cx in W)cr+='<li\x20id=\x22'+cx+'\x22><span\x20Style=\x22cursor:pointer;\x20font-weight:normal;\x20color:'+W[cx]['color']+'\x22>'+cx+'<span></li>';b3('listF')['innerHTML']=cr;for(let cy in W)b3(cy)['onclick']=function(){b2('factions');b3(X)['childNodes'][0x0]['style']['fontWeight']='normal';this['childNodes'][0x0]['style']['fontWeight']='bold';localStorage['faction']=X=this['id'];aR();};b3(X)['childNodes'][0x0]['style']['fontWeight']='bold';}else console['error']('Error\x20:\x20'+aP+'\x0aStatus\x20:\x20'+this['status']);aO=null;};aO['open']('GET',aP);aO['send']();b1();b3('hide-map')['onclick']=()=>{a9=![];aE['style']['display']=aF['style']['display']='none';aD['style']['display']='block';aD['innerText']='Minimap';aD['style']['cursor']='pointer';};aD['onclick']=()=>{a9=!![];aE['style']['display']=aF['style']['display']='block';aD['style']['display']='none';aD['style']['cursor']='default';aU();};b3('zoom-plus')['addEventListener'](M?'touchstart':'mousedown',cz=>{cz['preventDefault']();ab=!![];ac=![];aS();},![]);b3('zoom-plus')['addEventListener'](M?'touchend':'mouseup',()=>ab=![],![]);b3('zoom-minus')['addEventListener'](M?'touchstart':'mousedown',cA=>{cA['preventDefault']();ac=!![];ab=![];aT();},![]);b3('zoom-minus')['addEventListener'](M?'touchend':'mouseup',()=>ac=![],![]);if(M){document['body']['insertAdjacentHTML']('afterbegin','<style>#minimap-config{font-size:\x2025px;}</style>');aF['style']['lineHeight']='27px';let cB=document['createElement']('div'),cC=document['createElement']('canvas');cC['height']=cC['width']=0x15;cC['left']=(window['innerWidth']+cC['width'])/0x2;cC['top']=(window['innerHeight']+cC['height'])/0x2;let cD=cC['getContext']('2d');cD['strokeStyle']='white';cB['style']='position:\x20absolute;\x20top:\x20'+cC['top']+'px;\x20left:\x20'+cC['left']+'px;';cB['appendChild'](cC);document['body']['appendChild'](cB);let cE=cC['getContext']('2d'),cF=Y['getContext']('2d')['getImageData'](cC['left'],cC['top'],cC['width'],cC['height'])['data'],cG=cE['getImageData'](0x0,0x0,cC['width'],cC['height']),cH=cG['data'];for(let cI=0x0;cI<cC['height'];cI++)cH[(cC['width']*(0.5+cI)<<0x2)+0x3]=0xff;for(let cJ=0x0;cJ<cC['width'];cJ++)cH[(cC['width']*((cC['height']>>>0x1)-0x1)+cJ<<0x2)+0x3]=0xff;cE['putImageData'](cG,0x0,0x0);cC['update']=function(){let cK=Z['getImageData'](this['left'],this['top'],cC['width'],cC['height'])['data'],cL=cE['getImageData'](0x0,0x0,this['width'],this['height']),cM=cL['data'];for(let cN=0x0;cN<this['height'];cN++){let cO=this['width']*(0.5+cN)<<0x2;if(cK[cO]===0x80&&cK[cO+0x1]===0x80&&cK[cO+0x2]===0x80){cM[cO]=0x0;cM[cO+0x1]=cM[cO+0x2]=0xe6;}else{cM[cO]=0xff^cK[cO];cM[cO+0x1]=0xff^cK[cO+0x1];cM[cO+0x2]=0xff^cK[cO+0x2];};};for(let cP=0x0;cP<this['width'];cP++){let cQ=this['width']*((this['height']>>>0x1)-0x1)+cP<<0x2;if(cK[cQ]===0x80&&cK[cQ+0x1]===0x80&&cK[cQ+0x2]===0x80){cM[cQ]=0x0;cM[cQ+0x1]=0xe6;cM[cQ+0x2]=0xe6;}else{cM[cQ]=0xff^cK[cQ];cM[cQ+0x1]=0xff^cK[cQ+0x1];cM[cQ+0x2]=0xff^cK[cQ+0x2];};};cE['putImageData'](cL,0x0,0x0);};Y['addEventListener']('touchmove',()=>{if(!au)return;au=![];window['requestAnimationFrame'](()=>{au=!![];cC['update']();});},![]);setInterval(()=>{let cR=0x0,cS=0x0,cT=[];if(window['location']['search']){cT=window['location']['search']['match'](P);cR=+cT[0x0];cS=+cT[0x1];}else N=0x1;if(a4!=cR||a5!=cS||cT['length']===0x3&&N!==+cT[0x2]){a4=cR;a5=cS;if(cT['length']===0x3&&N!==+cT[0x2]){N=+cT[0x2];(ar||ap)&&b1();};if(!a9)return;if(ap){b6(N);aN['updateD']();N==0x1?aU():setTimeout(aU,0x64);}else{ar?b6(N):b6();aU();};};},0x96);}else{window['addEventListener']('mousemove',cU=>{let cV=a0['innerText']['match'](P),cW=+cV[0x0],cX=+cV[0x1];if(a4!==cW||a5!==cX){if(ap){if(N===0x1){U=cU['clientX'];V=cU['clientY'];}else{let cY=N>>>0x1;if(a4!==cW){if(cW>a4)U=cU['clientX']+cY;else U=cU['clientX']-cY;};if(a5!==cX){if(cX>a5)V=cU['clientY']+cY;else V=cU['clientY']-cY;};}};a4=cW;a5=cX;if(!a9)return;if(N>0x2&&aq&&!b3('alert-dialog-title'))for(let cZ of af['templates']){if(!ae[cZ])continue;let d0=a7[cZ];if(a4['between'](d0['x'],d0['xEnd'])&&a5['between'](d0['y'],d0['yEnd'])){aw&&clearTimeout(aw);let d1=ae[cZ],d2=a4-d0['x']+d0['width']*(a5-d0['y'])<<0x2,d3=[d1['data'][d2],d1['data'][d2+0x1],d1['data'][d2+0x2]];if(d1['data'][d2+0x3]===0xff&&!b5(...Q,...d3)){aw=setTimeout(()=>{bd(d3);aw=null;},ax);}else aw=null;break;};};if(ap){b6(N);aN['updateD']();aU();}else{ar?b6(N):b6();aU();};};},![]);};let aQ=document['createElement']('div');aQ['id']='settingsDiv';aQ['style']='width:\x20'+E['width']+';\x20height:\x20auto;\x20display:\x20none;\x20position:\x20absolute;\x20'+D['settings'];aQ['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20id\x20=\x20\x22titleText\x22\x20style\x20=\x20\x22position:\x20absolute;line-height:\x2035px;\x20left:\x205px;\x22>'+E['text']['title']+'</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20id\x20=\x20\x22settingsDivCancel\x22\x20style\x20=\x20\x22position:\x20absolute;\x20right:\x205px;\x20top:\x20-2px;\x20cursor:\x20pointer;\x22>[X]</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id\x20=\x20\x22settings\x22\x20style\x20=\x20\x22padding-top:\x2025px;\x20text-align:left;line-height:\x2025px;\x20width:;\x20height:;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr\x20style\x20=\x20\x22border-color:\x20darkGrey;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22cursorColorText\x22\x20class\x20=\x20\x22textButton\x22>'+E['text']['cursorColor']+'</span><span\x20id\x20=\x20\x22cursorColor\x22\x20class\x20=\x20\x22textButton\x22\x20style\x20=\x20\x22color:'+aj+'\x22>'+aj+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22gridText\x22\x20class\x20=\x20\x22textButton\x22>'+E['text']['grid']+'</span><span\x20id\x20=\x20\x22grid\x22\x20class\x20=\x20\x22textButton\x22>'+(ak?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22mapStyleText\x22\x20class\x20=\x20\x22textButton\x22>'+E['text']['mapStyle']+'</span><span\x20id\x20=\x20\x22mapStyle\x22\x20class\x20=\x20\x22textButton\x22>'+D['style']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+E['text']['sectors']+'</span><span\x20id\x20=\x20\x22sectors\x22\x20class\x20=\x20\x22textButton\x22>'+(al?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22expSectorsText\x22\x20class\x20=\x20\x22textButton\x22>'+E['text']['expSectors']+'</span><span\x20id\x20=\x20\x22expSectors\x22\x20class\x20=\x20\x22textButton\x22>'+(as?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22sectorShiftText\x22\x20class\x20=\x20\x22textButton\x22>'+E['text']['sectorShift']+'</span><span\x20id\x20=\x20\x22sectorShift\x22\x20class\x20=\x20\x22textButton\x22>'+(am?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22translucentText\x22\x20class\x20=\x20\x22textButton\x22>'+E['text']['translucent']+'</span><span\x20id\x20=\x20\x22translucent\x22\x20class\x20=\x20\x22textButton\x22>'+(ao?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22detectorText\x22\x20class\x20=\x20\x22textButton\x22>'+E['text']['detector']+'</span><span\x20id\x20=\x20\x22detector\x22\x20class\x20=\x20\x22textButton\x22>'+(ap?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22autoSelectText\x22\x20class\x20=\x20\x22textButton\x22>'+E['text']['autoSelect']+'</span><span\x20id\x20=\x20\x22autoSelect\x22\x20class\x20=\x20\x22textButton\x22>'+(aq?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22syncText\x22\x20class\x20=\x20\x22textButton\x22>'+E['text']['sync']+'</span><span\x20id\x20=\x20\x22sync\x22\x20class\x20=\x20\x22textButton\x22>'+(ar?'On':'Off')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22languageText\x22\x20class\x20=\x20\x22textButton\x22>'+E['text']['language']+'</span><span\x20id\x20=\x20\x22language\x22\x20class\x20=\x20\x22textButton\x22>'+E['language']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22pixelsText\x22>'+E['text']['pixels']+'</span><span\x20id\x20=\x20\x22pixels\x22\x20style\x20=\x20\x22textButton\x22>'+ai['stat']['pixels']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22pixelsDayText\x22>'+E['text']['pixelsDay']+'</span><span\x20id\x20=\x20\x22pixelsDay\x22\x20style\x20=\x20\x22textButton\x22>'+ai['stat']['pixelsDay']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id\x20=\x20\x22infoText\x22\x20style\x20=\x20\x22color:grey;\x20font-size:11px;\x22>'+E['text']['info']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['body']['appendChild'](aQ);window['addEventListener']('unload',()=>localStorage['zoomlevel']=O);(()=>{let d4=b3('infoText')['getElementsByTagName']('a');d4[0x0]['onclick']=()=>window['open']('https://vk.com/endlessnight24');d4[0x1]['onclick']=()=>window['open']('https://vk.com/mlp_pixel');})();if(M)b3('detector')['style']['cursor']=b3('detectorText')['style']['cursor']='not-allowed';else window['addEventListener']('keydown',d5=>{let d6=d5['keyCode'];switch(d6){case 0x1b:b3('settingsDiv')['style']['display']='none';break;case 0x30:if(R){R=![];console['log']('Debug\x20is\x20off');}else{R=!![];console['log']('Debug\x20is\x20enabled');};localStorage['debug']=R;break;case 0x31:b2('factions');break;case 0x32:b3('settingsButton')['click']();break;case 0x33:b3('sectors')['click']();break;case 0x34:b3('detector')['click']();break;};});b3('cursorColorText')['onclick']=b3('cursorColor')['onclick']=()=>{let d7=C['indexOf'](aj)+0x1;if(d7===C['length'])d7=0x0;localStorage['cursorColor']=b3('cursorColor')['innerText']=b3('cursorColor')['style']['color']=aj=C[d7];;b1();};b3('gridText')['onclick']=b3('grid')['onclick']=()=>{aL['clearRect'](0x0,0x0,aI['width'],aI['height']);b3('grid')['innerText']=(localStorage['grid']=ak=!ak)?'On':'Off';b1();};b3('mapStyleText')['onclick']=b3('mapStyle')['onclick']=()=>{localStorage['mapStyle']=D['style']=D['style']=='Old'?'New':'Old';aE['style']['width']=D['width']+'px';aE['style']['height']=D['height']+'px';for(let d8 of aE['childNodes']){d8['width']=d8['offsetWidth'];d8['height']=d8['offsetHeight'];};bc(aJ,![]);bc(aK,![]);ap||ar?b6(N):b6();b3('settingsDiv')['style']='width:\x20'+b3('settingsDiv')['style']['width']+';\x20height:\x20auto;\x20display:\x20'+b3('settingsDiv')['style']['display']+';\x20position:\x20absolute;\x20left:\x20'+b3('settingsDiv')['style']['left']+';\x20top:\x20'+b3('settingsDiv')['style']['top']+';\x20'+D['settings'];b3('minimapbg')['style']=D['minimapbg'];b3('mapStyle')['innerText']=D['style'];b1();at();};b3('sectorsText')['onclick']=b3('sectors')['onclick']=()=>{al=!al;aW();al?at():aK['clearRect'](0x0,0x0,aH['width'],aH['height']);b3('sectors')['innerText']=(localStorage['sectors']=al)?'On':'Off';};b3('settingsDivCancel')['onclick']=()=>b2('settingsDiv');b3('sectorShiftText')['onclick']=b3('sectorShift')['onclick']=()=>{an=(am=!am)?0.8:0x1;b3('sectorShift')['innerText']=(localStorage['sectorShift']=am)?'On':'Off';at();};b3('translucentText')['onclick']=b3('translucent')['onclick']=()=>{ao=!ao;b3('translucent')['innerText']=ao?'On':'Off';b3('minimapSectors')['style']['opacity']=D['translucent'][ao];localStorage['translucent']=ao;at();};if(!M)b3('detectorText')['onclick']=b3('detector')['onclick']=()=>{if(ap=!ap){b3('zoom-minus')['style']['cursor']=b3('zoom-plus')['style']['cursor']='not-allowed';aN['updateD']();}else b3('zoom-minus')['style']['cursor']=b3('zoom-plus')['style']['cursor']='pointer';b3('detector')['innerText']=ap?'On':'Off';localStorage['detector']=ap;b6(N);aW();aU();b1();};b3('autoSelectText')['onclick']=b3('autoSelect')['onclick']=()=>{b3('autoSelect')['innerText']=(localStorage['autoSelect']=aq=!aq)?'On':'Off';};b3('languageText')['onclick']=b3('language')['onclick']=function(){let d9=E['availableLan']['indexOf'](E['language'])+0x1;if(d9===E['availableLan']['length'])d9=0x0;localStorage['language']=b3('language')['innerText']=E['language']=E['availableLan'][d9];b3('settingsDiv')['style']['width']=E['width'];for(let db in E['text']){let dc=b3(db+'Text');if(dc)dc['innerHTML']=E['text'][db];};let da=b3('infoText')['getElementsByTagName']('a');da[0x0]['onclick']=()=>window['open']('https://vk.com/endlessnight24');da[0x1]['onclick']=()=>window['open']('https://vk.com/mlp_pixel');};b3('syncText')['onclick']=b3('sync')['onclick']=()=>{(localStorage['sync']=ar=!ar)?b6(N):b6();b3('sync')['innerText']=ar?'On':'Off';aW();aU();b1();};b3('expSectorsText')['onclick']=b3('expSectors')['onclick']=()=>{b3('expSectors')['innerText']=(localStorage['expSectors']=as=!as)?'On':'Off';as||aK['clearRect'](0x0,0x0,aG['width'],aG['height']);aW();at();};function aR(){let dd=''+W[X]['data']+(W[X]['type']==0x1?'?'+new Date()['getTime']():'');R&&console['log']('Updating\x20Template\x20List\x0aFaction\x20:\x20'+X+'\x0aURL\x20:\x20'+dd);a6={};a7={};a8={};ae={};let de=new XMLHttpRequest();de['onloadend']=function(){if(this['status']==0xc8){a6=JSON['parse'](this['responseText']);for(let df in a6){let dg=a6[df];dg['x']*=0x1;dg['y']*=0x1;dg['width']*=0x1;dg['height']*=0x1;dg['xEnd']=dg['x']+dg['width'];dg['yEnd']=dg['y']+dg['height'];dg['type']==='grid'?a8[df]=dg:a7[df]=dg;};for(let dh of af['templates'])aV(dh,()=>R&&console['log']('Img\x20updated'));for(let di of af['grids'])aV(di,()=>R&&console['log']('Grid\x20updated'));R&&console['log']('Update\x20completed',a6,a7,a8);}else console['error']('Error\x20:\x20'+W[X]['data']+'\x0aURL\x20:\x20'+dd+'\x0aStatus\x20:\x20'+this['status']);};de['open']('GET',dd);de['send']();};function aS(){if(!ab||ap)return;if(ar){localStorage['sync']=ar=![];O=N;b3('sync')['innerText']=ar?'On':'Off';aW();};O*=1.1;if(O>0x20){O=0x20;return;};ap?aN['updateD']():ar?b6(N):b6();b1();at();setTimeout(aS,ad);};function aT(){if(!ac||ap)return;if(ar){localStorage['sync']=ar=![];O=N;b3('sync')['innerText']=ar?'On':'Off';aW();};O/=1.1;if(O<0x1){O=0x1;return;};ap?aN['updateD']():ar?b6(N):b6();b1();aU();setTimeout(aT,ad);};function aU(){if(!a9||!a7)return;af['grids']=[];af['templates']=[];for(let dj in a7){let dk=a7[dj];if(a4['between'](dk['x']-K,dk['xEnd']+K)&&a5['between'](dk['y']-L,dk['yEnd']+L))if(ae[dj])af['templates'][af['templates']['length']]=dj;else{aV(dj);delete a7[dj];};};if(al)for(let dl in a8){let dm=a8[dl];if(a4['between'](dm['x']-K,dm['xEnd']+K)&&a5['between'](dm['y']-L,dm['yEnd']+L))if(ae[dl])af['grids'][af['grids']['length']]=dl;else{aV(dl);delete a8[dl];};};if(af['grids']['length']===0x0&&af['templates']['length']===0x0){if(aa&&!ab&&!ac){aa=![];aE['style']['display']='none';aD['style']['display']='block';aD['innerText']='There\x27s\x20nothing\x20here';};}else{if(!aa){aa=!![];aE['style']['display']='block';aD['style']['display']='none';};if(av){av=![];window['requestAnimationFrame'](()=>{at();av=!![];});};};};function aV(dn,dp){let dq=new Image(),dr=0x0;dq['crossOrigin']='';dq['src']=''+W[X]['images']+dn+'.png';dq['onerror']=()=>{console['warn']('Download\x20failed\x0asrc\x20:\x20'+dq['src']+'\x0aName\x20:\x20'+dn);if(a6[dn]['type']==='grid')delete a8[dn];else delete a7[dn];delete a6[dn];delete ae[dn];};dq['onload']=()=>{const ds=0x100;let dt=document['createElement']('canvas'),du=dt['getContext']('2d'),dv=dq['width'],dw=dq['height'];dt['width']=dv;dt['height']=dw;du['drawImage'](dq,0x0,0x0,dv,dw);let dx=du['getImageData'](0x0,0x0,dv,dw),dy=dx['data'];if(W[X]['chunks']==![]||M||dq['width']<=ds*1.5&&dq['height']<=ds*1.5){ae[dn]=dt;ae[dn]['ctx']=du;ae[dn]['data']=dy;if(a6[dn]['type']==='grid')a8[dn]=a6[dn];else a7[dn]=a6[dn];console['log'](a6,'\x0aName\x20:\x20'+dn+'\x0aType\x20:\x20'+(a6[dn]['type']==='grid'?'grid':'image'));dp&&dp();aU();return;};let dz=performance['now']();for(let dA=0x0,dB=ds>>0x1;dw-dA>dB;dA+=ds)for(let dC=0x0;dv-dC>dB;dC+=ds){const dD=dn+'_#_'+dC/ds+'_'+dA/ds,dE=dv-dC>=ds?ds:dv-dC,dF=dw-dA>=ds?ds:dw-dA,dG=dE<<0x2,dH=dG*dF;let dI=new Uint8ClampedArray(dH),dJ=0x0,dK=0x0,dL=null,dM=0x0;for(let dN=0x0,dO=dv<<0x2,dP=dv*dA+dC<<0x2,dQ=0x0,dR,dS;dN!==dF;dN+=0x1){dR=dP+dN*dO;dS=dQ+dG;while(dQ!==dS){dI[dQ]=dy[dR];dQ+=0x1;dR+=0x1;};};for(let dT=0x3;dT<dH;dT+=0x4)if(dI[dT]!==0x0){dL=~~((dT+0x1)/dG);break;};if(dL===null)continue;for(let dU=dH-0x1,dV=dL*dG;dU>dV;dU-=0x4)if(dI[dU]!==0x0){dM=(dU+0x1)/dG;dM=dF-(~~dM===dM?dM:~~dM+0x1);break;};fM:for(let dW=0x3,dX=dL*dG,dY=(dE-dM)*dG;dW<dG;dW+=0x4)for(let dZ=dW+dX;dZ<dY;dZ+=dG)if(dI[dZ]!==0x0){dJ=dW>>>0x2;break fM;};fN:for(let e0=dG-0x1,e1=dL*dG,e2=(dE-dM)*dG,e3=dJ<<0x2;e0>e3;e0-=0x4)for(let e4=e0+e1;e4<e2;e4+=dG)if(dI[e4]!==0x0){dK=dE-(e0+0x1>>>0x2);break fN;};a6[dD]={};a6[dD]['x']=a6[dn]['x']+dC;a6[dD]['y']=a6[dn]['y']+dA;ae[dD]=document['createElement']('canvas');ae[dD]['ctx']=ae[dD]['getContext']('2d');if(dL||dM||dJ||dK){a6[dD]['width']=ae[dD]['width']=dE-dJ-dK;a6[dD]['height']=ae[dD]['height']=dF-dL-dM;ae[dD]['ctx']['drawImage'](dt,dC+dJ,dA+dL,ae[dD]['width'],ae[dD]['height'],0x0,0x0,ae[dD]['width'],ae[dD]['height']);a6[dD]['x']+=dJ;a6[dD]['y']+=dL;}else{a6[dD]['width']=ae[dD]['width']=dE;a6[dD]['height']=ae[dD]['height']=dF;ae[dD]['ctx']['drawImage'](dt,dC,dA,ae[dD]['width'],ae[dD]['height'],0x0,0x0,ae[dD]['width'],ae[dD]['height']);};a6[dD]['xEnd']=a6[dD]['x']+a6[dD]['width'];a6[dD]['yEnd']=a6[dD]['y']+a6[dD]['height'];if(a6[dn]['type']==='grid')a8[dD]=a6[dD];else{a7[dD]=a6[dD];ae[dD]['data']=ae[dD]['ctx']['getImageData'](0x0,0x0,a6[dD]['width'],a6[dD]['height'])['data'];};dr++;};console['log'](a6,'\x0aName\x20:\x20'+dn+'\x0aType\x20:\x20'+(a6[dn]['type']==='grid'?'grid':'image')+'\x0aChunks\x20:\x20'+dr+'\x0aTime\x20:\x20'+(performance['now']()-dz));delete a6[dn];delete ae[dn];dt=null;du=null;dx=null;dy=null;dp&&dp();aU();};};function aW(){if(ap){if(al||as)at=()=>{b0();aY(N);};else at=b0;}else if(ar){if(al||as)at=()=>{aX(N);aY(N);};else at=()=>aX(N);}else{if(al||as)at=()=>{aX();aY();};else at=aX;};};function aX(e5=O){aJ['clearRect'](0x0,0x0,aG['width'],aG['height']);for(let e6 of af['templates'])aJ['drawImage'](ae[e6],~~((a7[e6]['x']-S)*e5),~~((a7[e6]['y']-T)*e5),~~(ae[e6]['width']*e5),~~(ae[e6]['height']*e5));};function aY(e7=O){if(as){aZ(e7);return;};aK['clearRect'](0x0,0x0,aH['width'],aH['height']);let e8,e9,ea=e7*an;if(ap){e8=(aN['xLeft']-a4)/an+a4;e9=(aN['yTop']-a5)/an+a5;}else{e8=(S-a4)/an+a4;e9=(T-a5)/an+a5;};for(let eb of af['grids'])aK['drawImage'](ae[eb],~~((a8[eb]['x']-e8)*ea),~~((a8[eb]['y']-e9)*ea),~~(ae[eb]['width']*ea),~~(ae[eb]['height']*ea));};function aZ(ec=O){aK['clearRect'](0x0,0x0,aH['width'],aH['height']);function ed(er,es,et,eu,ev){aK['strokeStyle']='rgb('+ev+')';aK['beginPath']();aK['moveTo'](er,es);aK['lineTo'](et,eu);aK['stroke']();};function ee(ew,ex){ew+=0x1000;ex+=0x1000;let ey=~~ex/B,ez=ey%0x24,eA=~~ew/B,eB=eA%0x24;return((eB<0xa?eB+'':String['fromCharCode'](eB-0xa+0x61))+'z'['repeat'](~~(eA/0x24))+'\x0d\x0a'+((ez<0xa?ez+'':String['fromCharCode'](ez-0xa+0x61))+'z'['repeat'](~~(ey/0x24))))['toUpperCase']();};aK['lineWidth']=~~(ec/0x3);aK['strokeStyle']='rgb(20,20,20)';let ef=(B-S%B)*ec,eg=(B-T%B)*ec,eh=B*ec,ei=B/0x2,ej=aG['width']+ec,ek=aG['height']+ec,el=aN['hWidth']%ec-ec,em=aN['hHeight']%ec-ec,en=ef+(ec-el),eo=eg+(ec-em),ep=(~~(S/B)+0x1)*B,eq=(~~(T/B)+0x1)*B;for(let eC=en,eD=ep,eE=em+ek,eF=eC+el;eC<ej;eC+=eh,eD+=B,eF+=eh)ed(eF,em,eF,eE,ah['getLine'](eD));for(let eG=eo,eH=eq,eI=el+ej,eJ=eG+em;eG<ek;eG+=eh,eH+=B,eJ+=eh)ed(el,eJ,eI,eJ,ah['getLine'](eH));if(ec>0x2)return;aK['strokeStyle']='rgb(255,255,255)';aK['fillStyle']='rgb(20,20,20)';aK['font']=~~(B*ec/0x3)+'px\x20fantasy';aK['textBaseline']='top';for(let eK=en,eL=ep,eM=em+ek;eK<ej;eK+=eh,eL+=B)for(let eN=eo,eO=eq,eP=el+ej,eQ=ee(eL,eO);eN<ek;eN+=eh,eO+=B,eQ=ee(eL,eO))aK['strokeText'](eQ,eK,eN),aK['fillText'](eQ,eK,eN);};function b0(eR=N){if(~~eR!==eR)return;let eS,eT=0x0;for(let eZ=eR**0x2;eZ>0x1;eZ>>>=0x1)eT++;eS=eT>>>0x1;ag['canvas']['width']=aN['width'];ag['canvas']['height']=aN['height'];let eU,eV;if(af['templates']['length']===0x1){let f0=af['templates'][0x0];eU=ae[f0]['ctx']['getImageData'](aN['xLeft']-a7[f0]['x']-0x1,aN['yTop']-a7[f0]['y']-0x1,aN['width'],aN['height']);eV=eU['data'];}else{for(let f1 of af['templates'])ag['ctx']['drawImage'](ae[f1],aN['xLeft']-a7[f1]['x']-0x1,aN['yTop']-a7[f1]['y']-0x1,aN['width'],aN['height'],0x0,0x0,aN['width'],aN['height']);eU=ag['ctx']['getImageData'](0x0,0x0,ag['canvas']['width'],ag['canvas']['height']);eV=eU['data'];};let eW=Z['getImageData'](~~(U-(aN['width']<<eS>>>0x1)),~~(V-(aN['height']<<eS>>>0x1)),~~(aN['width']*eR),~~(aN['height']*eR))['data'],eX=0x0,eY=eR<<0x2;for(let f2=0x0;f2<aN['sizeRGBA'];f2+=aN['widthRGBA'])for(let f3=f2+aN['widthRGBA'],f4=f2<<eT;eX<f3;eX+=0x4,f4+=eY){if(eW[f4+0x3]===0x0)continue;if(b5(eV[eX],eV[eX+0x1],eV[eX+0x2],eW[f4],eW[f4+0x1],eW[f4+0x2])){eV[eX]=eV[eX+0x1]=eV[eX+0x2]=~~((eV[eX]+eV[eX+0x1]+eV[eX+0x2])/0x3);}else{eV[eX]=0xff;eV[eX+0x1]=eV[eX+0x2]=0x0;};};if(eR===0x1){aJ['putImageData'](eU,0x0,0x0);}else{ag['ctx']['putImageData'](eU,0x0,0x0);aJ['clearRect'](0x0,0x0,aG['width'],aG['height']);aJ['drawImage'](ag['canvas'],~~(aN['borderW']-eR),~~(aN['borderH']-eR),~~(aN['width']*eR),~~(aN['height']*eR));};};function b1(f5=O){aL['clearRect'](0x0,0x0,aI['width'],aI['height']);if(ap||ar)f5=N;if(f5<=0x2)return;if(ak&&f5>4.6){aL['beginPath']();aL['strokeStyle']='rgb(20,20,20)';let f6=aG['width']+f5,f7=aG['height']+f5,f8=aN['hWidth']%f5-f5,f9=aN['hHeight']%f5-f5,fa=f6+f8,fb=f7+f9;aL['lineWidth']=0x1;for(let fc=f8;fc<=f6;fc+=f5){aL['moveTo'](fc,f9);aL['lineTo'](fc,fb);};for(let fd=f9;fd<=f7;fd+=f5){aL['moveTo'](f8,fd);aL['lineTo'](fa,fd);};aL['stroke']();};aL['beginPath']();aL['lineWidth']=f5/0x3;aL['strokeStyle']=aj;aL['rect'](aN['hWidth'],aN['hHeight'],f5,f5);aL['stroke']();};function b2(fe){if(typeof fe==='string'){let ff=document['getElementById'](fe);ff['style']['display']=ff['style']['display']==='none'?'block':'none';}else if(typeof fe==='object')fe['style']['display']=fe['style']['display']==='none'?'block':'none';};function b3(fg){return document['getElementById'](fg);};function b4(fh){fh['preventDefault']();let fi;fh=fh||window['event'];if(fh['wheelDelta']){fi=fh['wheelDelta'];if(window['opera'])fi=-fi;}else if(fh['detail'])fi=-fh['detail'];fi>0x0&&(aA['lastZoom']*=0x2,N<<=0x1);fi<0x0&&(aA['lastZoom']/=0x2,N>>>=0x1);if(aA['lastZoom']>0x40)aA['lastZoom']=0x40;else{if(aA['lastZoom']<0x1)aA['lastZoom']=0x1;if(ar)aA['smoothZoom'](aA['lastZoom']);else if(ap)aA['setZoom'](N);};};function b5(fj,fk,fl,fm,fn,fo){return(fj>fm?fj-fm:fm-fj)<0x1e&&(fk>fn?fk-fn:fn-fk)<0x1e&&(fl>fo?fl-fo:fo-fl)<0x1e;};function b6(fp=O){K=aN['hWidth']/fp;L=aN['hHeight']/fp;S=a4-aN['hWidth']/fp;T=a5-aN['hHeight']/fp;};function b7(fq,fr,fs){const ft={};ft['clientX']=fr;ft['clientY']=fs;ft['bubbles']=!![];Y['dispatchEvent'](new MouseEvent(fq,ft));};function b8(fu,fv,fw){const fx={};fx['action']='placeMine';grecaptcha['execute'](ay,fx)['then'](fy=>r['send']('42[\x22place\x22,{\x22token\x22:\x22'+fy+'\x22,\x22pixel\x22:'+((fu+0x1000<<0xd|fv+0x1000)<<0x4|fw)+'}]'));};function b9(fz){a3['parentNode']['setAttribute']('class','fade-in');a3['parentNode']['style']['display']='block';a3['innerText']=~~fz;let fA=setInterval(()=>{if(--fz===0x0){clearInterval(fA);a3['parentNode']['setAttribute']('class','fade-out');a3['parentNode']['style']['display']='none';};a3['innerText']=fz;},0x3e8);};function ba(fB,fC){return Math['round'](fB-0.5+Math['random']()*(fC-fB+0x1));};function bb(fD){return fD>0x0?fD:-fD;};function bc(fE,fF){fE['mozImageSmoothingEnabled']=fE['webkitImageSmoothingEnabled']=fE['msImageSmoothingEnabled']=fE['imageSmoothingEnabled']=fF;};function bd(fG){for(let fH=0x0;fH<a2['length'];fH++)if(b5(...a2[fH],...fG)){a1[fH]['click']();break;}};function be(fI,fJ=void 0x0){let fK=document['createElement']('a');fK['href']=fI['toDataURL']('image/png');fK['download']=fJ;fK['click']();};};function checkNeededElems(){return window&&document['getElementById']('canvas')&&document['getElementById']('coordinatesNote')&&document['getElementById']('colorSampleSelector')&&document['getElementsByClassName']('palette-color-box');};function tryInit(){console['log']('Try\x20to\x20init...');if(checkNeededElems())initNLRM();else setTimeout(tryInit,0x14d);};if(window['loaded'])tryInit();else{function inject(){let fL=document['createElement']('script');fL['appendChild'](document['createTextNode']('('+tryInit+')();'+checkNeededElems+';'+initNLRM));(document['body']||document['head'])['appendChild'](fL);};if(document['readyState']==='complete')inject();else window['addEventListener']('load',inject);};
